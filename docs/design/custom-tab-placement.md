---
title: ユーザー設定のタブをリボンに配置する
description: ユーザー設定のタブを Office リボンに表示する方法、および既定でフォーカスがあるかどうかを制御する方法について説明します。
ms.date: 11/01/2020
localization_priority: Normal
ms.openlocfilehash: 2c1e2ae66805212e78868cf7c07a0e5c14cd4025
ms.sourcegitcommit: 3189c4bd62dbe5950b19f28ac2c1314b6d304dca
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/17/2020
ms.locfileid: "49088181"
---
# <a name="position-a-custom-tab-on-the-ribbon-preview"></a><span data-ttu-id="ee150-103">リボンにカスタムタブを配置する (プレビュー)</span><span class="sxs-lookup"><span data-stu-id="ee150-103">Position a custom tab on the ribbon (preview)</span></span>

<span data-ttu-id="ee150-104">アドインのマニフェストでマークアップを使用することによって、アドインのカスタムタブを Office アプリケーションのリボンに表示する場所を指定できます。</span><span class="sxs-lookup"><span data-stu-id="ee150-104">You can specify where you want your add-in's custom tab to appear on the Office application's ribbon by using markup in the add-in's manifest.</span></span>

> [!NOTE]
> <span data-ttu-id="ee150-105">この記事では、 [アドインコマンドの基本的な概念](add-in-commands.md)について理解していることを前提としています。</span><span class="sxs-lookup"><span data-stu-id="ee150-105">This article assumes that you are familiar with the article [Basic concepts for add-in commands](add-in-commands.md).</span></span> <span data-ttu-id="ee150-106">最近実行していない場合は、確認してください。</span><span class="sxs-lookup"><span data-stu-id="ee150-106">Please review it if you have not done so recently.</span></span>

> [!IMPORTANT]
>
> - <span data-ttu-id="ee150-107">この記事に記載されているアドイン機能とマークアップはプレビュー段階であり、 *PowerPoint on the web でのみ利用でき* ます。</span><span class="sxs-lookup"><span data-stu-id="ee150-107">The add-in feature and markup described in this article is in preview and is *only available in PowerPoint on the web*.</span></span> <span data-ttu-id="ee150-108">テストおよび開発環境でマークアップを試すことをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="ee150-108">We recommend that you try out the markup in test and development environments only.</span></span> <span data-ttu-id="ee150-109">運用環境または業務上重要なドキュメント内では、プレビューマークアップを使用しないでください。</span><span class="sxs-lookup"><span data-stu-id="ee150-109">Do not use preview markup in a production environment or within business-critical documents.</span></span>
> - <span data-ttu-id="ee150-110">この記事に記載されているマークアップは、要件セット **Addincommands 1.3** をサポートするプラットフォームでのみ機能します。</span><span class="sxs-lookup"><span data-stu-id="ee150-110">The markup described in this article only works on platforms that support requirement set **AddinCommands 1.3**.</span></span> <span data-ttu-id="ee150-111">以下のサポートされて [いないプラットフォームでの動作を](#behavior-on-unsupported-platforms) 参照してください。</span><span class="sxs-lookup"><span data-stu-id="ee150-111">See [Behavior on unsupported platforms](#behavior-on-unsupported-platforms) below.</span></span>

<span data-ttu-id="ee150-112">ユーザー設定のタブを表示する場所を指定するには、そのタブを配置する組み込みの Office タブを特定し、組み込みタブの左側と右側のどちらに配置するかを指定します。これらの指定を行うには、アドインのマニフェストの[Customtab](../reference/manifest/customtab.md)要素に[insertbefore](../reference/manifest/customtab.md#insertbefore) (左側) 要素または[InsertAfter](../reference/manifest/customtab.md#insertafter) (right) 要素のいずれかを含めます。</span><span class="sxs-lookup"><span data-stu-id="ee150-112">Specify where you want a custom tab to appear by identifying which built-in Office tab you want it to be next to and specifying whether it should be on the left or right side of the built-in tab. Make these specifications by including either an [InsertBefore](../reference/manifest/customtab.md#insertbefore) (left) or an [InsertAfter](../reference/manifest/customtab.md#insertafter) (right) element in the [CustomTab](../reference/manifest/customtab.md) element of your add-in's manifest.</span></span> <span data-ttu-id="ee150-113">(両方の要素を使用することはできません。)</span><span class="sxs-lookup"><span data-stu-id="ee150-113">(You cannot have both elements.)</span></span>

<span data-ttu-id="ee150-114">次の例では、ユーザー設定のタブが [**校閲**] タブの *すぐ後* に表示されるように構成されています。要素の値は、組み込みの Office タブの ID であることに注意 `<InsertAfter>` してください。</span><span class="sxs-lookup"><span data-stu-id="ee150-114">In the following example, the custom tab is configured to appear *just after* the **Review** tab. Note that the value of the `<InsertAfter>` element is the ID of the built-in Office tab.</span></span> 

```xml
<ExtensionPoint xsi:type="ContosoRibbonTab">
  <CustomTab id="TabCustom1">
    <Group id="myCustomTab.group1">
       <!-- additional markup omitted -->
    </Group>
    <Label resid="customTabLabel1" />
    <InsertAfter>TabReview</InsertAfter>
  </CustomTab>
</ExtensionPoint>
```

<span data-ttu-id="ee150-115">次の点に注意してください。</span><span class="sxs-lookup"><span data-stu-id="ee150-115">Keep the following points in mind.</span></span>

- <span data-ttu-id="ee150-116">`<InsertBefore>`および `<InsertAfter>` 要素はオプションです。</span><span class="sxs-lookup"><span data-stu-id="ee150-116">The  `<InsertBefore>` and  `<InsertAfter>` elements are optional.</span></span> <span data-ttu-id="ee150-117">どちらも使用しない場合は、カスタムタブがリボンの右端のタブとして表示されます。</span><span class="sxs-lookup"><span data-stu-id="ee150-117">If you use neither, then your custom tab will appear as the rightmost tab on the ribbon.</span></span>
- <span data-ttu-id="ee150-118">`<InsertBefore>`および `<InsertAfter>` 要素は相互に排他的です。</span><span class="sxs-lookup"><span data-stu-id="ee150-118">The  `<InsertBefore>` and  `<InsertAfter>` elements are mutually exclusive.</span></span> <span data-ttu-id="ee150-119">両方を使用することはできません。</span><span class="sxs-lookup"><span data-stu-id="ee150-119">You cannot use both.</span></span>
- <span data-ttu-id="ee150-120">ユーザーがカスタムタブを同じ場所に構成した複数のアドインをインストールすると、[ **校閲** ] タブの後に、最後にインストールされたアドインのタブが配置されます。</span><span class="sxs-lookup"><span data-stu-id="ee150-120">If the user installs more than one add-in whose custom tab is configured for the same place, say after the **Review** tab, then the tab for the most recently installed add-in will be located in that place.</span></span> <span data-ttu-id="ee150-121">以前にインストールしたアドインのタブは、1つの場所に移動されます。</span><span class="sxs-lookup"><span data-stu-id="ee150-121">The tabs of the previously installed add-ins will be moved over one place.</span></span> <span data-ttu-id="ee150-122">たとえば、ユーザーがアドイン A、B、および C をその順序でインストールし、[ **校閲** ] タブの後にタブを挿入するようにすべてが構成されている場合、タブはこの順序で表示されます。 **review**、 **addインシデントタブ**、 **addinbtab**、 **addinbtab**。</span><span class="sxs-lookup"><span data-stu-id="ee150-122">For example, the user installs add-ins A, B, and C in that order and all are configured to insert a tab after the **Review** tab, then the tabs will appear in this order: **Review**, **AddinCTab**, **AddinBTab**, **AddinATab**.</span></span>
- <span data-ttu-id="ee150-123">ユーザーは、Office アプリケーションでリボンをカスタマイズできます。</span><span class="sxs-lookup"><span data-stu-id="ee150-123">Users can customize the ribbon in the Office application.</span></span> <span data-ttu-id="ee150-124">たとえば、ユーザーはアドインのタブを移動したり、非表示にしたりできます。この問題を回避したり、発生したことを検出したりすることはできません。</span><span class="sxs-lookup"><span data-stu-id="ee150-124">For example, a user can move or hide your add-in's tab. You cannot prevent this or detect that it has happened.</span></span>
- <span data-ttu-id="ee150-125">ユーザーが組み込みのタブのいずれかを移動すると、Office は `<InsertBefore>` `<InsertAfter>` *組み込みタブの既定の場所* に関して要素と要素を解釈します。たとえば、ユーザーが [**校閲**] タブをリボンの右端に移動すると、Office は上記の例のマークアップを解釈します。 "ユーザー設定のタブは、[ \***校閲**] タブの既定値\* の右側に配置します。" という意味があります。</span><span class="sxs-lookup"><span data-stu-id="ee150-125">If a user moves one of the built-in tabs, then Office interprets the `<InsertBefore>` and  `<InsertAfter>` elements in terms of *the default location of the built-in tab*. For example, if the user moves the **Review** tab to the right end of the ribbon, Office will interpret the markup in the example above as meaning "put the custom tab just to the right of *where the **Review** tab would be by default*."</span></span>

## <a name="specifying-which-tab-has-focus-when-the-document-opens"></a><span data-ttu-id="ee150-126">ドキュメントを開くときにフォーカスがあるタブを指定する</span><span class="sxs-lookup"><span data-stu-id="ee150-126">Specifying which tab has focus when the document opens</span></span>

<span data-ttu-id="ee150-127">Office は、常に、[ **ファイル** ] タブのすぐ右のタブに既定のフォーカスを与えます。既定では、これは [ **ホーム** ] タブです。ユーザー設定のタブを [ **ホーム** ] タブの前に構成した場合、では `<InsertBefore>TabHome</InsertBefore>` 、ドキュメントを開いたときにユーザー設定のタブにフォーカスが置かれます。</span><span class="sxs-lookup"><span data-stu-id="ee150-127">Office always gives default focus to the tab that is immediately to the right of the **File** tab. By default this is the **Home** tab. If you configure your custom tab to be before the **Home** tab, with `<InsertBefore>TabHome</InsertBefore>`, then your custom tab will have focus when the document opens.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="ee150-128">アドイン inconveniences と annoys ユーザーおよび管理者に過度の prominence を付与します。</span><span class="sxs-lookup"><span data-stu-id="ee150-128">Giving excessive prominence to your add-in inconveniences and annoys users and administrators.</span></span> <span data-ttu-id="ee150-129">ユーザーがドキュメントを操作するための主要な方法でない限り、[ **ホーム** ] タブの前にカスタムタブを配置しないようにします。</span><span class="sxs-lookup"><span data-stu-id="ee150-129">Do not position a custom tab before the **Home** tab unless your add-in is the primary way users will interact with the document.</span></span>

## <a name="behavior-on-unsupported-platforms"></a><span data-ttu-id="ee150-130">サポートされていないプラットフォームでの動作</span><span class="sxs-lookup"><span data-stu-id="ee150-130">Behavior on unsupported platforms</span></span>

<span data-ttu-id="ee150-131">[要件セット AddinCommands 1.3](../reference/requirement-sets/add-in-commands-requirement-sets.md)をサポートしていないプラットフォームにアドインがインストールされている場合、この記事で説明しているマークアップは無視され、カスタムタブがリボンの右端のタブとして表示されます。</span><span class="sxs-lookup"><span data-stu-id="ee150-131">If your add-in is installed on a platform that doesn't support [requirement set AddinCommands 1.3](../reference/requirement-sets/add-in-commands-requirement-sets.md), then the markup described in this article is ignored and your custom tab will appear as the rightmost tab on the ribbon.</span></span> <span data-ttu-id="ee150-132">マークアップをサポートしていないプラットフォームにアドインがインストールされないようにするには、マニフェストのセクションにある要件セットへの参照を追加し `<Requirements>` ます。</span><span class="sxs-lookup"><span data-stu-id="ee150-132">To prevent your add-in from being installed on platforms that don't support the markup, add a reference to the requirement set in the `<Requirements>` section of the manifest.</span></span> <span data-ttu-id="ee150-133">手順については、「 [マニフェストの要件要素を設定する](../develop/specify-office-hosts-and-api-requirements.md#set-the-requirements-element-in-the-manifest)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="ee150-133">For instructions, see [Set the Requirements element in the manifest](../develop/specify-office-hosts-and-api-requirements.md#set-the-requirements-element-in-the-manifest).</span></span> <span data-ttu-id="ee150-134">または、「 [JavaScript コードでランタイムチェックを使用](../develop/specify-office-hosts-and-api-requirements.md#use-runtime-checks-in-your-javascript-code)する」で説明されているように、 **addincommands 1.3** がサポートされていない場合に、アドインの代替操作を実行するようにアドインを設計することもできます。</span><span class="sxs-lookup"><span data-stu-id="ee150-134">Alternatively, you can design your add-in to have an alternate experience when **AddinCommands 1.3** is not supported, as described in [Use runtime checks in your JavaScript code](../develop/specify-office-hosts-and-api-requirements.md#use-runtime-checks-in-your-javascript-code).</span></span> <span data-ttu-id="ee150-135">たとえば、カスタムタブが目的の場所に配置されていると仮定した場合、アドインには、タブが右端であると想定される代替バージョンがあります。</span><span class="sxs-lookup"><span data-stu-id="ee150-135">For example, if your add-in contains instructions that assume the custom tab is where you want it, you could have an alternate version that assumes the tab is the rightmost.</span></span>
