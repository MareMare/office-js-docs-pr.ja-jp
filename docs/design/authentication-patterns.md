# <a name="authentication-patterns"></a>認証パターン

アドインでは、機能にアクセスするためにユーザーにサインインまたはサインアップする必要があります。 ユーザー名とパスワードの入力ボックス、またはサードパーティの資格情報フローを開始するボタンは、認証エクスペリエンスにおける共通のインターフェイス コントロールです。 シンプルで効率的な認証エクスペリエンスは、アドインを使用してユーザーを開始させるための重要な第一歩です。

## <a name="best-practices"></a>ベスト プラクティス

|するべきこと|してはいけないこと|
|:----|:----|
|シングル サインオン（SSO）を使用して、アドインにユーザーを認証します。|ユーザーが自分の個人用MicrosoftアカウントまたはOffice 365アカウント（職場または学校）とは別にアドインにサインインするように要求する。|
|サインインする前に、アドインの価値を記述するか、アカウントを必要とせずに機能をデモンストレーションしてください。 |ユーザーがアドインの価値と利点を理解することなくサインインすることを期待してください。|
|各画面には、目立つ主要なボタンが表示され、認証フローを通じてユーザーをガイドします。 |競合するボタンや行動を促すコールで、第二次、第三次のタスクに注意を喚起してください。|
|「サインイン」や「アカウントの作成」などの特定のタスクを説明するクリア ボタンのラベルを使用します。   |「送信」や「開始」のような曖昧なボタンラベルを使用すると、ユーザーは認証フローをガイドできます。|
|ダイアログを使用して、認証フォームにユーザーの注意を集中させます。    |最初の実行経験と認証フォームを使用して作業ペインをオーバークラウドします。|
|入力ボックスのオートフォーカスのようなフローの小さな効率を見つけます。 |ユーザーがフォームフィールドをクリックするような操作のような、不要なステップをインタラクションに追加します。|
|ユーザーがサインアウトして再認証する方法を提供します。    |ユーザーを強制的にアンインストールしてIDを切り替えます。|

> [!NOTE]
> 現在、シングル サインオン API は Word、Excel、Outlook、PowerPoint のプレビューでサポートされています。 シングル サインオン API の現在のサポート状態に関する詳細は、「[IdentityAPI の要件セット](https://dev.office.com/reference/add-ins/requirement-sets/identity-api-requirement-sets)」を参照してください。 Outlook アドインで作業している場合は、Office 365 テナントの先進認証が有効になっていることを確認してください。 この方法の詳細については、「[Exchange Online: テナントの先進認証を有効にする方法](https://social.technet.microsoft.com/wiki/contents/articles/32711.exchange-online-how-to-enable-your-tenant-for-modern-authentication.aspx)」を参照してください。


## <a name="authentication-flow"></a>認証フロー
ユーザーがシングルサインオンをまだ利用できない場合は、代替認証フローを検討してください。 ユーザーには、サービスや Microsoft などのID プロバイダに直接サインインする選択肢を与えます。

1. First Run Placemat  - サインインボタンを、アドインの最初の実行経験の中に明確なコールアクトアクションとして配置します。
![](../images/add-in-fre-value-placemat.png)

2. ID プロバイダの選択肢ダイアログ - 必要に応じてユーザー名とパスワードのフォームを含む ID プロバイダの明確な一覧を表示します。 認証ダイアログが開いている間、アドインUIがブロックされることがあります。
![](../images/add-in-auth-choices-dialog.png)



3. ID プロバイダのサインイン - ID プロバイダには独自のUIがあります。 Microsoft Azure Active Directoryではサインインパネルとアクセスパネルのページをカスタマイズして、一貫したルック・アンド・フィールをサービスに提供できます。 ([詳細を見る](https://docs.microsoft.com/azure/active-directory/fundamentals/customize-branding))。
![](../images/add-in-auth-identity-sign-in.png)

4. 進行状況 - 設定やUIの読み込み中に進行状況を示します。
![](../images/add-in-auth-modal-interstitial.png)

> [!NOTE] 
> マイクロソフトのIDサービスを使用する場合は、明暗のテーマに合わせてカスタマイズ可能なブランドのサイン インボタンを使用することができます。 詳しい情報をご覧ください。

## <a name="single-sign-on-authentication-flow"></a>シングル サインオン認証フロー
シングル サインオンはまだプレビュー中です。 一般に利用可能になったら、それを使用して最もスムーズなエンドユーザー体験を実現します。 Office内のユーザーのIDは、アドインにサインインするために使用されます。 結果として、ユーザーは一度だけサインインします。 これにより、経験の中の摩擦が排除され、顧客が簡単に開始することができます。

1. アドインがインストールされると、以下のような同意ウィンドウが表示されます。 ![](../images/add-in-auth-SSO-consent-dialog.png)
> [!NOTE]
> アドインパブリッシャーは、同意ウィンドウに含まれるロゴ、文字列、および権限スコープを制御します。 UI は Microsoft によって事前設定されています。

2. ユーザーが同意すると、アドインが読み込まれます。 必要なユーザー カスタマイズ情報を抽出して表示することができます。
![](../images/add-in-ribbon.png)

## <a name="see-also"></a>関連項目
- [SSO アドインの開発](https://docs.microsoft.com/office/dev/add-ins/develop/sso-in-office-add-ins)について詳細を知る