# <a name="authentication-patterns"></a><span data-ttu-id="f2e32-101">認証パターン</span><span class="sxs-lookup"><span data-stu-id="f2e32-101">Authentication patterns</span></span>

<span data-ttu-id="f2e32-102">アドインでは、機能にアクセスするためにユーザーにサインインまたはサインアップする必要があります。</span><span class="sxs-lookup"><span data-stu-id="f2e32-102">Add-ins may require users to sign-in or sign-up in order to access features and functionality.</span></span> <span data-ttu-id="f2e32-103">ユーザー名とパスワードの入力ボックス、またはサードパーティの資格情報フローを開始するボタンは、認証エクスペリエンスにおける共通のインターフェイス コントロールです。</span><span class="sxs-lookup"><span data-stu-id="f2e32-103">Input boxes for username and password or buttons that start third party credential flows are common interface controls in authentication experiences.</span></span> <span data-ttu-id="f2e32-104">シンプルで効率的な認証エクスペリエンスは、アドインを使用してユーザーを開始させるための重要な第一歩です。</span><span class="sxs-lookup"><span data-stu-id="f2e32-104">A simple and efficient authentication experience is an important first step to getting users started with your add-in.</span></span>

## <a name="best-practices"></a><span data-ttu-id="f2e32-105">ベスト プラクティス</span><span class="sxs-lookup"><span data-stu-id="f2e32-105">Best practices</span></span>

|<span data-ttu-id="f2e32-106">するべきこと</span><span class="sxs-lookup"><span data-stu-id="f2e32-106">Do</span></span>|<span data-ttu-id="f2e32-107">してはいけないこと</span><span class="sxs-lookup"><span data-stu-id="f2e32-107">Don't</span></span>|
|:----|:----|
|<span data-ttu-id="f2e32-108">シングル サインオン（SSO）を使用して、アドインにユーザーを認証します。</span><span class="sxs-lookup"><span data-stu-id="f2e32-108">Use single sign-on (SSO) to authenticate users into your add-in.</span></span>|<span data-ttu-id="f2e32-109">ユーザーが自分の個人用MicrosoftアカウントまたはOffice 365アカウント（職場または学校）とは別にアドインにサインインするように要求する。</span><span class="sxs-lookup"><span data-stu-id="f2e32-109">Require users to sign into your add-in separately from their personal Microsoft account or their Office 365 account (work or school).</span></span>|
|<span data-ttu-id="f2e32-110">サインインする前に、アドインの価値を記述するか、アカウントを必要とせずに機能をデモンストレーションしてください。</span><span class="sxs-lookup"><span data-stu-id="f2e32-110">Prior to sign-in, describe the value of your add-in or demonstrate functionality without requiring an account.</span></span> |<span data-ttu-id="f2e32-111">ユーザーがアドインの価値と利点を理解することなくサインインすることを期待してください。</span><span class="sxs-lookup"><span data-stu-id="f2e32-111">Expect users to sign-in without understanding the value and benefits of your add-in.</span></span>|
|<span data-ttu-id="f2e32-112">各画面には、目立つ主要なボタンが表示され、認証フローを通じてユーザーをガイドします。</span><span class="sxs-lookup"><span data-stu-id="f2e32-112">Guide users through authentication flows with a primary, highly visible button on each screen.</span></span> |<span data-ttu-id="f2e32-113">競合するボタンや行動を促すコールで、第二次、第三次のタスクに注意を喚起してください。</span><span class="sxs-lookup"><span data-stu-id="f2e32-113">Draw attention to secondary and tertiary tasks with competing buttons and calls to action.</span></span>|
|<span data-ttu-id="f2e32-114">「サインイン」や「アカウントの作成」などの特定のタスクを説明するクリア ボタンのラベルを使用します。</span><span class="sxs-lookup"><span data-stu-id="f2e32-114">Use clear button labels that describe specific tasks like "Sign in" or "Create account".</span></span>   |<span data-ttu-id="f2e32-115">「送信」や「開始」のような曖昧なボタンラベルを使用すると、ユーザーは認証フローをガイドできます。</span><span class="sxs-lookup"><span data-stu-id="f2e32-115">Use vague button labels like "Submit" or "Get started" to guide users through authentication flows.</span></span>|
|<span data-ttu-id="f2e32-116">ダイアログを使用して、認証フォームにユーザーの注意を集中させます。</span><span class="sxs-lookup"><span data-stu-id="f2e32-116">Use a dialog to focus users' attention on authentication forms.</span></span>    |<span data-ttu-id="f2e32-117">最初の実行経験と認証フォームを使用して作業ペインをオーバークラウドします。</span><span class="sxs-lookup"><span data-stu-id="f2e32-117">Overcrowd your task pane with a first run experience and authentication forms.</span></span>|
|<span data-ttu-id="f2e32-118">入力ボックスのオートフォーカスのようなフローの小さな効率を見つけます。</span><span class="sxs-lookup"><span data-stu-id="f2e32-118">Find small efficiencies in the flow like auto-focusing on input boxes.</span></span> |<span data-ttu-id="f2e32-119">ユーザーがフォームフィールドをクリックするような操作のような、不要なステップをインタラクションに追加します。</span><span class="sxs-lookup"><span data-stu-id="f2e32-119">Add unnecessary steps to the interaction like requiring users to click into form fields.</span></span>|
|<span data-ttu-id="f2e32-120">ユーザーがサインアウトして再認証する方法を提供します。</span><span class="sxs-lookup"><span data-stu-id="f2e32-120">Provide a way for users to sign-out and reauthenticate.</span></span>    |<span data-ttu-id="f2e32-121">ユーザーを強制的にアンインストールしてIDを切り替えます。</span><span class="sxs-lookup"><span data-stu-id="f2e32-121">Force users to uninstall to switch identities.</span></span>|

> [!NOTE]
> <span data-ttu-id="f2e32-122">現在、シングル サインオン API は Word、Excel、Outlook、PowerPoint のプレビューでサポートされています。</span><span class="sxs-lookup"><span data-stu-id="f2e32-122">The Single Sign-on API is currently supported in preview for Word, Excel, Outlook, and PowerPoint.</span></span> <span data-ttu-id="f2e32-123">シングル サインオン API の現在のサポート状態に関する詳細は、「[IdentityAPI の要件セット](https://dev.office.com/reference/add-ins/requirement-sets/identity-api-requirement-sets)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="f2e32-123">For more information about where the Single Sign-on API is currently supported, see [IdentityAPI requirement sets](https://dev.office.com/reference/add-ins/requirement-sets/identity-api-requirement-sets).</span></span> <span data-ttu-id="f2e32-124">Outlook アドインで作業している場合は、Office 365 テナントの先進認証が有効になっていることを確認してください。</span><span class="sxs-lookup"><span data-stu-id="f2e32-124">If you are working with an Outlook add-in, be sure to enable Modern Authentication for the Office 365 tenancy.</span></span> <span data-ttu-id="f2e32-125">この方法の詳細については、「[Exchange Online: テナントの先進認証を有効にする方法](https://social.technet.microsoft.com/wiki/contents/articles/32711.exchange-online-how-to-enable-your-tenant-for-modern-authentication.aspx)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="f2e32-125">For information about how to do this, see [Exchange Online: How to enable your tenant for modern authentication](https://social.technet.microsoft.com/wiki/contents/articles/32711.exchange-online-how-to-enable-your-tenant-for-modern-authentication.aspx).</span></span>


## <a name="authentication-flow"></a><span data-ttu-id="f2e32-126">認証フロー</span><span class="sxs-lookup"><span data-stu-id="f2e32-126">Authentication flow</span></span>
<span data-ttu-id="f2e32-127">ユーザーがシングルサインオンをまだ利用できない場合は、代替認証フローを検討してください。</span><span class="sxs-lookup"><span data-stu-id="f2e32-127">If single sign-on is not yet available to your users, consider an alternative authentication flow.</span></span> <span data-ttu-id="f2e32-128">ユーザーには、サービスや Microsoft などのID プロバイダに直接サインインする選択肢を与えます。</span><span class="sxs-lookup"><span data-stu-id="f2e32-128">Give users a choice to sign-in directly with your service or an identity provider like Microsoft.</span></span>

1. <span data-ttu-id="f2e32-129">First Run Placemat  - サインインボタンを、アドインの最初の実行経験の中に明確なコールアクトアクションとして配置します。</span><span class="sxs-lookup"><span data-stu-id="f2e32-129">First Run Placemat - Place your sign-in button as a clear call-to action inside your add-in's first run experience.</span></span>
![](../images/add-in-fre-value-placemat.png)

2. <span data-ttu-id="f2e32-130">ID プロバイダの選択肢ダイアログ - 必要に応じてユーザー名とパスワードのフォームを含む ID プロバイダの明確な一覧を表示します。</span><span class="sxs-lookup"><span data-stu-id="f2e32-130">Identity Provider Choices Dialog - Display a clear list of identity providers including a username and password form if applicable.</span></span> <span data-ttu-id="f2e32-131">認証ダイアログが開いている間、アドインUIがブロックされることがあります。</span><span class="sxs-lookup"><span data-stu-id="f2e32-131">Your add-in UI may be blocked while the authentication dialog is open.</span></span>
![](../images/add-in-auth-choices-dialog.png)



3. <span data-ttu-id="f2e32-132">ID プロバイダのサインイン - ID プロバイダには独自のUIがあります。</span><span class="sxs-lookup"><span data-stu-id="f2e32-132">Identity Provider Sign-in - The identity provider will have their own UI.</span></span> <span data-ttu-id="f2e32-133">Microsoft Azure Active Directoryではサインインパネルとアクセスパネルのページをカスタマイズして、一貫したルック・アンド・フィールをサービスに提供できます。</span><span class="sxs-lookup"><span data-stu-id="f2e32-133">Microsoft Azure Active Directory allows customization of sign-in and access panel pages for consistent look and feel with your service.</span></span> <span data-ttu-id="f2e32-134">([詳細を見る](https://docs.microsoft.com/azure/active-directory/fundamentals/customize-branding))。</span><span class="sxs-lookup"><span data-stu-id="f2e32-134">Learn More</span></span>
![](../images/add-in-auth-identity-sign-in.png)

4. <span data-ttu-id="f2e32-135">進行状況 - 設定やUIの読み込み中に進行状況を示します。</span><span class="sxs-lookup"><span data-stu-id="f2e32-135">Progress - Indicate progress while settings and UI load.</span></span>
![](../images/add-in-auth-modal-interstitial.png)

> [!NOTE] 
> <span data-ttu-id="f2e32-136">マイクロソフトのIDサービスを使用する場合は、明暗のテーマに合わせてカスタマイズ可能なブランドのサイン インボタンを使用することができます。</span><span class="sxs-lookup"><span data-stu-id="f2e32-136">When using Microsoft's Identity service you'll have the opportunity to use a branded sign-in button that is customizable to light and dark themes.</span></span> <span data-ttu-id="f2e32-137">詳しい情報をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="f2e32-137">Learn more.</span></span>

## <a name="single-sign-on-authentication-flow"></a><span data-ttu-id="f2e32-138">シングル サインオン認証フロー</span><span class="sxs-lookup"><span data-stu-id="f2e32-138">Single Sign-On authentication flow</span></span>
<span data-ttu-id="f2e32-139">シングル サインオンはまだプレビュー中です。</span><span class="sxs-lookup"><span data-stu-id="f2e32-139">Single sign-on is still in preview.</span></span> <span data-ttu-id="f2e32-140">一般に利用可能になったら、それを使用して最もスムーズなエンドユーザー体験を実現します。</span><span class="sxs-lookup"><span data-stu-id="f2e32-140">Once generally available, use it for the smoothest end-user experience.</span></span> <span data-ttu-id="f2e32-141">Office内のユーザーのIDは、アドインにサインインするために使用されます。</span><span class="sxs-lookup"><span data-stu-id="f2e32-141">The user's identity within Office is used to sign-in to your add-in.</span></span> <span data-ttu-id="f2e32-142">結果として、ユーザーは一度だけサインインします。</span><span class="sxs-lookup"><span data-stu-id="f2e32-142">As a result users only sign-in once.</span></span> <span data-ttu-id="f2e32-143">これにより、経験の中の摩擦が排除され、顧客が簡単に開始することができます。</span><span class="sxs-lookup"><span data-stu-id="f2e32-143">This removes friction in the experience making it easier for your customers to get started.</span></span>

1. <span data-ttu-id="f2e32-144">アドインがインストールされると、以下のような同意ウィンドウが表示されます。 ![](../images/add-in-auth-SSO-consent-dialog.png)</span><span class="sxs-lookup"><span data-stu-id="f2e32-144">As an add-in is being installed, a user will see a consent window similar to the one below: ![](../images/add-in-auth-SSO-consent-dialog.png)</span></span>
> [!NOTE]
> <span data-ttu-id="f2e32-145">アドインパブリッシャーは、同意ウィンドウに含まれるロゴ、文字列、および権限スコープを制御します。</span><span class="sxs-lookup"><span data-stu-id="f2e32-145">The add-in publisher will have control over the logo, strings and permission scopes included in the consent window.</span></span> <span data-ttu-id="f2e32-146">UI は Microsoft によって事前設定されています。</span><span class="sxs-lookup"><span data-stu-id="f2e32-146">The UI is pre-configured by Microsoft.</span></span>

2. <span data-ttu-id="f2e32-147">ユーザーが同意すると、アドインが読み込まれます。</span><span class="sxs-lookup"><span data-stu-id="f2e32-147">The add-in will load after the user consents.</span></span> <span data-ttu-id="f2e32-148">必要なユーザー カスタマイズ情報を抽出して表示することができます。</span><span class="sxs-lookup"><span data-stu-id="f2e32-148">It can extract and display any necessary user customized information.</span></span>
![](../images/add-in-ribbon.png)

## <a name="see-also"></a><span data-ttu-id="f2e32-149">関連項目</span><span class="sxs-lookup"><span data-stu-id="f2e32-149">See also</span></span>
- <span data-ttu-id="f2e32-150">[SSO アドインの開発](https://docs.microsoft.com/office/dev/add-ins/develop/sso-in-office-add-ins)について詳細を知る</span><span class="sxs-lookup"><span data-stu-id="f2e32-150">Learn more about [developing SSO Add-ins](https://docs.microsoft.com/office/dev/add-ins/develop/sso-in-office-add-ins)</span></span>