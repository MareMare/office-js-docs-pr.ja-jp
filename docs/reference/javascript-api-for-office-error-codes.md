# <a name="javascript-api-for-office-error-codes"></a>JavaScript API for Office のエラー コード

この記事では、JavaScript API for Office (Office.js) の使用時に出てくる可能性があるエラー メッセージについて説明します。

**適用対象:** Office アドイン | SharePoint アドイン | Excel | Outlook | PowerPoint | Project | Word

## <a name="error-codes"></a>エラー コード

次の表に、エラー コード、名称、表示されるメッセージ、それらが示す状態を示します。

|**Error.code**|**Error.name**|**Error.message**|**条件**|
|:-----|:-----|:-----|:-----|
|1000|このタイプの強制型変換はできません|指定タイプの強制型変換はサポートされていません。|ホスト アプリケーションではこのタイプの強制型変換はサポートされていません (たとえば、OOXMLとHTMLの強制型変換タイプはExcelでサポートされていません)。|
|1001|データの読み取りエラー|現在の選択項目はサポートされていません。|現在ユーザーが選んだ項目はサポートされていません (つまり、サポートされている強制型変換と異なっている部分があります)。|
|1002|このタイプの強制型変換はできません|指定された強制型変換は、このバインディング タイプと互換性がありません。|ソリューション開発者が指定した強制型変換とバインディング タイプの組み合わせに互換性がありません。|
|1003|データの読み取りエラー|指定した rowCount または columnCount の値が無効です。|ユーザーが無効な列数または行数を指定しています。|
|1004|データの読み取りエラー|現在の選択項目は指定された強制型変換と互換性がありません。|このアプリで、現在の選択項目の指定された強制型変換はサポートされていません。|
|1005|データの読み取りエラー|指定された startRow または startColumn の値が正しくありません。|ユーザーが無効な startRow または startCol の値を指定しています。|
|1006|データの読み取りエラー|テーブルに結合されたセルが含まれている場合、座標パラメーターを強制型変換タイプ 「Table」 と共に使用できません。|ユーザーは一様でないテーブル (つまり、マージされたセルを持つテーブル) から一部のデータを取得しようとしています。 |
|1007|データの読み取りエラー|ドキュメントのサイズが大きすぎます。|ユーザーが、現在サポートされているサイズより大きいドキュメントを取得しようとしています。|
|1008|データの読み取りエラー|要求されたデータ セットが大きすぎます。|ユーザーがホスト アドインで定義されたデータの制限を超えるデータの読み取りを要求しています。|
|1009|データの読み取りエラー|指定されたファイルの種類はサポートされていません。|ユーザーが、無効なファイルの種類を送信しています。|
|2000|データの書き込みエラー|指定されたデータ オブジェクトの型はサポートされていません。 |サポートされていないデータ オブジェクトが指定されています。|
|2001|データの書き込みエラー|現在の選択項目に書き込むことができません。|ユーザーの現在の選択項目は、書き込み操作でサポートされていません (ユーザーがイメージを選択した場合など)。|
|2002|データの書き込みエラー|指定されたデータ オブジェクトは、現在の選択項目の形状または大きさと互換性がありません。|複数のセルが選択されています (また、選択項目の形状がデータの形状と一致しません)。複数のセルが選択されています (また、選択項目の大きさがデータの大きさと一致しません)。|
|2003|データの書き込みエラー|指定されたデータ オブジェクトがデータを上書きするため、設定操作に失敗しました。|一つのセルが選択され、指定されたデータ オブジェクトが、ワークシート内のデータを上書きします。|
|2004|データの書き込みエラー|指定されたデータ オブジェクトが、現在の選択項目のサイズと一致しません。|ユーザーが、現在の選択項目のサイズよりも大きいオブジェクトを指定しています。|
|2005|データの書き込みエラー|指定された startRow または startColumn の値が正しくありません。|ユーザーが無効な startRow または startCol の値を指定しています。|
|2006|無効な形式のエラー|指定されたデータ オブジェクトの形式が正しくありません。|ソリューション開発者が、HTML または OOXML の無効な文字列、HTML の不正な文字列、または OOXML の無効な文字列を指定しています。|
|2007|無効なデータ オブジェクト|指定されたデータ オブジェクトの型は、現在の選択項目と互換性がありません。|ソリューション開発者が、指定された強制型変換と互換性のないデータ オブジェクトを指定しています。|
|2008|データの書き込みエラー|未定|未定|
|2009|データの書き込みエラー|指定されたデータ オブジェクトが大きすぎます。|ユーザーがホスト アドインで定義されたデータの制限を超えたデータを設定しようとしています。|
|2010|データの書き込みエラー|テーブルに結合されたセルが含まれている場合は、座標パラメーターを強制変換タイプ 「Table」 といっしょに使用できません。|ユーザーが一様でないテーブル (つまり、結合されたセルを持つテーブル) から一部のデータを設定しようとしています。|
|3000|バインディングの作成エラー|現在の選択項目をバインドできません。|ユーザーの選択項目は、バインディングではサポートされていません (たとえば、ユーザーがイメージまたはその他のサポートされていないオブジェクトを選択しています)。|
|3001|バインディングの作成エラー|未定|未定|
|3002|無効なバインディング エラー|指定されたバインディングが存在しません。|開発者は、存在しない、または削除されたバインディングにバインドしようとしています。|
|3003|バインディングの作成エラー|連続していない選択項目はサポートされません。|ユーザーが複数を選択しています。|
|3004|バインディングの作成エラー|現在の選択項目と指定されたバインディング タイプでバインディングを作成できません。|これが発生する条件は数個考えられます。この資料の後半の「バインディングの作成エラーの条件」セクションを参照してください。|
|3005|無効なバインディング操作|このバインディング タイプではサポートされていない操作です。|開発者が _テーブル_ ではないバインディング タイプに行の追加操作または列の追加操作を送信しています。|
|3006|バインディングの作成エラー|この名前のアイテムが存在しません。|この名前のアイテムが見つかりませんでした。 その名前を持つコンテンツ コントロールまたはテーブルが存在しません。|
|3007|バインディングの作成エラー|同じ名前を持つオブジェクトが複数見つかりました。|競合エラー: 同じ名前を持つコンテンツ コントロールが複数存在し、競合の失敗が  **true** に設定されています。|
|3008|バインディングの作成エラー|指定されたバインディング タイプは、指定された名前のアイテムと互換性がありません。|この名前のアイテムは型にバインドできません。たとえば、コンテンツ コントロールにテキストが含まれていますが、開発者が型変換タイプ  _table_ を使用してバインドしようとしています。|
|3009|無効なバインディング操作|バインディング タイプがサポートされていません。|下位互換性のために使用されます。|
|3010|サポートされないバインド操作|選択したコンテンツはテーブル形式でなければいけません。データをテーブルとして書式設定し、もう一度お試しください。|開発者が強制型変換タイプ _matrix_ のデータ上の **TableBinding** オブジェクトの **addRowsAsynch** メソッドまたは **deleteAllDataValuesAsynch** メソッドを使用しようとしています。|
|4000|設定の読み取りエラー|指定された設定名が存在しません。|存在しない設定名が指定されています。|
|4001|設定の保存エラー|設定を保存できませんでした。|設定を保存できませんでした。|
|4002|古い設定のエラー|設定が古いため保存できませんでした。|設定が古く、開発者が設定を上書きしないよう指定しています。|
|5000|古い設定のエラー|この操作はサポートされていません。|この操作は現在のホストではサポートされていません。たとえば、 **document.getSelectionAsync** が Outlook から呼び出されています。|
|5001|内部エラー|内部エラーが発生しました。|内部エラー条件は、次のいずれかの理由で発生する可能性があります。<br/><table><tr><td>ブックを共有している他のユーザーが使用しているアドインが、ほとんど同時にバインドを作成しました。使用しているアドインで、再バインドを行わなければいけません。</tr></td><tr><td>不明なエラーが発生しました。</tr></td><tr><td>処理に失敗しました。</tr></td><tr><td>ユーザーが権限を持つロールのメンバーではないために、アクセスが拒否されました。</tr></td><tr><td>暗号化されたセキュリティ保護通信が必要なため、アクセスが拒否されました。</tr></td><tr><td>データが古いため、ユーザーはクエリがデータを再取得できるよう確認しなければなりません。</tr></td><tr><td>サイト コレクションの CPU クォータが限界を超えています。</tr></td><tr><td>サイト コレクションのメモリ クォータが限界を超えています。</tr></td><tr><td>セッションのメモリ クォータが限界を超えています。</tr></td><tr><td>ブックが無効な状態なので、操作を実行できません。</tr></td><tr><td>アイドル状態が続いたためセッションがタイムアウトしました。ユーザーはブックを再読み込みしなければなりません。</tr></td><tr><td>ユーザーごとに許可されるセッションの最大数を超えています。</tr></td><tr><td>ユーザーが操作を取り消しました。</tr></td><tr><td>時間がかかりすぎているため、操作を完了できません。</tr></td><tr><td>要求を完了できません。再試行してください。</tr></td><tr><td>製品の試用期間の期限が切れています。</tr></td><tr><td>アイドル状態が続いたのでセッションがタイムアウトしました。</tr></td><tr><td>ユーザーは指定されたセル範囲に対する操作を実行する権限がありません。</tr></td><tr><td>現在のコラボレーションのセッションとユーザーの地域設定が一致しません。</tr></td><tr><td>ユーザーが接続されていません。ブックを更新し再度開く必要があります。</tr></td><tr><td>要求した範囲がシートに存在しません。</tr></td><tr><td>ユーザーにブックを編集する権限がありません。</tr></td><tr><td>ブックはロックされているので、編集できません。</tr></td><tr><td>セッションは、ブックを自動的に保存できません。</tr></td><tr><td>セッションは、ブック ファイルのロックを更新できません。</tr></td><tr><td>要求を処理できません。再試行してください。</tr></td><tr><td>ユーザーのサインイン情報を検証できませんでした。もう一度入力してください。</tr></td><tr><td>ユーザーのアクセスが拒否されています。</tr></td><tr><td>共有ブックを更新する必要があります。</tr></td></table>|
|5002|アクセスが拒否されました|要求された操作は、現在のドキュメント モードでは許可されていません。|ソリューション開発者が設定操作を送信しましたが、ドキュメントが 「編集の制限」 など、変更を許可しないモードに設定されています。|
|5003|イベント登録エラー|指定されたイベントの種類は、現在のオブジェクトではサポートされていません。|ソリューション開発者が、存在しないイベントにハンドラーを登録または登録解除しようとしています。|
|5004|無効な API 呼び出し|現在のコンテキストで無効な API 呼び出しです。|Excel で  **CustomXMLPart** オブジェクトを使用しようとするなど、コンテキストに対して無効な呼び出しが行われています。|
|5005|旧型データ|サーバー上のデータが古いため、操作が失敗しました。|サーバー上のデータを更新する必要があります。|
|5006|セッションのタイムアウト|ドキュメント セッションがタイムアウトしました。 ドキュメントを再読み込みします。 |セッションがタイムアウトになりました。|
|5007|無効な API 呼び出し|列挙体は、現在のコンテキストではサポートされていません。|列挙体は、現在のコンテキストではサポートされていません。|
|5009|アクセスが拒否されました|アクセスが拒否されました|アドインに特定の API を呼び出すためのアクセス許可がありません。|
|6000|無効なノード|指定されたノードが見つかりませんでした。|**CustomXmlPart** ノードが見つかりませんでした。|
|6100|カスタム XML エラー|カスタム XML エラー|無効な API 呼び出し|
|7000|無効な ID|指定された ID が存在しません。|無効な ID|
|7001|無効なナビゲーション|ナビゲーションがサポートされていない場所にオブジェクトがあります。|ユーザーはオブジェクトを見つけることができますが、ナビゲーションできません (たとえば、Word ではヘッダー、フッター、またはコメントにバインドされています)。|
|7002|無効なナビゲーション|オブジェクトがロックされているか、保護されています。|ロックまたは保護された範囲へ移動しようとしています。|
|7004|無効なナビゲーション|インデックスが範囲を超えているため、操作に失敗しました。|範囲外のインデックスに移動しようとしています。|
|8000|パラメーターがありません|一部のパラメーターの値が存在しないため、テーブルのセルの書式を設定できませんでした。 パラメーターを確認して、もう一度やり直してください。|cellFormat メソッドに一部のパラメーターがありません。 たとえば、cells、format、または tableOptions パラメーターがありません。|
|8010|無効な値|一つ以上の cells パラメーター値が使用できません。値を確認して、もう一度やり直してください。|一般的なセル参照列挙型が定義されていません。 たとえば、All、Data、Headers などです。|
|8011|無効な値|一つ以上の tableOptions パラメーター値が使用できません。値を確認して、もう一度やり直してください。|tableOptions の値のいずれかが無効です。|
|8012|無効な値|一つ以上の format パラメーター値が使用できません。値を確認して、もう一度やり直してください。|foramt の値のいずれかが正しくありません。|
|8020|範囲外|行のインデックス値が許容範囲外です。行の数よりも少ない正の値 (0 以上) を使用してください。|行のインデックスが、テーブルの最大行のインデックスより大きいか、または 0 より小さくなっています。|
|8021|範囲外|列のインデックス値が許容範囲外です。列の数よりも少ない正の値 (0 以上) を使用してください。|列のインデックスが、テーブルの最大列のインデックスより大きいか、または 0 より小さくなっています。|
|8022|範囲外|値が許容範囲外です。|形式の値の一部がサポート範囲外です。|
|9016|アクセスが拒否されました|アクセスが拒否されました|アクセスが拒否されました。|
|12002|||以下が考えられます:<br> `displayDialogAsync` に渡された URL にページが存在しない。<br> `displayDialogAsync` に渡されたページが読み込まれたが、ダイアログ ボックスが見つからないか読み込むことができないページを指していたか、またはダイアログ ボックスが無効な構文を含む URL を指している。 ダイアログにスローされ、ホスト ページ上で `DialogEventReceived` イベントを トリガーします。|
|12003|||ダイアログ ボックスが HTTP プロトコルを使用している URL を指していました。 HTTPS が必要です。 ダイアログにスローされ、ホスト ページ上で `DialogEventReceived` イベントを トリガーします。|
|12004|||`displayDialogAsync`に渡される URLのドメインは信頼されていません。 ドメインは、(プロトコルとポート番号を含む)ホスト ページと同じドメインにある必要があります。 `displayDialogAsync` の呼び出しによりスローされたものです。|
|12005|||`displayDialogAsync` に渡されたURLは、HTTP プロトコルを使用しています。 HTTPS が必要です。 `displayDialogAsync` の呼び出しによりスローされたものです。 (一部の Office のバージョンでは、12005 で返されるのと同じエラー メッセージが12004 でも返されます)。|
|12006|||ダイアログ ボックスが閉じられました。通常は、ユーザーが **X** ボタンを選択したためです。 ダイアログにスローされ、ホスト ページ上で `DialogEventReceived` イベントを トリガーします。|
|12007|||ダイアログ ボックスは、このホスト ウィンドウで既に開いています。 作業ウィンドウなど、ホスト ウィンドウで一度に開けるダイアログ ボックスは一つだけです。 `displayDialogAsync` の呼び出しによりスローされたものです。|
|13000 - 13010|||[getAccessTokenAsync からのエラーの原因と処理 ](https://docs.microsoft.com/office/dev/add-ins/develop/troubleshoot-sso-in-office-add-ins#causes-and-handling-of-errors-from-getaccesstokenasync)を参照してください。|

## <a name="binding-creation-error-conditions"></a>バインディングの作成エラーの条件

API でバインディングを作成するとき、使用するバインドの種類を指定します。次の表に、バインドの種類と結果として予想されるバインド動作を示します。

### <a name="behavior-in-excel"></a>Excel での動作

次の表は、Excel のバインド動作をまとめたものです。

|**指定されたバインディング タイプ**|**現在の選択**|**動作**|
|:-----|:-----|:-----|
|マトリックス|セルの範囲 (一つのテーブル内にあるもの、単一セルの場合を含む)|_matrix_ 型のバインドが選択されたセルに作成されます。文書内の変更はありません。|
|マトリックス|セル内の選択されたテキスト|_text_ 型のバインドがセル全体で作成されます。文書内の変更はありません。|
|マトリックス|複数の選択項目または無効な選択項目 (たとえば、ユーザーが画像、オブジェクト、ワードアートを選択した場合)。|バインドを作成できません。|
|テーブル|セルの範囲 (単一セルの場合を含む)|バインドを作成できません。|
|テーブル|テーブル内のセルの範囲 (テーブル内の 1 つのセル、テーブル全体、またはテーブルのセル内のテキストの場合を含む)。|バインドがテーブル全体で作成されます。|
|テーブル|選択項目の半分がテーブルで、半分がテーブル外です|バインドを作成できません。|
|テーブル|テーブル|バインドを作成できません。|
|テーブル|複数の選択項目または無効な選択項目 (たとえば、ユーザーが画像、オブジェクト、ワードアートなどを選択した場合)。|バインドを作成できません。|
|テキスト|セルの範囲|バインドを作成できません。|
|テキスト|テーブル内のセルの範囲|バインドを作成できません。|
|テキスト|単一セル|バインド タイプ  _text_ が作成されます。|
|テキスト|テーブル内の単一セル|バインド タイプ  _text_ が作成されます。|
|テキスト|セル内の選択されたテキスト|セル全体でバインド タイプ  _text_ が作成されます。|

### <a name="behavior-in-word"></a>Word の動作

次の表は、Word のバインド動作をまとめたものです。

|**指定されたバインディング タイプ**|**現在の選択**|**動作**|
|:-----|:-----|:-----|
|マトリックス|テキスト|バインドを作成できません。|
|マトリックス|テーブル全体|バインド タイプ  _matrix_ が作成されます。ドキュメントが変更され、コンテンツ コントロールがテーブルをラップする必要があります。 |
|マトリックス|テーブル内の範囲|バインドを作成できません。|
|マトリックス|無効な選択項目 (たとえば、複数のオブジェクト、無効なオブジェクトなど)。|バインドを作成できません。|
|テーブル|テキスト|バインドを作成できません。|
|テーブル|テーブル全体|バインド タイプ  _text_ が作成されます。|
|テーブル|テーブル内の範囲|バインドを作成できません。|
|テーブル|無効な選択項目 (たとえば、複数のオブジェクト、無効なオブジェクトなど)。|バインドを作成できません。|
|テキスト|テーブル全体|バインド タイプ  _text_ が作成されます。|
|テキスト|テーブル内の範囲|バインドを作成できません。|
|テキスト|複数選択|最後の選択項目がコンテンツ コントロール内でラップされ、そのコントロールにバインドされます。型  _text_ のコンテンツ コントロールが作成されます。|
|テキスト|無効な選択項目 (たとえば、複数のオブジェクト、無効なオブジェクトなど)。|バインドを作成できません。|

## <a name="see-also"></a>関連項目
   
- [Office アドインの開発ライフサイクル](https://docs.microsoft.com/office/dev/add-ins/concepts/add-in-development-lifecycle)
    
