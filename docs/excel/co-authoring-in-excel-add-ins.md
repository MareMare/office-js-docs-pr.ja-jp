---
title: Excel アドインの共同編集機能
description: ''
ms.date: 12/04/2017
ms.openlocfilehash: 6831b829b7b40561a348335b4c9c9c07da27f6a3
ms.sourcegitcommit: 60fd8a3ac4a6d66cb9e075ce7e0cde3c888a5fe9
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/28/2018
ms.locfileid: "27457654"
---
# <a name="coauthoring-in-excel-add-ins"></a><span data-ttu-id="fffbb-102">Excel アドインの共同編集機能</span><span class="sxs-lookup"><span data-stu-id="fffbb-102">Coauthoring in Excel add-ins</span></span>  

<span data-ttu-id="fffbb-103">[共同編集機能](https://support.office.com/article/Collaborate-on-Excel-workbooks-at-the-same-time-with-co-authoring-7152aa8b-b791-414c-a3bb-3024e46fb104)により、複数のユーザーが連携して同じ Excel ブックを同時に編集できるようになります。</span><span class="sxs-lookup"><span data-stu-id="fffbb-103">With [coauthoring](https://support.office.com/article/Collaborate-on-Excel-workbooks-at-the-same-time-with-co-authoring-7152aa8b-b791-414c-a3bb-3024e46fb104), multiple people can work together and edit the same Excel workbook simultaneously.</span></span> <span data-ttu-id="fffbb-104">ブックのすべての共同編集者は、他の共同編集者がブックを保存するとすぐに、その共同編集者による変更の内容を確認できます。</span><span class="sxs-lookup"><span data-stu-id="fffbb-104">All coauthors of a workbook can see another coauthor's changes as soon as that coauthor saves the workbook.</span></span> <span data-ttu-id="fffbb-105">Excel ブックを共同編集するには、そのブックが OneDrive、OneDrive for Business、SharePoint Online のいずれかに保存されている必要があります。</span><span class="sxs-lookup"><span data-stu-id="fffbb-105">To coauthor an Excel workbook, the workbook must be stored in OneDrive, OneDrive for Business, or SharePoint Online.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="fffbb-106">Office 365 の Excel には、左上隅に [自動保存] があります。</span><span class="sxs-lookup"><span data-stu-id="fffbb-106">In Excel 2016 for Office 365, you will notice AutoSave in the upper-left corner.</span></span> <span data-ttu-id="fffbb-107">[自動保存] をオンにすると、共同編集者はリアルタイムで変更内容を確認できます。</span><span class="sxs-lookup"><span data-stu-id="fffbb-107">When AutoSave is turned on, coauthors see your changes in real time.</span></span> <span data-ttu-id="fffbb-108">Excel アドインの設計時には、この動作の影響を考慮に入れておいてください。</span><span class="sxs-lookup"><span data-stu-id="fffbb-108">Consider the impact of this behavior on the design of your Excel add-in.</span></span> <span data-ttu-id="fffbb-109">ユーザーは、Excel ウィンドウの左上隅にあるスイッチで [自動保存] をオフに切り替えることができます。</span><span class="sxs-lookup"><span data-stu-id="fffbb-109">Users can turn off AutoSave via the switch in the upper left of the Excel window.</span></span>

<span data-ttu-id="fffbb-110">共同編集機能は、次のプラットフォームで使用できます。</span><span class="sxs-lookup"><span data-stu-id="fffbb-110">Coauthoring is available on the following platforms:</span></span>

- <span data-ttu-id="fffbb-111">Excel Online</span><span class="sxs-lookup"><span data-stu-id="fffbb-111">Excel Online</span></span>
- <span data-ttu-id="fffbb-112">Excel for Android</span><span class="sxs-lookup"><span data-stu-id="fffbb-112">Excel for Android</span></span>
- <span data-ttu-id="fffbb-113">Excel for iOS</span><span class="sxs-lookup"><span data-stu-id="fffbb-113">Excel for iOS</span></span>
- <span data-ttu-id="fffbb-114">Excel Mobile for Windows 10</span><span class="sxs-lookup"><span data-stu-id="fffbb-114">Excel Mobile for Windows 10</span></span>
- <span data-ttu-id="fffbb-115">Excel for Windows Desktop for Office 365 のユーザー (Windows デスクトップ ビルド 16.0.8326.2076 以降、2017 年 8 月から Current Channel のユーザーに公開)</span><span class="sxs-lookup"><span data-stu-id="fffbb-115">Excel for Windows Desktop for Office 365 customers (Windows desktop build 16.0.8326.2076 or later, which is available to current channel customers effective August 2017)</span></span>

## <a name="coauthoring-overview"></a><span data-ttu-id="fffbb-116">共同編集機能の概要</span><span class="sxs-lookup"><span data-stu-id="fffbb-116">Coauthoring overview</span></span>
 
<span data-ttu-id="fffbb-117">ブックの内容に変更を加えると、その変更は Excel によってすべての共同編集者間で同期されます。</span><span class="sxs-lookup"><span data-stu-id="fffbb-117">When you change a workbook's content, Excel automatically synchronizes those changes across all coauthors.</span></span> <span data-ttu-id="fffbb-118">共同編集者はブックの内容を変更できますが、Excel アドイン内で実行するコードもブックの内容を変更できます。</span><span class="sxs-lookup"><span data-stu-id="fffbb-118">Coauthors can change the content of a workbook, but so can code running within an Excel add-in.</span></span> <span data-ttu-id="fffbb-119">たとえば、次に示す JavaScript のコードを Office アドイン内で実行すると、範囲の値が Contoso になります。</span><span class="sxs-lookup"><span data-stu-id="fffbb-119">For example, when the following JavaScript code runs in an Office add-in, the value of a range is set to Contoso:</span></span>

```js
range.values = [['Contoso']];
```
<span data-ttu-id="fffbb-120">すべての共同編集者間で 'Contoso' が同期されると、同じブックで作業するユーザーまたは実行中のアドインは、新しい範囲の値を認識するようになります。</span><span class="sxs-lookup"><span data-stu-id="fffbb-120">After 'Contoso' synchronizes across all coauthors, any user or add-in running in the same workbook will see the new value of the range.</span></span> 

<span data-ttu-id="fffbb-121">共同編集機能では、共有ブック内の内容のみが同期されます。</span><span class="sxs-lookup"><span data-stu-id="fffbb-121">Coauthoring only synchronizes the content within the shared workbook.</span></span> <span data-ttu-id="fffbb-122">ブックから Excel アドイン内の JavaScript 変数にコピーした値は同期されません。</span><span class="sxs-lookup"><span data-stu-id="fffbb-122">Values copied from the workbook to JavaScript variables in an Excel add-in are not synchronized.</span></span> <span data-ttu-id="fffbb-123">たとえば、アドインが JavaScript 変数にセルの値 (たとえば 'Contoso') を保存しているときに、そのセルの値を共同編集者が 'Example' に変更すると、同期後に、そのセルの値はすべての共同編集者に対して 'Example' と表示されます。</span><span class="sxs-lookup"><span data-stu-id="fffbb-123">For example, if your add-in stores the value of a cell (such as 'Contoso') in a JavaScript variable, and then a coauthor changes the value of the cell to 'Example', after synchronization all coauthors see 'Example' in the cell.</span></span> <span data-ttu-id="fffbb-124">ただし、JavaScript 変数の値は 'Contoso' に設定されたままです。</span><span class="sxs-lookup"><span data-stu-id="fffbb-124">However, the value of the JavaScript variable is still set to 'Contoso'.</span></span> <span data-ttu-id="fffbb-125">さらに、複数の共同編集者が同じアドインを使用しているときに、それぞれの共同編集者が独自に変数をコピーしている場合、その変数のコピーは同期されません。</span><span class="sxs-lookup"><span data-stu-id="fffbb-125">Furthermore, when multiple coauthors use the same add-in, each coauthor has their own copy of the variable, which is not synchronized.</span></span> <span data-ttu-id="fffbb-126">ブックの内容を使用する変数を使用するときには、その変数を使用する前に、ブック内で更新された値について必ずチェックしてください。</span><span class="sxs-lookup"><span data-stu-id="fffbb-126">When you use variables that use workbook content, be sure you check for updated values in the workbook before you use the variable.</span></span> 

## <a name="use-events-to-manage-the-in-memory-state-of-your-add-in"></a><span data-ttu-id="fffbb-127">イベントを使用したアドインのメモリ内の状態の管理</span><span class="sxs-lookup"><span data-stu-id="fffbb-127">Use events to manage the in-memory state of your add-in</span></span>
 
<span data-ttu-id="fffbb-128">Excel アドインはブックの内容を読み込んで (非表示のワークシートおよび設定オブジェクトからの読み込み)、その内容を変数などのデータ構造に保存できます。</span><span class="sxs-lookup"><span data-stu-id="fffbb-128">Excel add-ins can read workbook content (from hidden worksheets and a setting object), and then store it in data structures such as variables.</span></span> <span data-ttu-id="fffbb-129">そのようなデータ構造に元の値がコピーされた後でも、共同編集者は元のブックの内容を更新できます。</span><span class="sxs-lookup"><span data-stu-id="fffbb-129">After the original values are copied into any of these data structures, coauthors can update the original workbook content.</span></span> <span data-ttu-id="fffbb-130">つまり、データ構造にコピーした値は、ブックの内容と同期されなくなっているということです。</span><span class="sxs-lookup"><span data-stu-id="fffbb-130">This means that the copied values in the data structures are now out of sync with the workbook content.</span></span> <span data-ttu-id="fffbb-131">独自のアドインを構築するときには、ブックの内容とデータ構造に保存された値に関して、このような分離があることを必ず考慮に入れてください。</span><span class="sxs-lookup"><span data-stu-id="fffbb-131">When you build your add-ins, be sure to account for this separation of workbook content and values stored in data structures.</span></span>

<span data-ttu-id="fffbb-132">たとえば、カスタム視覚エフェクトを表示するコンテンツ アドインを作成するとします。</span><span class="sxs-lookup"><span data-stu-id="fffbb-132">For example, you might build a content add-in that displays custom visualizations.</span></span> <span data-ttu-id="fffbb-133">カスタム視覚エフェクトの状態は非表示のワークシートに保存することにします。</span><span class="sxs-lookup"><span data-stu-id="fffbb-133">The state of your custom visualizations might be saved in a hidden worksheet.</span></span> <span data-ttu-id="fffbb-134">共同編集者が同じブックを使用するときに、次のシナリオが考えられます。</span><span class="sxs-lookup"><span data-stu-id="fffbb-134">When coauthors use the same workbook, the following scenario can occur:</span></span>

- <span data-ttu-id="fffbb-135">ユーザー A がドキュメント開くと、カスタム視覚エフェクトがブックに表示されます。</span><span class="sxs-lookup"><span data-stu-id="fffbb-135">User A opens the document and the custom visualizations are shown in the workbook.</span></span> <span data-ttu-id="fffbb-136">カスタム視覚エフェクトは、非表示のワークシートからデータを読み込みます (たとえば、視覚エフェクトの色が青色に設定されているとします)。</span><span class="sxs-lookup"><span data-stu-id="fffbb-136">The custom visualizations read data from a hidden worksheet (for example, the color of the visualizations is set to blue).</span></span>
- <span data-ttu-id="fffbb-137">ユーザー B が同じドキュメントを開いて、カスタム視覚エフェクトの変更を始めます。</span><span class="sxs-lookup"><span data-stu-id="fffbb-137">User B opens the same document, and starts modifying the custom visualizations.</span></span> <span data-ttu-id="fffbb-138">ユーザー B は、カスタム視覚エフェクトの色を橙色に設定します。</span><span class="sxs-lookup"><span data-stu-id="fffbb-138">User B sets the color of the custom visualizations to orange.</span></span> <span data-ttu-id="fffbb-139">橙色の設定が非表示のワークシートに保存されます。</span><span class="sxs-lookup"><span data-stu-id="fffbb-139">Orange is saved to the hidden worksheet.</span></span>
- <span data-ttu-id="fffbb-140">ユーザー A の非表示のワークシートが新しい値の橙色で更新されます。</span><span class="sxs-lookup"><span data-stu-id="fffbb-140">User A's hidden worksheet is updated with the new value of orange.</span></span>
- <span data-ttu-id="fffbb-141">ユーザー A のカスタム視覚エフェクトは青色のままです。</span><span class="sxs-lookup"><span data-stu-id="fffbb-141">User A's custom visualizations are still blue.</span></span> 

<span data-ttu-id="fffbb-142">ユーザー A のカスタム視覚エフェクトが、共同編集者によって非表示のワークシートに加えられた変更に呼応するようにするには、[BindingDataChanged](https://docs.microsoft.com/javascript/api/office/office.bindingdatachangedeventargs) イベントを使用します。</span><span class="sxs-lookup"><span data-stu-id="fffbb-142">If you want User A's custom visualizations to respond to changes made by coauthors on the hidden worksheet, use the [BindingDataChanged](https://docs.microsoft.com/javascript/api/office/office.bindingdatachangedeventargs) event.</span></span> <span data-ttu-id="fffbb-143">これにより、共同編集者がブックの内容に加えた変更が、アドインの状態に反映されるようになります。</span><span class="sxs-lookup"><span data-stu-id="fffbb-143">This ensures that changes to workbook content made by coauthors is reflected in the state of your add-in.</span></span>

## <a name="caveats-to-using-events-with-coauthoring"></a><span data-ttu-id="fffbb-144">共同編集機能にイベントを使用する際の注意事項</span><span class="sxs-lookup"><span data-stu-id="fffbb-144">Caveats to using events with coauthoring</span></span> 

<span data-ttu-id="fffbb-145">前述したように、シナリオによっては、すべての共同編集者に向けてイベントをトリガーすることで、ユーザー エクスペリエンスが向上します。</span><span class="sxs-lookup"><span data-stu-id="fffbb-145">As described earlier, in some scenarios, triggering events for all coauthors provides an improved user experience.</span></span> <span data-ttu-id="fffbb-146">ただし、この動作がユーザー エクスペリエンスの低下を招くシナリオも存在することに注意してください。</span><span class="sxs-lookup"><span data-stu-id="fffbb-146">However, be aware that in some scenarios this behavior can produce poor user experiences.</span></span> 

<span data-ttu-id="fffbb-147">たとえば、データの入力規則のシナリオでは、一般に、イベントに呼応して UI を表示します。</span><span class="sxs-lookup"><span data-stu-id="fffbb-147">For example, in data validation scenarios, it is common to display UI in response to events.</span></span> <span data-ttu-id="fffbb-148">前のセクションで説明した [BindingDataChanged](https://docs.microsoft.com/javascript/api/office/office.bindingdatachangedeventargs) イベントは、ローカル ユーザーまたは共同編集者 (リモート) のどちらかがバインディングの範囲内でブックの内容を変更したときに実行されます。</span><span class="sxs-lookup"><span data-stu-id="fffbb-148">The [BindingDataChanged](https://docs.microsoft.com/javascript/api/office/office.bindingdatachangedeventargs) event described in the previous section runs when either a local user or coauthor (remote) changes the workbook content within the binding.</span></span> <span data-ttu-id="fffbb-149">**BindingDataChanged** イベントのイベント ハンドラーが UI を表示すると、ユーザーに自分が行った変更とは無関係の UI が表示されるようになるため、ユーザー エクスペリエンスが低下します。</span><span class="sxs-lookup"><span data-stu-id="fffbb-149">If the event handler of the **BindingDataChanged** event displays UI, users will see UI that is unrelated to changes they were working on in the workbook, leading to a poor user experience.</span></span> <span data-ttu-id="fffbb-150">アドインでイベントを使用する場合は、UI の表示を避けるようにしてください。</span><span class="sxs-lookup"><span data-stu-id="fffbb-150">Avoid displaying UI when using events in your add-in.</span></span>

## <a name="see-also"></a><span data-ttu-id="fffbb-151">関連項目</span><span class="sxs-lookup"><span data-stu-id="fffbb-151">See also</span></span> 

- [<span data-ttu-id="fffbb-152">Excel (VBA) の共同編集機能について</span><span class="sxs-lookup"><span data-stu-id="fffbb-152">About coauthoring in Excel (VBA)</span></span>](https://docs.microsoft.com/office/vba/excel/concepts/about-coauthoring-in-excel) 
- [<span data-ttu-id="fffbb-153">自動保存がアドインとマクロ (VBA) に及ぼす影響</span><span class="sxs-lookup"><span data-stu-id="fffbb-153">How AutoSave impacts add-ins and macros (VBA)</span></span>](https://docs.microsoft.com/office/vba/library-reference/concepts/how-autosave-impacts-addins-and-macros) 
