---
title: XLL ユーザー定義関数を使用してカスタム関数を拡張する
description: カスタム関数と同等の機能を持つ Excel XLL ユーザー定義関数との互換性を有効にする
ms.date: 04/29/2020
localization_priority: Normal
ms.openlocfilehash: 82f4dba3bd82743efd84a2fe88c893042c061461
ms.sourcegitcommit: 54e2892c0c26b9ad1e4dba8aba48fea39f853b6c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/18/2020
ms.locfileid: "44275771"
---
# <a name="extend-custom-functions-with-xll-user-defined-functions"></a><span data-ttu-id="19704-103">XLL ユーザー定義関数を使用してカスタム関数を拡張する</span><span class="sxs-lookup"><span data-stu-id="19704-103">Extend custom functions with XLL user-defined functions</span></span>

<span data-ttu-id="19704-104">既存の Excel XLLs を使用している場合は、Excel アドインで同等のカスタム関数を構築して、ソリューション機能をオンラインまたは Mac などの他のプラットフォームに拡張できます。</span><span class="sxs-lookup"><span data-stu-id="19704-104">If you have existing Excel XLLs, you can build equivalent custom functions in an Excel add-in to extend your solution features to other platforms such as online or on a Mac.</span></span> <span data-ttu-id="19704-105">ただし、Excel アドインには、xll で利用可能なすべての機能が含まれているわけではありません。</span><span class="sxs-lookup"><span data-stu-id="19704-105">However, Excel add-ins don't have all of the functionality available in XLLs.</span></span> <span data-ttu-id="19704-106">ソリューションで使用されている機能によっては、XLL の方が excel の excel アドインカスタム関数よりも優れた操作を提供することがあります。</span><span class="sxs-lookup"><span data-stu-id="19704-106">Depending on the functionality your solution uses, the XLL may provide a better experience than the Excel add-in custom functions in Excel on Windows.</span></span>

> [!NOTE]
> <span data-ttu-id="19704-107">COM アドインと XLL の UDF の互換性は、Office 365 サブスクリプションに接続している場合、次のプラットフォームでサポートされています。</span><span class="sxs-lookup"><span data-stu-id="19704-107">COM add-in and XLL UDF compatibility is supported by the following platforms, when connected to an Office 365 subscription:</span></span>
> - <span data-ttu-id="19704-108">Excel on the web</span><span class="sxs-lookup"><span data-stu-id="19704-108">Excel on the web</span></span>
> - <span data-ttu-id="19704-109">Windows 版 Excel (バージョン1904以降)</span><span class="sxs-lookup"><span data-stu-id="19704-109">Excel on Windows (version 1904 or later)</span></span>
> - <span data-ttu-id="19704-110">Excel on Mac (バージョン13.329 以降)</span><span class="sxs-lookup"><span data-stu-id="19704-110">Excel on Mac (version 13.329 or later)</span></span>
> 
> <span data-ttu-id="19704-111">Web 上の Excel で COM アドインと XLL UDF との互換性を使用するには、Office 365 サブスクリプションまたは[Microsoft アカウント](https://account.microsoft.com/account)のいずれかを使用してログインします。</span><span class="sxs-lookup"><span data-stu-id="19704-111">To use COM add-in and XLL UDF compatibility within Excel on the web, login by using either your Office 365 subscription or a [Microsoft account](https://account.microsoft.com/account).</span></span> <span data-ttu-id="19704-112">Office 365 サブスクリプションをまだお持ちでない場合は、 [office 365 開発者プログラム](https://developer.microsoft.com/office/dev-program)に参加することによって、無料の90日に更新可能な office 365 サブスクリプションを使用できます。</span><span class="sxs-lookup"><span data-stu-id="19704-112">If you don't already have an Office 365 subscription, you can a free, 90-day renewable Office 365 subscription by joining the [Office 365 Developer Program](https://developer.microsoft.com/office/dev-program).</span></span>

## <a name="specify-equivalent-xll-in-the-manifest"></a><span data-ttu-id="19704-113">マニフェストで同等の XLL を指定する</span><span class="sxs-lookup"><span data-stu-id="19704-113">Specify equivalent XLL in the manifest</span></span>

<span data-ttu-id="19704-114">既存の XLL との互換性を有効にするには、Excel アドインのマニフェストで同等の XLL を識別します。</span><span class="sxs-lookup"><span data-stu-id="19704-114">To enable compatibility with an existing XLL, identify the equivalent XLL in the manifest of your Excel add-in.</span></span> <span data-ttu-id="19704-115">Excel では、Windows での実行時に Excel アドインカスタム関数の代わりに XLL 関数が使用されます。</span><span class="sxs-lookup"><span data-stu-id="19704-115">Excel will then use the XLL's functions instead of your Excel add-in custom functions when running on Windows.</span></span>

<span data-ttu-id="19704-116">カスタム関数に対応する XLL を設定するには、 `FileName` xll のを指定します。</span><span class="sxs-lookup"><span data-stu-id="19704-116">To set the equivalent XLL for your custom functions, specify the `FileName` of the XLL.</span></span> <span data-ttu-id="19704-117">ユーザーが XLL から関数を含むブックを開くと、Excel は関数を互換性のある関数に変換します。</span><span class="sxs-lookup"><span data-stu-id="19704-117">When the user opens a workbook with functions from the XLL, Excel converts the functions to compatible functions.</span></span> <span data-ttu-id="19704-118">ブックは、Windows の Excel で開いたときに XLL を使用し、オンラインまたは Mac で開いたときに Excel アドインのカスタム関数を使用します。</span><span class="sxs-lookup"><span data-stu-id="19704-118">The workbook then uses the XLL when opened in Excel on Windows, and it will use custom functions from your Excel add-in when opened online or on a Mac.</span></span>

<span data-ttu-id="19704-119">次の例は、COM アドインと XLL の両方を同等として指定する方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="19704-119">The following example shows how to specify both a COM add-in and an XLL as equivalent.</span></span> <span data-ttu-id="19704-120">通常は、両方を指定します。</span><span class="sxs-lookup"><span data-stu-id="19704-120">Often you will specify both.</span></span> <span data-ttu-id="19704-121">完全には、この例の両方がコンテキスト内に表示されます。</span><span class="sxs-lookup"><span data-stu-id="19704-121">For completeness, this example shows both in context.</span></span> <span data-ttu-id="19704-122">これらは、それぞれによって識別され `ProgId` `FileName` ます。</span><span class="sxs-lookup"><span data-stu-id="19704-122">They are identified by their `ProgId` and `FileName` respectively.</span></span> <span data-ttu-id="19704-123">要素は、 `EquivalentAddins` 終了タグの直前に配置する必要があり `VersionOverrides` ます。</span><span class="sxs-lookup"><span data-stu-id="19704-123">The `EquivalentAddins` element must be positioned immediately before the closing `VersionOverrides` tag.</span></span> <span data-ttu-id="19704-124">COM アドインの互換性の詳細については、「[既存の com アドインと互換性のある Excel アドインを作成](../develop/make-office-add-in-compatible-with-existing-com-add-in.md)する」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="19704-124">For more information on COM add-in compatibility, see [Make your Excel add-in compatible with an existing COM add-in](../develop/make-office-add-in-compatible-with-existing-com-add-in.md).</span></span>

```xml
<VersionOverrides>
  ...
  <EquivalentAddins>
    <EquivalentAddin>
      <ProgId>ContosoCOMAddin</ProgId>
      <Type>COM</Type>
    </EquivalentAddin>

    <EquivalentAddin>
      <FileName>contosofunctions.xll</FileName>
      <Type>XLL</Type>
    </EquivalentAddin>
  <EquivalentAddins>
</VersionOverrides>
```

> [!NOTE]
> <span data-ttu-id="19704-125">アドインでカスタム関数が XLL 互換に宣言されている場合、後でマニフェストを変更すると、ファイル形式が変更されるため、ユーザーのブックが破損する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="19704-125">If an add-in declares its custom functions to be XLL compatible, changing the manifest at a later time could break a user's workbook because it will change the file format.</span></span>

## <a name="custom-function-behavior-for-xll-compatible-functions"></a><span data-ttu-id="19704-126">XLL 互換関数のカスタム関数の動作</span><span class="sxs-lookup"><span data-stu-id="19704-126">Custom function behavior for XLL compatible functions</span></span>

<span data-ttu-id="19704-127">アドインの XLL 関数は、スプレッドシートが開かれ、対応するアドインが使用可能な場合に、XLL 互換のカスタム関数に変換されます。</span><span class="sxs-lookup"><span data-stu-id="19704-127">An add-in's XLL functions are converted to XLL compatible custom functions when a spreadsheet is opened and there is an equivalent add-in available.</span></span> <span data-ttu-id="19704-128">次の保存時に、XLL 関数は互換性のあるモードでファイルに書き込まれます。これにより、他のプラットフォームで使用する場合に、XLL 関数と Excel アドインカスタム関数の両方を使用できるようになります。</span><span class="sxs-lookup"><span data-stu-id="19704-128">On the next save, the XLL functions are written to the file in a compatible mode so that they work with both the XLL and Excel add-in custom functions (when on other platforms).</span></span>

<span data-ttu-id="19704-129">次の表は、XLL ユーザー定義関数、XLL 互換カスタム関数、および Excel アドインカスタム関数の機能を比較しています。</span><span class="sxs-lookup"><span data-stu-id="19704-129">The following table compares features across XLL user-defined functions, XLL compatible custom functions, and Excel add-in custom functions.</span></span>

|         |<span data-ttu-id="19704-130">XLL のユーザー定義関数</span><span class="sxs-lookup"><span data-stu-id="19704-130">XLL user-defined function</span></span> |<span data-ttu-id="19704-131">XLL 互換のカスタム関数</span><span class="sxs-lookup"><span data-stu-id="19704-131">XLL compatible custom functions</span></span> |<span data-ttu-id="19704-132">Excel アドインのカスタム関数</span><span class="sxs-lookup"><span data-stu-id="19704-132">Excel add-in custom function</span></span> |
|---------|---------|---------|---------|
| <span data-ttu-id="19704-133">サポートされるプラットフォーム</span><span class="sxs-lookup"><span data-stu-id="19704-133">Supported platforms</span></span> | <span data-ttu-id="19704-134">Windows</span><span class="sxs-lookup"><span data-stu-id="19704-134">Windows</span></span> | <span data-ttu-id="19704-135">Windows、macOS、web ブラウザー</span><span class="sxs-lookup"><span data-stu-id="19704-135">Windows, macOS, web browser</span></span> | <span data-ttu-id="19704-136">Windows、macOS、web ブラウザー</span><span class="sxs-lookup"><span data-stu-id="19704-136">Windows, macOS, web browser</span></span> |
| <span data-ttu-id="19704-137">サポートされるファイル形式</span><span class="sxs-lookup"><span data-stu-id="19704-137">Supported file formats</span></span> | <span data-ttu-id="19704-138">.XLSX、.XLSB、.XLSM、XLS</span><span class="sxs-lookup"><span data-stu-id="19704-138">XLSX, XLSB, XLSM, XLS</span></span> | <span data-ttu-id="19704-139">.XLSX、.XLSB、.XLSM</span><span class="sxs-lookup"><span data-stu-id="19704-139">XLSX, XLSB, XLSM</span></span> | <span data-ttu-id="19704-140">.XLSX、.XLSB、.XLSM</span><span class="sxs-lookup"><span data-stu-id="19704-140">XLSX, XLSB, XLSM</span></span> |
| <span data-ttu-id="19704-141">数式オートコンプリート</span><span class="sxs-lookup"><span data-stu-id="19704-141">Formula autocomplete</span></span> | <span data-ttu-id="19704-142">いいえ</span><span class="sxs-lookup"><span data-stu-id="19704-142">No</span></span> | <span data-ttu-id="19704-143">はい</span><span class="sxs-lookup"><span data-stu-id="19704-143">Yes</span></span> | <span data-ttu-id="19704-144">はい</span><span class="sxs-lookup"><span data-stu-id="19704-144">Yes</span></span> |
| <span data-ttu-id="19704-145">ストリーミング</span><span class="sxs-lookup"><span data-stu-id="19704-145">Streaming</span></span> | <span data-ttu-id="19704-146">XlfRTD および XLL コールバックを使用して可能。</span><span class="sxs-lookup"><span data-stu-id="19704-146">Possible via xlfRTD and XLL callback.</span></span> | <span data-ttu-id="19704-147">いいえ</span><span class="sxs-lookup"><span data-stu-id="19704-147">No</span></span> | <span data-ttu-id="19704-148">はい</span><span class="sxs-lookup"><span data-stu-id="19704-148">Yes</span></span> |
| <span data-ttu-id="19704-149">関数のローカライズ</span><span class="sxs-lookup"><span data-stu-id="19704-149">Localization of functions</span></span> | <span data-ttu-id="19704-150">いいえ</span><span class="sxs-lookup"><span data-stu-id="19704-150">No</span></span> | <span data-ttu-id="19704-151">いいえ。</span><span class="sxs-lookup"><span data-stu-id="19704-151">No.</span></span> <span data-ttu-id="19704-152">名前と ID は、既存の XLL 関数と一致している必要があります。</span><span class="sxs-lookup"><span data-stu-id="19704-152">The Name and ID must match the existing XLL's functions.</span></span> | <span data-ttu-id="19704-153">はい</span><span class="sxs-lookup"><span data-stu-id="19704-153">Yes</span></span> |
| <span data-ttu-id="19704-154">揮発性関数</span><span class="sxs-lookup"><span data-stu-id="19704-154">Volatile functions</span></span> | <span data-ttu-id="19704-155">はい</span><span class="sxs-lookup"><span data-stu-id="19704-155">Yes</span></span> | <span data-ttu-id="19704-156">はい</span><span class="sxs-lookup"><span data-stu-id="19704-156">Yes</span></span> | <span data-ttu-id="19704-157">はい</span><span class="sxs-lookup"><span data-stu-id="19704-157">Yes</span></span> |
| <span data-ttu-id="19704-158">マルチスレッドの再計算のサポート</span><span class="sxs-lookup"><span data-stu-id="19704-158">Multi-threaded recalculation support</span></span> | <span data-ttu-id="19704-159">はい</span><span class="sxs-lookup"><span data-stu-id="19704-159">Yes</span></span> | <span data-ttu-id="19704-160">はい</span><span class="sxs-lookup"><span data-stu-id="19704-160">Yes</span></span> | <span data-ttu-id="19704-161">はい</span><span class="sxs-lookup"><span data-stu-id="19704-161">Yes</span></span> |
| <span data-ttu-id="19704-162">計算動作</span><span class="sxs-lookup"><span data-stu-id="19704-162">Calculation behavior</span></span> | <span data-ttu-id="19704-163">UI がありません。</span><span class="sxs-lookup"><span data-stu-id="19704-163">No UI.</span></span> <span data-ttu-id="19704-164">計算中に Excel が応答しなくなることがあります。</span><span class="sxs-lookup"><span data-stu-id="19704-164">Excel can be unresponsive during calculation.</span></span> | <span data-ttu-id="19704-165">ユーザーには #BUSY が表示されます。</span><span class="sxs-lookup"><span data-stu-id="19704-165">Users will see #BUSY!</span></span> <span data-ttu-id="19704-166">を返します。</span><span class="sxs-lookup"><span data-stu-id="19704-166">until a result is returned.</span></span> | <span data-ttu-id="19704-167">ユーザーには #BUSY が表示されます。</span><span class="sxs-lookup"><span data-stu-id="19704-167">Users will see #BUSY!</span></span> <span data-ttu-id="19704-168">を返します。</span><span class="sxs-lookup"><span data-stu-id="19704-168">until a result is returned.</span></span> |
| <span data-ttu-id="19704-169">要件セット</span><span class="sxs-lookup"><span data-stu-id="19704-169">Requirement sets</span></span> | <span data-ttu-id="19704-170">該当なし</span><span class="sxs-lookup"><span data-stu-id="19704-170">N/A</span></span> | <span data-ttu-id="19704-171">CustomFunctions 1.1 以降</span><span class="sxs-lookup"><span data-stu-id="19704-171">CustomFunctions 1.1 and later</span></span> | <span data-ttu-id="19704-172">CustomFunctions 1.1 以降</span><span class="sxs-lookup"><span data-stu-id="19704-172">CustomFunctions 1.1 and later</span></span> |

## <a name="see-also"></a><span data-ttu-id="19704-173">関連項目</span><span class="sxs-lookup"><span data-stu-id="19704-173">See also</span></span>

- [<span data-ttu-id="19704-174">既存の COM アドインと互換性のある Excel アドインを作成する</span><span class="sxs-lookup"><span data-stu-id="19704-174">Make your Excel add-in compatible with an existing COM add-in</span></span>](../develop/make-office-add-in-compatible-with-existing-com-add-in.md)
- [<span data-ttu-id="19704-175">Excel カスタム関数のチュートリアル</span><span class="sxs-lookup"><span data-stu-id="19704-175">Excel custom functions tutorial</span></span>](../tutorials/excel-tutorial-create-custom-functions.md)
