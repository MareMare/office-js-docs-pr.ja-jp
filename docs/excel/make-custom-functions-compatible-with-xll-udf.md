---
title: XLL ユーザー定義関数を使用してカスタム関数を拡張する
description: カスタム関数と同等Excel機能を持つ XLL ユーザー定義関数との互換性を有効にする
ms.date: 03/09/2021
localization_priority: Normal
ms.openlocfilehash: 33c7ee9309196d627520b37a02d5a1bca44cb767
ms.sourcegitcommit: 883f71d395b19ccfc6874a0d5942a7016eb49e2c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/09/2021
ms.locfileid: "53349393"
---
# <a name="extend-custom-functions-with-xll-user-defined-functions"></a><span data-ttu-id="bca2a-103">XLL ユーザー定義関数を使用してカスタム関数を拡張する</span><span class="sxs-lookup"><span data-stu-id="bca2a-103">Extend custom functions with XLL user-defined functions</span></span>

<span data-ttu-id="bca2a-104">既存の Excel XLL がある場合は、Excel アドインで同等のカスタム関数を構築して、ソリューション機能をオンラインや Mac などの他のプラットフォームに拡張できます。</span><span class="sxs-lookup"><span data-stu-id="bca2a-104">If you have existing Excel XLLs, you can build equivalent custom functions in an Excel add-in to extend your solution features to other platforms such as online or on a Mac.</span></span> <span data-ttu-id="bca2a-105">ただし、Excelアドインには、すべての機能が XLL で使用できるわけではありません。</span><span class="sxs-lookup"><span data-stu-id="bca2a-105">However, Excel add-ins don't have all of the functionality available in XLLs.</span></span> <span data-ttu-id="bca2a-106">ソリューションで使用する機能によっては、XLL は Excel アドインのカスタム関数 (Excel on Windows) よりも優れたエクスペリエンスを提供する場合があります。</span><span class="sxs-lookup"><span data-stu-id="bca2a-106">Depending on the functionality your solution uses, the XLL may provide a better experience than the Excel add-in custom functions in Excel on Windows.</span></span>

> [!NOTE]
> <span data-ttu-id="bca2a-107">COM アドインと XLL UDF の互換性は、サブスクリプションに接続されている場合、次のプラットフォームMicrosoft 365されます。</span><span class="sxs-lookup"><span data-stu-id="bca2a-107">COM add-in and XLL UDF compatibility is supported by the following platforms, when connected to a Microsoft 365 subscription.</span></span>
>
> - <span data-ttu-id="bca2a-108">Excel on the web</span><span class="sxs-lookup"><span data-stu-id="bca2a-108">Excel on the web</span></span>
> - <span data-ttu-id="bca2a-109">Excel (Windows 1904 以降)</span><span class="sxs-lookup"><span data-stu-id="bca2a-109">Excel on Windows (version 1904 or later)</span></span>
> - <span data-ttu-id="bca2a-110">Excel (バージョン 13.329 以降)</span><span class="sxs-lookup"><span data-stu-id="bca2a-110">Excel on Mac (version 13.329 or later)</span></span>
>
> <span data-ttu-id="bca2a-111">COM アドインと XLL UDF の互換性を Excel on the web内で使用するには、Microsoft 365 サブスクリプションまたは Microsoft アカウントを使用して[ログインします](https://account.microsoft.com/account)。</span><span class="sxs-lookup"><span data-stu-id="bca2a-111">To use COM add-in and XLL UDF compatibility within Excel on the web, login by using either your Microsoft 365 subscription or a [Microsoft account](https://account.microsoft.com/account).</span></span> <span data-ttu-id="bca2a-112">Microsoft 365 サブスクリプションをまだ持ってない場合は、Microsoft 365 開発者プログラムに参加することで、90 日間の無料のMicrosoft 365[サブスクリプションを利用できます](https://developer.microsoft.com/office/dev-program)。</span><span class="sxs-lookup"><span data-stu-id="bca2a-112">If you don't already have a Microsoft 365 subscription, you can a free, 90-day renewable Microsoft 365 subscription by joining the [Microsoft 365 developer program](https://developer.microsoft.com/office/dev-program).</span></span>

## <a name="specify-equivalent-xll-in-the-manifest"></a><span data-ttu-id="bca2a-113">マニフェストで同等の XLL を指定する</span><span class="sxs-lookup"><span data-stu-id="bca2a-113">Specify equivalent XLL in the manifest</span></span>

<span data-ttu-id="bca2a-114">既存の XLL との互換性を有効にするには、既存のアドインのマニフェストで同等の XLL をExcelします。</span><span class="sxs-lookup"><span data-stu-id="bca2a-114">To enable compatibility with an existing XLL, identify the equivalent XLL in the manifest of your Excel add-in.</span></span> <span data-ttu-id="bca2a-115">Excelで実行すると、アドインのカスタム関数ではなく XLL のExcelを使用Windows。</span><span class="sxs-lookup"><span data-stu-id="bca2a-115">Excel will then use the XLL's functions instead of your Excel add-in custom functions when running on Windows.</span></span>

<span data-ttu-id="bca2a-116">カスタム関数に同等の XLL を設定するには `FileName` 、XLL の値を指定します。</span><span class="sxs-lookup"><span data-stu-id="bca2a-116">To set the equivalent XLL for your custom functions, specify the `FileName` of the XLL.</span></span> <span data-ttu-id="bca2a-117">ユーザーが XLL の関数を含むブックを開くと、Excel互換性のある関数に変換されます。</span><span class="sxs-lookup"><span data-stu-id="bca2a-117">When the user opens a workbook with functions from the XLL, Excel converts the functions to compatible functions.</span></span> <span data-ttu-id="bca2a-118">次に、ブックは Windows の Excel で開かれたときに XLL を使用し、オンラインまたは Mac で開いた場合は Excel アドインのカスタム関数を使用します。</span><span class="sxs-lookup"><span data-stu-id="bca2a-118">The workbook then uses the XLL when opened in Excel on Windows, and it will use custom functions from your Excel add-in when opened online or on a Mac.</span></span>

<span data-ttu-id="bca2a-119">次の例は、COM アドインと XLL の両方を同等として指定する方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="bca2a-119">The following example shows how to specify both a COM add-in and an XLL as equivalent.</span></span> <span data-ttu-id="bca2a-120">多くの場合、両方を指定します。</span><span class="sxs-lookup"><span data-stu-id="bca2a-120">Often you will specify both.</span></span> <span data-ttu-id="bca2a-121">完全な場合、この例では両方のコンテキストを示します。</span><span class="sxs-lookup"><span data-stu-id="bca2a-121">For completeness, this example shows both in context.</span></span> <span data-ttu-id="bca2a-122">これらは、それぞれ、それぞれのユーザー `ProgId` によって `FileName` 識別されます。</span><span class="sxs-lookup"><span data-stu-id="bca2a-122">They are identified by their `ProgId` and `FileName` respectively.</span></span> <span data-ttu-id="bca2a-123">要素 `EquivalentAddins` は、終了タグの直前に配置する必要 `VersionOverrides` があります。</span><span class="sxs-lookup"><span data-stu-id="bca2a-123">The `EquivalentAddins` element must be positioned immediately before the closing `VersionOverrides` tag.</span></span> <span data-ttu-id="bca2a-124">COM アドインの互換性の詳細については、「Make your Office アドインを既存の COM アドインと互換性のあるものにする」[を参照してください](../develop/make-office-add-in-compatible-with-existing-com-add-in.md)。</span><span class="sxs-lookup"><span data-stu-id="bca2a-124">For more information on COM add-in compatibility, see [Make your Office Add-in compatible with an existing COM add-in](../develop/make-office-add-in-compatible-with-existing-com-add-in.md).</span></span>

```xml
<VersionOverrides>
  ...
  <EquivalentAddins>
    <EquivalentAddin>
      <ProgId>ContosoCOMAddin</ProgId>
      <Type>COM</Type>
    </EquivalentAddin>

    <EquivalentAddin>
      <FileName>contosofunctions.xll</FileName>
      <Type>XLL</Type>
    </EquivalentAddin>
  </EquivalentAddins>
</VersionOverrides>
```

> [!NOTE]
> <span data-ttu-id="bca2a-125">アドインがカスタム関数を XLL 互換として宣言すると、後でマニフェストを変更すると、ファイル形式が変更されるので、ユーザーのブックが壊れる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="bca2a-125">If an add-in declares its custom functions to be XLL compatible, changing the manifest at a later time could break a user's workbook because it will change the file format.</span></span>

## <a name="custom-function-behavior-for-xll-compatible-functions"></a><span data-ttu-id="bca2a-126">XLL 互換関数のカスタム関数の動作</span><span class="sxs-lookup"><span data-stu-id="bca2a-126">Custom function behavior for XLL compatible functions</span></span>

<span data-ttu-id="bca2a-127">スプレッドシートを開き、同等のアドインが使用可能な場合、アドインの XLL 関数は XLL 互換のカスタム関数に変換されます。</span><span class="sxs-lookup"><span data-stu-id="bca2a-127">An add-in's XLL functions are converted to XLL compatible custom functions when a spreadsheet is opened and there is an equivalent add-in available.</span></span> <span data-ttu-id="bca2a-128">次の保存では、XLL 関数は互換性のあるモードでファイルに書き込まれるので、XLL と Excel アドインの両方のカスタム関数 (他のプラットフォームの場合) で動作します。</span><span class="sxs-lookup"><span data-stu-id="bca2a-128">On the next save, the XLL functions are written to the file in a compatible mode so that they work with both the XLL and Excel add-in custom functions (when on other platforms).</span></span>

<span data-ttu-id="bca2a-129">次の表は、XLL ユーザー定義関数、XLL 互換カスタム関数、およびアドイン カスタム関数Excel機能を比較します。</span><span class="sxs-lookup"><span data-stu-id="bca2a-129">The following table compares features across XLL user-defined functions, XLL compatible custom functions, and Excel add-in custom functions.</span></span>

|         |<span data-ttu-id="bca2a-130">XLL ユーザー定義関数</span><span class="sxs-lookup"><span data-stu-id="bca2a-130">XLL user-defined function</span></span> |<span data-ttu-id="bca2a-131">XLL 互換のカスタム関数</span><span class="sxs-lookup"><span data-stu-id="bca2a-131">XLL compatible custom functions</span></span> |<span data-ttu-id="bca2a-132">Excelアドインのカスタム関数</span><span class="sxs-lookup"><span data-stu-id="bca2a-132">Excel add-in custom function</span></span> |
|---------|---------|---------|---------|
| <span data-ttu-id="bca2a-133">**サポートされるプラットフォーム**</span><span class="sxs-lookup"><span data-stu-id="bca2a-133">**Supported platforms**</span></span> | <span data-ttu-id="bca2a-134">Windows</span><span class="sxs-lookup"><span data-stu-id="bca2a-134">Windows</span></span> | <span data-ttu-id="bca2a-135">Windows macOS、Web ブラウザー</span><span class="sxs-lookup"><span data-stu-id="bca2a-135">Windows, macOS, web browser</span></span> | <span data-ttu-id="bca2a-136">Windows macOS、Web ブラウザー</span><span class="sxs-lookup"><span data-stu-id="bca2a-136">Windows, macOS, web browser</span></span> |
| <span data-ttu-id="bca2a-137">**サポートされているファイル形式**</span><span class="sxs-lookup"><span data-stu-id="bca2a-137">**Supported file formats**</span></span> | <span data-ttu-id="bca2a-138">XLSX、XLSB、XLSM、XLS</span><span class="sxs-lookup"><span data-stu-id="bca2a-138">XLSX, XLSB, XLSM, XLS</span></span> | <span data-ttu-id="bca2a-139">XLSX、XLSB、XLSM</span><span class="sxs-lookup"><span data-stu-id="bca2a-139">XLSX, XLSB, XLSM</span></span> | <span data-ttu-id="bca2a-140">XLSX、XLSB、XLSM</span><span class="sxs-lookup"><span data-stu-id="bca2a-140">XLSX, XLSB, XLSM</span></span> |
| <span data-ttu-id="bca2a-141">**数式のオートコンプリート**</span><span class="sxs-lookup"><span data-stu-id="bca2a-141">**Formula autocomplete**</span></span> | <span data-ttu-id="bca2a-142">いいえ</span><span class="sxs-lookup"><span data-stu-id="bca2a-142">No</span></span> | <span data-ttu-id="bca2a-143">はい</span><span class="sxs-lookup"><span data-stu-id="bca2a-143">Yes</span></span> | <span data-ttu-id="bca2a-144">はい</span><span class="sxs-lookup"><span data-stu-id="bca2a-144">Yes</span></span> |
| <span data-ttu-id="bca2a-145">**ストリーミング**</span><span class="sxs-lookup"><span data-stu-id="bca2a-145">**Streaming**</span></span> | <span data-ttu-id="bca2a-146">xlfRTD コールバックと XLL コールバックを使用して可能です。</span><span class="sxs-lookup"><span data-stu-id="bca2a-146">Possible via xlfRTD and XLL callback.</span></span> | <span data-ttu-id="bca2a-147">はい</span><span class="sxs-lookup"><span data-stu-id="bca2a-147">Yes</span></span> | <span data-ttu-id="bca2a-148">はい</span><span class="sxs-lookup"><span data-stu-id="bca2a-148">Yes</span></span> |
| <span data-ttu-id="bca2a-149">**関数のローカライズ**</span><span class="sxs-lookup"><span data-stu-id="bca2a-149">**Localization of functions**</span></span> | <span data-ttu-id="bca2a-150">いいえ</span><span class="sxs-lookup"><span data-stu-id="bca2a-150">No</span></span> | <span data-ttu-id="bca2a-151">いいえ。</span><span class="sxs-lookup"><span data-stu-id="bca2a-151">No.</span></span> <span data-ttu-id="bca2a-152">Name と ID は、既存の XLL の関数と一致している必要があります。</span><span class="sxs-lookup"><span data-stu-id="bca2a-152">The Name and ID must match the existing XLL's functions.</span></span> | <span data-ttu-id="bca2a-153">はい</span><span class="sxs-lookup"><span data-stu-id="bca2a-153">Yes</span></span> |
| <span data-ttu-id="bca2a-154">**揮発性関数**</span><span class="sxs-lookup"><span data-stu-id="bca2a-154">**Volatile functions**</span></span> | <span data-ttu-id="bca2a-155">はい</span><span class="sxs-lookup"><span data-stu-id="bca2a-155">Yes</span></span> | <span data-ttu-id="bca2a-156">はい</span><span class="sxs-lookup"><span data-stu-id="bca2a-156">Yes</span></span> | <span data-ttu-id="bca2a-157">はい</span><span class="sxs-lookup"><span data-stu-id="bca2a-157">Yes</span></span> |
| <span data-ttu-id="bca2a-158">**マルチスレッド再計算のサポート**</span><span class="sxs-lookup"><span data-stu-id="bca2a-158">**Multi-threaded recalculation support**</span></span> | <span data-ttu-id="bca2a-159">はい</span><span class="sxs-lookup"><span data-stu-id="bca2a-159">Yes</span></span> | <span data-ttu-id="bca2a-160">はい</span><span class="sxs-lookup"><span data-stu-id="bca2a-160">Yes</span></span> | <span data-ttu-id="bca2a-161">はい</span><span class="sxs-lookup"><span data-stu-id="bca2a-161">Yes</span></span> |
| <span data-ttu-id="bca2a-162">**計算動作**</span><span class="sxs-lookup"><span data-stu-id="bca2a-162">**Calculation behavior**</span></span> | <span data-ttu-id="bca2a-163">UI なし。</span><span class="sxs-lookup"><span data-stu-id="bca2a-163">No UI.</span></span> <span data-ttu-id="bca2a-164">Excelは、計算中に応答しなくなる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="bca2a-164">Excel can be unresponsive during calculation.</span></span> | <span data-ttu-id="bca2a-165">ユーザーには、次の#BUSY!</span><span class="sxs-lookup"><span data-stu-id="bca2a-165">Users will see #BUSY!</span></span> <span data-ttu-id="bca2a-166">結果が返されるまで。</span><span class="sxs-lookup"><span data-stu-id="bca2a-166">until a result is returned.</span></span> | <span data-ttu-id="bca2a-167">ユーザーには、次の#BUSY!</span><span class="sxs-lookup"><span data-stu-id="bca2a-167">Users will see #BUSY!</span></span> <span data-ttu-id="bca2a-168">結果が返されるまで。</span><span class="sxs-lookup"><span data-stu-id="bca2a-168">until a result is returned.</span></span> |
| <span data-ttu-id="bca2a-169">**要件セット**</span><span class="sxs-lookup"><span data-stu-id="bca2a-169">**Requirement sets**</span></span> | <span data-ttu-id="bca2a-170">該当なし</span><span class="sxs-lookup"><span data-stu-id="bca2a-170">N/A</span></span> | <span data-ttu-id="bca2a-171">CustomFunctions 1.1 以降</span><span class="sxs-lookup"><span data-stu-id="bca2a-171">CustomFunctions 1.1 and later</span></span> | <span data-ttu-id="bca2a-172">CustomFunctions 1.1 以降</span><span class="sxs-lookup"><span data-stu-id="bca2a-172">CustomFunctions 1.1 and later</span></span> |

## <a name="see-also"></a><span data-ttu-id="bca2a-173">関連項目</span><span class="sxs-lookup"><span data-stu-id="bca2a-173">See also</span></span>

- [<span data-ttu-id="bca2a-174">Office アドインを既存の COM アドインと互換できるようにする</span><span class="sxs-lookup"><span data-stu-id="bca2a-174">Make your Office Add-in compatible with an existing COM add-in</span></span>](../develop/make-office-add-in-compatible-with-existing-com-add-in.md)
- [<span data-ttu-id="bca2a-175">Excel カスタム関数のチュートリアル</span><span class="sxs-lookup"><span data-stu-id="bca2a-175">Excel custom functions tutorial</span></span>](../tutorials/excel-tutorial-create-custom-functions.md)
