---
title: Office アドインのプライバシーとセキュリティ
description: Office アドインプラットフォームのプライバシーとセキュリティの側面について説明します。
ms.date: 09/26/2019
localization_priority: Normal
ms.openlocfilehash: 6707e94b53eaf714699ab666200e2c2e089b128a
ms.sourcegitcommit: 9609bd5b4982cdaa2ea7637709a78a45835ffb19
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/28/2020
ms.locfileid: "47293017"
---
# <a name="privacy-and-security-for-office-add-ins"></a><span data-ttu-id="4d2f8-103">Office アドインのプライバシーとセキュリティ</span><span class="sxs-lookup"><span data-stu-id="4d2f8-103">Privacy and security for Office Add-ins</span></span>

## <a name="understanding-the-add-in-runtime"></a><span data-ttu-id="4d2f8-104">アドインのランタイムについて</span><span class="sxs-lookup"><span data-stu-id="4d2f8-104">Understanding the add-in runtime</span></span>

<span data-ttu-id="4d2f8-p101">Office アドインは、アドインのランタイム環境、複数層のアクセス許可モデル、およびパフォーマンス ガバナーによって保護されます。このフレームワークは、以下の方法でユーザーのエクスペリエンスを保護します。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-p101">Office Add-ins are secured by an add-in runtime environment, a multiple-tier permissions model, and performance governors. This framework protects the user's experience in the following ways:</span></span> 

- <span data-ttu-id="4d2f8-107">Office クライアントアプリケーションの UI フレームへのアクセスが管理されます。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-107">Access to the Office client application's UI frame is managed.</span></span>

- <span data-ttu-id="4d2f8-108">Office クライアントアプリケーションの UI スレッドへの間接的なアクセスのみが許可されます。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-108">Only indirect access to the Office client application's UI thread is allowed.</span></span>

- <span data-ttu-id="4d2f8-109">モーダルな操作は許可されていません。たとえば、JavaScript `alert` 、、および関数の呼び出しは、 `confirm` モーダルで `prompt` あるため許可されていません。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-109">Modal interactions aren't allowed - for example, calls to JavaScript `alert`, `confirm`, and `prompt` functions aren't allowed because they're modal.</span></span>

<span data-ttu-id="4d2f8-110">さらに、ランタイム フレームワークには、Office アドインによるユーザーの環境の破壊を防止するうえで以下の利点があります。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-110">Further, the runtime framework provides the following benefits to ensure that an Office Add-in can't damage the user's environment:</span></span>

- <span data-ttu-id="4d2f8-111">アドインが実行されるプロセスを分離します。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-111">Isolates the process the add-in runs in.</span></span>

- <span data-ttu-id="4d2f8-112">.dll や .exe の置き換えも、ActiveX コンポーネントも必要ありません。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-112">Doesn't require .dll or .exe replacement or ActiveX components.</span></span>

- <span data-ttu-id="4d2f8-113">アドインのインストールとアンインストールが容易になります。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-113">Makes add-ins easy to install and uninstall.</span></span>

<span data-ttu-id="4d2f8-114">また、Office アドインによるメモリ、CPU、およびネットワーク リソースの使用が管理可能になり、良好なパフォーマンスと信頼性が確保されます。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-114">Also, the use of memory, CPU, and network resources by Office Add-ins is governable to ensure that good performance and reliability are maintained.</span></span>

<span data-ttu-id="4d2f8-115">以降のセクションでは、Windows ベース デバイスの Office クライアント、OS X Mac デバイス、および Web ブラウザーでのアドインの実行がランタイム アーキテクチャによってどのようにサポートされるかについて簡潔に説明します。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-115">The following sections briefly describe how the runtime architecture supports running add-ins in Office clients on Windows-based devices, on OS X Mac devices, and in web browsers.</span></span>

### <a name="clients-on-windows-and-os-x-devices"></a><span data-ttu-id="4d2f8-116">Windows および OS X のデバイス用のクライアント</span><span class="sxs-lookup"><span data-stu-id="4d2f8-116">Clients on Windows and OS X devices</span></span>

<span data-ttu-id="4d2f8-p102">Windows 版の Excel、Windows 版および Mac 版の Outlook など、デスクトップおよびタブレット デバイス用のサポート対象クライアントでは、インプロセス コンポーネントである Office アドイン ランタイムを統合することで、Office アドインをサポートしています。このランタイムは、アドインのライフサイクルを管理し、アドインとクライアント アプリケーションの相互運用を可能にします。アドインの Web ページ自体は、プロセスの外部にホストされます。図 1 に示すように、Windows のデスクトップ デバイスやタブレット デバイスでは、[アドインの Web ページは Internet Explorer または Microsoft Edge コントロール内にホストされ](browsers-used-by-office-web-add-ins.md)、この Internet Explorer または Microsoft Edge コントロールのほうはアドインのランタイム プロセス内にホストされます。そのようにして、セキュリティとパフォーマンスの分離が実現されます。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-p102">In supported clients for desktop and tablet devices, such as Excel on Windows, and Outlook on Windows and Mac, Office Add-ins are supported by integrating an in-process component, the Office Add-ins runtime, which manages the add-in lifecycle and enables interoperability between the add-in and the client application. The add-in webpage itself is hosted out-of-process. As shown in figure 1, on a Windows desktop or tablet device, [the add-in webpage is hosted inside an Internet Explorer or Microsoft Edge control](browsers-used-by-office-web-add-ins.md) which, in turn, is hosted inside an add-in runtime process that provides security and performance isolation.</span></span>

<span data-ttu-id="4d2f8-p103">Windows デスクトップの場合は、制限付きサイト ゾーンに対して Internet Explorer の保護モードを有効にする必要があります。これは通常、既定で有効にされています。無効になっている場合、アドインを起動しようとすると[エラーが発生](https://support.microsoft.com/help/2761180/apps-for-office-don-t-start-if-you-disable-protected-mode-for-the-restricted-sites-zone-in-internet-explorer)します。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-p103">On Windows desktops, Protected Mode in Internet Explorer must be enabled for the Restricted Site Zone. This is typically enabled by default. If it is disabled, an [error will occur](https://support.microsoft.com/help/2761180/apps-for-office-don-t-start-if-you-disable-protected-mode-for-the-restricted-sites-zone-in-internet-explorer) when you try to launch an add-in.</span></span>

<span data-ttu-id="4d2f8-123">*図 1.Windows ベースのデスクトップおよびタブレットのクライアントにおける Office アドインのランタイム環境*</span><span class="sxs-lookup"><span data-stu-id="4d2f8-123">*Figure 1. Office Add-ins runtime environment in Windows-based desktop and tablet clients*</span></span>

![リッチ クライアント インフラストラクチャ](../images/dk2-agave-overview-02.png)

<span data-ttu-id="4d2f8-125">OS X Mac デスクトップの場合は、次の図に示すように、アドインの Web ページはセキュリティで保護された WebKit ランタイム ホスト プロセス内にホストされ、それによって同様のレベルのセキュリティとパフォーマンスの保護が提供されます。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-125">As shown in the following figure, on an OS X Mac desktop, the add-in web page is hosted inside a sandboxed WebKit runtime host process which helps provide similar level of security and performance protection.</span></span> 

<span data-ttu-id="4d2f8-126">*図 2.OS X Mac クライアントにおける Office アドインのランタイム環境*</span><span class="sxs-lookup"><span data-stu-id="4d2f8-126">*Figure 2. Office Add-ins runtime environment in OS X Mac clients*</span></span>

![OS X Mac 上の Office ランタイム環境用アプリ](../images/dk2-agave-overview-mac-02.png)

<span data-ttu-id="4d2f8-128">Office アドイン ランタイムは、プロセス間通信、JavaScript API 呼び出しとイベントの固有形式への変換、および UI リモート処理サポートを管理し、アドインがドキュメント内や作業ウィンドウ内、あるいは電子メール メッセージ、会議出席依頼、予定の隣に表示されるようにします。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-128">The Office Add-ins runtime manages interprocess communication, the translation of JavaScript API calls and events into native ones, as well as UI remoting support to enable the add-in to be rendered inside the document, in a task pane, or adjacent to an email message, meeting request, or appointment.</span></span>

### <a name="web-clients"></a><span data-ttu-id="4d2f8-129">Web クライアント</span><span class="sxs-lookup"><span data-stu-id="4d2f8-129">Web clients</span></span>

<span data-ttu-id="4d2f8-130">サポートされている Web クライアントでは、Office アドインは、HTML5**サンドボックス**属性を使用して実行する**iframe**でホストされます。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-130">In supported Web clients, Office Add-ins are hosted in an **iframe** that runs using the HTML5 **sandbox** attribute.</span></span> <span data-ttu-id="4d2f8-131">ActiveX コンポーネントや Web クライアントのメイン ページでのナビゲーションは許可されていません。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-131">ActiveX components or navigating the main page of the web client are not allowed.</span></span> <span data-ttu-id="4d2f8-132">Office アドインのサポートは、JavaScript API for Office の統合によって Web クライアント内で有効になっています。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-132">Office Add-ins support is enabled in the web clients by the integration of the JavaScript API for Office.</span></span> <span data-ttu-id="4d2f8-133">デスクトップ クライアント アプリケーションの場合と同様、JavaScript API はアドインのライフサイクルや、アドインと Web クライアントの間の相互運用性を管理します。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-133">In a similar way to the desktop client applications, the JavaScript API manages the add-in lifecycle and interoperability between the add-in and the web client.</span></span> <span data-ttu-id="4d2f8-134">この相互運用性は、特別なクロスフレーム ポスト メッセージ通信インフラストラクチャを使用して実現されています。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-134">This interoperability is implemented by using a special cross-frame post message communication infrastructure.</span></span> <span data-ttu-id="4d2f8-135">Web クライアントとの対話には、デスクトップ クライアント上で使用されるのと同じ JavaScript ライブラリ (Office.js) を使用できます。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-135">The same JavaScript library (Office.js) that is used on desktop clients is available to interact with the web client.</span></span> <span data-ttu-id="4d2f8-136">次の図は、ブラウザーで実行されている Office のアドインをサポートするインフラストラクチャと、それらをサポートするために必要な関連コンポーネント (web クライアント、 **iframe**、office アドインランタイム、および JavaScript API for office) を示しています。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-136">The following figure shows the infrastructure that supports add-ins in Office running in the browser, and the relevant components (the web client, **iframe**, Office Add-ins runtime, and JavaScript API for Office) that are required to support them.</span></span>


<span data-ttu-id="4d2f8-137">*図 3.Office Web クライアント内で Office アドインをサポートするインフラストラクチャ*</span><span class="sxs-lookup"><span data-stu-id="4d2f8-137">*Figure 3. Infrastructure that supports Office Add-ins in Office web clients*</span></span>

![Web クライアント インフラストラクチャ](../images/dk2-agave-overview-03.png)

## <a name="add-in-integrity-in-appsource"></a><span data-ttu-id="4d2f8-139">AppSource でのアドインの整合性</span><span class="sxs-lookup"><span data-stu-id="4d2f8-139">Add-in integrity in AppSource</span></span>

<span data-ttu-id="4d2f8-p105">Office アドインは、AppSource で公開することで利用可能にできます。AppSource では、アドインの整合性を維持するために以下の規則が適用されます。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-p105">You can make your Office Add-ins available to the public by publishing them to AppSource. AppSource enforces the following measures to maintain the integrity of add-ins:</span></span>


- <span data-ttu-id="4d2f8-142">Office アドインのホスト サーバーでは、通信に必ず Secure Socket Layer (SSL) を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-142">Requires the host server of an Office Add-in to always use Secure Sockets Layer (SSL) to communicate.</span></span>

- <span data-ttu-id="4d2f8-143">開発者はアドインを提出する際に、ID の証明、契約上の合意、および法規制に準拠したプライバシー ポリシーを提供する必要があります。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-143">Requires a developer to provide proof of identity, a contractual agreement, and a compliant privacy policy to submit add-ins.</span></span>

- <span data-ttu-id="4d2f8-144">アドインのソースに読み取り専用モードでアクセスできるようにします。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-144">Ensures that the source of add-ins is accessible in read-only mode.</span></span>

- <span data-ttu-id="4d2f8-145">使用可能なアドインに対するユーザーレビュー システムをサポートしてコミュニティの自己管理を促します。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-145">Supports a user-review system for available add-ins to promote a self-policing community.</span></span>

## <a name="addressing-end-users-privacy-concerns"></a><span data-ttu-id="4d2f8-146">エンド ユーザーのプライバシー問題への対応</span><span class="sxs-lookup"><span data-stu-id="4d2f8-146">Addressing end users' privacy concerns</span></span>

<span data-ttu-id="4d2f8-147">ここでは、Office アドイン プラットフォームから提供される保護を顧客 (エンド ユーザー) の視点から説明し、ユーザーの期待に応える方法とユーザーの個人情報 (PII) を安全に取り扱う方法に関するガイドラインを提供します。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-147">This section describes the protection offered by the Office Add-ins platform from the customer's (end user's) perspective, and provides guidelines for how to support users' expectations and how to securely handle users' personally identifiable information (PII).</span></span>

### <a name="end-users-perspective"></a><span data-ttu-id="4d2f8-148">エンド ユーザーの認知</span><span class="sxs-lookup"><span data-stu-id="4d2f8-148">End users' perspective</span></span>

<span data-ttu-id="4d2f8-p106">Office アドインは、ブラウザー コントロールまたは **iframe** 内で実行する Web テクノロジを使用して構築されています。そのため、アドインの使用は、インターネットまたはイントラネット上で Web サイトを閲覧することと似ています。アドインは、組織の外部に存在することも (AppSource からアドインを入手する場合)、内部に存在することも (Exchange Server アドイン カタログ、SharePoint アプリ カタログ、または組織のネットワーク上のファイル共有からアドインを入手する場合) あります。アドインはネットワークへのアクセスが制限されますが、ほとんどのアドインは作業中のドキュメントやメール アイテムの読み書きができます。ユーザーや管理者がアドインをインストールまたは起動する前に、アドイン プラットフォームによって特定の制約が課されます。ただし、拡張性モデルと同様に、未知のアドインの起動は慎重に行う必要があります。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-p106">Office Add-ins are built using web technologies that run in a browser control or **iframe**. Because of this, using add-ins is similar to browsing to web sites on the Internet or intranet. Add-ins can be external to an organization (if you acquire the add-in from AppSource) or internal (if you acquire the add-in from an Exchange Server add-in catalog, SharePoint app catalog, or file share on an organization's network). Add-ins have limited access to the network and most add-ins can read or write to the active document or mail item. The add-in platform applies certain constraints before a user or administrator installs or starts an add-in. But as with any extensibility model, users should be cautious before starting an unknown add-in.</span></span>

<span data-ttu-id="4d2f8-155">アドイン プラットフォームは、エンド ユーザーのプライバシーの懸念に次のように対処します。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-155">The add-in platform addresses end users' privacy concerns in the following ways:</span></span>

- <span data-ttu-id="4d2f8-156">コンテンツ アドイン、Outlook アドイン、または作業ウィンドウ アドインをホストする Web サーバーとやり取りされるデータ、およびアドインとそれが使用する Web サービス間の通信は、Secure Socket Layer (SSL) プロトコルを使用して暗号化する必要があります。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-156">Data communicated with the web server that hosts a content, Outlook or task pane add-in as well as communication between the add-in and any web services it uses must be encrypted using the Secure Socket Layer (SSL) protocol.</span></span>

- <span data-ttu-id="4d2f8-p107">ユーザーは、AppSource からアドインをインストールする前に、そのアドインのプライバシー ポリシーと要件を表示できます。さらに、ユーザーのメールボックスとやり取りする Outlook アドインでは、アドインに必要なアクセス許可が具体的に表示されます。ユーザーは Outlook アドインをインストールする前に、使用条件、要求されるアクセス許可、およびプライバシー ポリシーを確認できます。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-p107">Before a user installs an add-in from AppSource, the user can view the privacy policy and requirements of that add-in. In addition, Outlook add-ins that interact with users' mailboxes surface the specific permissions that they require; the user can review the terms of use, requested permissions and privacy policy before installing an Outlook add-in.</span></span>

- <span data-ttu-id="4d2f8-159">ドキュメントを共有する場合、ユーザーはそのドキュメントに挿入されているアドインまたはそのドキュメントに関連付けられているアドインも共有することになります。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-159">When sharing a document, users also share add-ins that have been inserted in or associated with that document.</span></span> <span data-ttu-id="4d2f8-160">ユーザーが以前に使用したことがないアドインを含むドキュメントを開くと、Office クライアントアプリケーションは、ドキュメントでアドインを実行するためのアクセス許可をユーザーに付与するよう求めます。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-160">If a user opens a document that contains an add-in that the user hasn't used before, the Office client application prompts the user to grant permission for the add-in to run in the document.</span></span> <span data-ttu-id="4d2f8-161">組織環境では、Office クライアントアプリケーションは、ドキュメントが外部ソースからのものである場合にも、ユーザーに確認を求めます。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-161">In an organizational environment, the Office client application also prompts the user if the document comes from an external source.</span></span>

- <span data-ttu-id="4d2f8-162">ユーザーは、AppSource へのアクセスを有効または無効にすることができます。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-162">Users can enable or disable the access to AppSource.</span></span> <span data-ttu-id="4d2f8-163">コンテンツアドインと作業ウィンドウアドインの場合、ユーザーは、ホスト Office クライアントの**セキュリティセンター**から信頼されたアドインとカタログへのアクセスを管理します ([**ファイル**  >  **オプション]**[信頼センターのセキュリティセンターの設定] [信頼  >  **Trust Center**  >  **Trust Center Settings**  >  **できるアドインカタログ**] から開きます)。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-163">For content and task pane add-ins, users manage access to trusted add-ins and catalogs from the **Trust Center** on the host Office client (opened from **File** > **Options** > **Trust Center** > **Trust Center Settings** > **Trusted Add-in Catalogs**).</span></span> <span data-ttu-id="4d2f8-164">Outlook アドインでは、を使用してアドインを管理するには、[アドインの**管理**] ボタンを選択します。 Windows の outlook の場合は、[**ファイル**の管理] [アドイン] を選択し  >  **Manage Add-ins**ます。Outlook on the Mac で、アドインバーの [アドインの**管理**] ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-164">For Outlook add-ins, uses can manage add-ins by choosing the **Manage Add-ins** button: in Outlook on Windows, choose **File** > **Manage Add-ins**. In Outlook on Mac, choose the **Manage Add-ins** button on the add-in bar.</span></span> <span data-ttu-id="4d2f8-165">Outlook on the web では、**[設定]** メニュー (歯車アイコン) > **[アドインを管理する]** を選択します。管理者は[グループ ポリシーを使用することによって](/previous-versions/office/office-2013-resource-kit/jj219429(v=office.15)#using-group-policy-to-manage-how-users-can-install-and-use-apps-for-office)、このようなアクセスも管理することができます。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-165">In Outlook on the web, choose the **Settings** menu (gear icon) > **Manage add-ins**. Administrators can also manage this access [by using group policy](/previous-versions/office/office-2013-resource-kit/jj219429(v=office.15)#using-group-policy-to-manage-how-users-can-install-and-use-apps-for-office).</span></span>

- <span data-ttu-id="4d2f8-166">アドイン プラットフォームの設計を通して、次のような方法でセキュリティとパフォーマンスがエンド ユーザーに提供されます。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-166">The design of the add-in platform provides security and performance for end users in the following ways:</span></span>

  - <span data-ttu-id="4d2f8-167">Office アドインは、Office クライアントアプリケーションとは別のアドインランタイム環境でホストされる web ブラウザーコントロールで実行されます。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-167">An Office Add-in runs in a web browser control that is hosted in an add-in runtime environment separate from the Office client application.</span></span> <span data-ttu-id="4d2f8-168">この設計により、クライアントアプリケーションからのセキュリティとパフォーマンスの分離が実現します。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-168">This design provides both security and performance isolation from the client application.</span></span>

  - <span data-ttu-id="4d2f8-169">アドインは Web ブラウザー コントロール下で動作するため、ブラウザーで動作する通常の Web ページとほぼ同じ処理を実行できますが、同時に、ドメイン分離のための同一生成元ポリシーとセキュリティ ゾーンを遵守するように制限されます。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-169">Running in a web browser control allows the add-in to do almost anything a regular web page running in a browser can do but, at the same time, restricts the add-in to observe the same-origin policy for domain isolation and security zones.</span></span>

<span data-ttu-id="4d2f8-p111">Outlook アドイン固有のリソース使用量監視機能により、Outlook アドインはセキュリティとパフォーマンスの追加の機能を提供します。詳細については、「[Outlook アドインに関するプライバシー、アクセス許可、セキュリティ](../outlook/privacy-and-security.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-p111">Outlook add-ins provide additional security and performance features through Outlook add-in specific resource usage monitoring. For more information, see [Privacy, permissions, and security for Outlook add-ins](../outlook/privacy-and-security.md).</span></span>

### <a name="developer-guidelines-to-handle-pii"></a><span data-ttu-id="4d2f8-172">PII の取り扱いに関する開発ガイドライン</span><span class="sxs-lookup"><span data-stu-id="4d2f8-172">Developer guidelines to handle PII</span></span>

<span data-ttu-id="4d2f8-173">次に、Office アドインの開発者向けの PII の保護に関するガイドラインをいくつか具体的に示します。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-173">The following lists some specific PII protection guidelines for you as a developer of Office Add-ins:</span></span>

- <span data-ttu-id="4d2f8-p112">[Settings](/javascript/api/office/office.settings) オブジェクトは、コンテンツ アドインまたは作業ウィンドウ アドインに関する設定やセッション間の状態データの永続化に使用できますが、パスワードやその他の機密性の高い PII を **Settings** オブジェクトに保存してはいけません。**Settings** オブジェクト内のデータはエンド ユーザーには表示されませんが、容易にアクセスできるドキュメントのファイル形式の一部として保存されます。アドインの PII の使用を制限し、アドインに必要な PII はユーザー保護リソースとしてアドインをホストするサーバーに保存する必要があります。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-p112">The [Settings](/javascript/api/office/office.settings) object is intended for persisting add-in settings and state data across sessions for a content or task pane add-in, but don't store passwords and other sensitive PII in the **Settings** object. The data in the **Settings** object isn't visible to end users, but it is stored as part of the document's file format which is readily accessible. You should limit your add-in's use of PII and store any PII required by your add-in on the server hosting your add-in as a user-secured resource.</span></span>

- <span data-ttu-id="4d2f8-p113">一部のアプリケーションを使用すると PII が公開されてしまう可能性があります。ユーザーの ID、所在、アクセス時間、およびその他の資格情報に関するデータが安全に保存されていて、アドインの他のユーザーが使用できないことを確認してください。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-p113">Using some applications can reveal PII. Make sure that you securely store data for your users' identity, location, access times, and any other credentials so that data won't become available to other users of the add-in.</span></span>

- <span data-ttu-id="4d2f8-p114">アドインが AppSource で入手可能な場合は、AppSource の HTTPS 要件によって Web サーバーとクライアント コンピューターまたはデバイスとの間で転送される PII が保護されます。ただし、データを他のサーバーに再転送する場合は、これと同レベルの保護が適用されることを確認してください。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-p114">If your add-in is available in AppSource, the AppSource requirement for HTTPS protects PII transmitted between your web server and the client computer or device. However, if you re-transmit that data to other servers, make sure you observe the same level of protection.</span></span>

- <span data-ttu-id="4d2f8-p115">ユーザーの PII を保存する場合は、その事実を公開し、ユーザーがそれを検査して削除できる方法を提供します。アドインを AppSource に送信する場合は、収集するデータとその用途をプライバシーに関する声明の中で説明できます。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-p115">If you store users' PII, make sure you reveal that fact, and provide a way for users to inspect and delete it. If you submit your add-in to AppSource, you can outline the data you collect and how it's used in the privacy statement.</span></span>

## <a name="developers-permission-choices-and-security-practices"></a><span data-ttu-id="4d2f8-183">開発者によるアクセス許可の選択とセキュリティ手法</span><span class="sxs-lookup"><span data-stu-id="4d2f8-183">Developers' permission choices and security practices</span></span>

<span data-ttu-id="4d2f8-184">Office アドインのセキュリティ モデルをサポートするための以下の一般的なガイドラインを踏まえたうえで、アドインの種類ごとの詳細について調べます。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-184">Follow these general guidelines to support the security model of Office Add-ins, and drill down on more details for each add-in type.</span></span>

### <a name="permissions-choices"></a><span data-ttu-id="4d2f8-185">アクセス許可の選択</span><span class="sxs-lookup"><span data-stu-id="4d2f8-185">Permissions choices</span></span>

<span data-ttu-id="4d2f8-186">アドイン プラットフォームは、その機能で必要なユーザー データへのアクセス レベルを宣言する、アドインが使用するアクセス許可のモデルを提供します。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-186">The add-in platform provides a permissions model that your add-in uses to declare the level of access to a user's data that it requires for its features.</span></span> <span data-ttu-id="4d2f8-187">それぞれのアクセス許可レベルは、アドインがその機能で使用することが許可されている JavaScript API for Office のサブセットに対応しています。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-187">Each permission level corresponds to the subset of the JavaScript API for Office your add-in is allowed to use for its features.</span></span> <span data-ttu-id="4d2f8-188">たとえば、コンテンツアドインと作業ウィンドウアドインの**Writedocument**アクセス許可を使用すると、アドインがユーザーのドキュメントに書き込むことができますが、ドキュメントからデータを読み取るためのメソッドへのアクセスを許可しないようにすることができ[ます。](/javascript/api/office/office.document)</span><span class="sxs-lookup"><span data-stu-id="4d2f8-188">For example, the **WriteDocument** permission for content and task pane add-ins allows access to the [Document.setSelectedDataAsync](/javascript/api/office/office.document) method that lets an add-in write to the user's document, but doesn't allow access to any of the methods for reading data from the document.</span></span> <span data-ttu-id="4d2f8-189">このアクセス許可レベルは、ユーザーのドキュメントにデータを挿入するためにユーザーが照会できるアドインなど、ドキュメントに書き込みのみを行う必要があるアドインに適しています。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-189">This permission level makes sense for add-ins that only need to write to a document, such as an add-in where the user can query for data to insert into their document.</span></span>

<span data-ttu-id="4d2f8-p117">ベスト プラクティスとしては、_最小限の特権_の原則に基づいてアクセス許可を要求するべきです。つまり、アドインが正しく機能するために必要な最小限の API サブセットにのみアクセスする許可を要求します。たとえば、ユーザーのドキュメントのデータさえ読み込めばアドインが正しく機能する場合、**ReadDocument** 以外のアクセス許可を要求しません。(ただし、要求したアクセス許可が不十分な場合は、アドイン プラットフォームによってアドインによる一部の API の使用がブロックされ、ランタイム エラーが発生する可能性があることに注意してください)。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-p117">As a best practice, you should request permissions based on the principle of  _least privilege_. That is, you should request permission to access only the minimum subset of the API that your add-in requires to function correctly. For example, if your add-in needs only to read data in a user's document for its features, you should request no more than the **ReadDocument** permission. (But, keep in mind that requesting insufficient permissions will result in the add-in platform blocking your add-in's use of some APIs and will generate errors at run time.)</span></span>

<span data-ttu-id="4d2f8-194">次の例に示すように、アドインのマニフェストでアクセス許可を指定すれば、エンド ユーザーは、アドインを初めてインストールまたはアクティブにする前に、アドインの要求されたアクセス許可レベルを確認できます。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-194">You specify permissions in the manifest of your add-in, as shown in the example in this section below, and end users can see the requested permission level of an add-in before they decide to install or activate the add-in for the first time.</span></span> <span data-ttu-id="4d2f8-195">さらに、 **ReadWriteMailbox** アクセス許可を要求する Outlook アドインでは、明示的な管理者特権が必要です。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-195">Additionally, Outlook add-ins that request the **ReadWriteMailbox** permission require explicit administrator privilege to install.</span></span>

<span data-ttu-id="4d2f8-196">次の例は、作業ウィンドウアドインがマニフェストで **Readdocument** アクセス許可を指定する方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-196">The following example shows how a task pane add-in specifies the **ReadDocument** permission in its manifest.</span></span> <span data-ttu-id="4d2f8-197">アクセス許可に注目できるようにマニフェスト内の他の要素は省略しています。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-197">To keep permissions as the focus, other elements in the manifest aren't displayed.</span></span>

```xml
<?xml version="1.0" encoding="utf-8"?>
<OfficeApp xmlns="http://schemas.microsoft.com/office/appforoffice/1.0"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
           xmlns:ver="http://schemas.microsoft.com/office/appforoffice/1.0"
           xsi:type="TaskPaneApp">

... <!-- To keep permissions as the focus, not displaying other elements. -->
  <Permissions>ReadDocument</Permissions>
...
</OfficeApp>
```

<span data-ttu-id="4d2f8-198">作業ウィンドウ アドインとコンテンツ アドインのアクセス許可の詳細については、「[アドインでの API 使用についてアクセス許可を要求する](../develop/requesting-permissions-for-api-use-in-content-and-task-pane-add-ins.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-198">For more information about permissions for task pane and content add-ins, see [Requesting permissions for API use in add-ins](../develop/requesting-permissions-for-api-use-in-content-and-task-pane-add-ins.md).</span></span>

<span data-ttu-id="4d2f8-199">Outlook アドインのアクセス許可の詳細については、次のトピックを参照してください。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-199">For more information about permissions for Outlook add-ins, see the following topics:</span></span>

- [<span data-ttu-id="4d2f8-200">Outlook アドインに関するプライバシー、アクセス許可、セキュリティ</span><span class="sxs-lookup"><span data-stu-id="4d2f8-200">Privacy, permissions, and security for Outlook add-ins</span></span>](../outlook/privacy-and-security.md)

- [<span data-ttu-id="4d2f8-201">Outlook アドインのアクセス許可を理解する</span><span class="sxs-lookup"><span data-stu-id="4d2f8-201">Understanding Outlook add-in permissions</span></span>](../outlook/understanding-outlook-add-in-permissions.md)

### <a name="same-origin-policy"></a><span data-ttu-id="4d2f8-202">同一生成元ポリシー</span><span class="sxs-lookup"><span data-stu-id="4d2f8-202">Same origin policy</span></span>

<span data-ttu-id="4d2f8-203">Office アドインは Web ブラウザー コントロール内で動作する Web ページのため、ブラウザーによって強制された同一生成元ポリシーに従う必要があります。既定で、あるドメイン内の Web ページから、それがホストされているドメイン以外のドメインに対して、[XmlHttpRequest](https://www.w3.org/TR/XMLHttpRequest/) Web サービス呼び出しを実行することはできません。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-203">Because Office Add-ins are webpages that run in a web browser control, they must follow the same-origin policy enforced by the browser: by default, a webpage in one domain can't make [XmlHttpRequest](https://www.w3.org/TR/XMLHttpRequest/) web service calls to another domain other than the one where it is hosted.</span></span>

<span data-ttu-id="4d2f8-204">この制限を回避する1つの方法は、別のドメインでホストされているスクリプトを指す**src**属性を持つ**スクリプト**タグを指定することによって、web サービスのプロキシを提供することです。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-204">One way to overcome this limitation is to use JSON/P -- provide a proxy for the web service by including a **script** tag with a **src** attribute that points to some script hosted on another domain.</span></span> <span data-ttu-id="4d2f8-205">プログラムを使用して **スクリプト** タグを作成し、 **src** 属性をポイントする url を動的に作成し、URI クエリパラメーターを使用して url にパラメーターを渡すことができます。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-205">You can programmatically create the **script** tags, dynamically creating the URL to which to point the **src** attribute, and passing parameters to the URL via URI query parameters.</span></span> <span data-ttu-id="4d2f8-206">Web サービス プロバイダーは、固有の URL で JavaScript コードを作成およびホストし、URI クエリ パラメーターに応じて異なるスクリプトを返します。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-206">Web service providers create and host JavaScript code at specific URLs, and return different scripts depending on the URI query parameters.</span></span> <span data-ttu-id="4d2f8-207">それらのスクリプトは挿入された場所で実行され、想定どおりに動作します。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-207">These scripts then execute where they are inserted and work as expected.</span></span>

<span data-ttu-id="4d2f8-208">Outlook アドインでの JSON/P の例を次に示します。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-208">The following is an example of JSON/P in the Outlook add-in example.</span></span> 

```js
// Dynamically create an HTML SCRIPT element that obtains the details for the specified video.
function loadVideoDetails(videoIndex) {
    // Dynamically create a new HTML SCRIPT element in the webpage.
    var script = document.createElement("script");
    // Specify the URL to retrieve the indicated video from a feed of a current list of videos,
    // as the value of the src attribute of the SCRIPT element. 
    script.setAttribute("src", "https://gdata.youtube.com/feeds/api/videos/" + 
        videos[videoIndex].Id + "?alt=json-in-script&amp;callback=videoDetailsLoaded");
    // Insert the SCRIPT element at the end of the HEAD section.
    document.getElementsByTagName('head')[0].appendChild(script);
}
```

<span data-ttu-id="4d2f8-p121">Exchange と SharePoint は、クロス ドメイン アクセスを可能にするためにクライアント側のプロキシを提供します。一般に、イントラネット上の同一生成元ポリシーは、インターネット上のポリシーほど厳密ではありません。詳細については、「[同一生成元ポリシー第 1 部: ピーク禁止](/archive/blogs/ieinternals/same-origin-policy-part-1-no-peeking)」および「[Office アドインにおける同一生成元ポリシーの制限事項に対応する](../develop/addressing-same-origin-policy-limitations.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-p121">Exchange and SharePoint provide client-side proxies to enable cross-domain access. In general, same origin policy on an intranet isn't as strict as on the Internet. For more information, see [Same Origin Policy Part 1: No Peeking](/archive/blogs/ieinternals/same-origin-policy-part-1-no-peeking) and [Addressing same-origin policy limitations in Office Add-ins](../develop/addressing-same-origin-policy-limitations.md).</span></span>

### <a name="tips-to-prevent-malicious-cross-site-scripting"></a><span data-ttu-id="4d2f8-212">悪意のあるクロスサイト スクリプティングを回避するヒント</span><span class="sxs-lookup"><span data-stu-id="4d2f8-212">Tips to prevent malicious cross-site scripting</span></span>

<span data-ttu-id="4d2f8-213">悪意のあるユーザーが、ドキュメントやアドインのフィールドを経由して悪意のあるスクリプトを入力し、アドインの入手元を攻撃する場合があります。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-213">An ill-intentioned user could attack the origin of an add-in by entering malicious script through the document or fields in the add-in.</span></span> <span data-ttu-id="4d2f8-214">開発者は、ドメイン内で悪意のあるユーザーの JavaScript が実行されないようにユーザー入力を処理する必要があります。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-214">A developer should process user input to avoid executing a malicious user's JavaScript within their domain.</span></span> <span data-ttu-id="4d2f8-215">ドキュメントやメール メッセージ、またはアドインのフィールドを経由したユーザー入力の処理に推奨される方法を次にいくつか紹介します。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-215">The following are some good practices to follow to handle user input from a document or mail message, or via fields in an add-in:</span></span>


- <span data-ttu-id="4d2f8-p123">可能であれば、DOM プロパティの [innerHTML](https://developer.mozilla.org/docs/Web/API/Element/innerHTML) ではなく、[innerText](https://developer.mozilla.org/docs/Web/API/Node/innerText) および [textContent](https://developer.mozilla.org/docs/DOM/Node.textContent) プロパティを使用します。次のように実行して、Internet Explorer と Firefox のクロス ブラウザー サポートを提供します。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-p123">Instead of the DOM property [innerHTML](https://developer.mozilla.org/docs/Web/API/Element/innerHTML), use the [innerText](https://developer.mozilla.org/docs/Web/API/Node/innerText) and [textContent](https://developer.mozilla.org/docs/DOM/Node.textContent) properties where appropriate. Do the following for Internet Explorer and Firefox cross-browser support:</span></span>

    ```js
     var text = x.innerText || x.textContent
    ```

    <span data-ttu-id="4d2f8-218">**InnerText**と**textcontent**の違いについては、「node.js[コンテンツ](https://developer.mozilla.org/docs/DOM/Node.textContent)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-218">For information about the differences between **innerText** and **textContent**, see [Node.textContent](https://developer.mozilla.org/docs/DOM/Node.textContent).</span></span> <span data-ttu-id="4d2f8-219">一般的なブラウザー間での DOM の互換性の詳細については、「[W3C DOM 互換性](https://www.quirksmode.org/dom/w3c_html.html#t07)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-219">For more information about DOM compatibility across common browsers, see [W3C DOM Compatibility - HTML](https://www.quirksmode.org/dom/w3c_html.html#t07).</span></span>

- <span data-ttu-id="4d2f8-220">**InnerHTML**を使用する必要がある場合は、 **innerHTML**に渡す前に、ユーザーの入力に悪意のあるコンテンツが含まれていないことを確認してください。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-220">If you must use **innerHTML**, make sure the user's input doesn't contain malicious content before passing it to **innerHTML**.</span></span> <span data-ttu-id="4d2f8-221">**innerHTML** を安全に使用する方法とその例については、[innerHTML](https://developer.mozilla.org/docs/Web/API/Element/innerHTML) プロパティを参照してください。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-221">For more information and an example of how to use **innerHTML** safely, see [innerHTML](https://developer.mozilla.org/docs/Web/API/Element/innerHTML) property.</span></span>

- <span data-ttu-id="4d2f8-222">jQuery を使用している場合は、[.html()](https://api.jquery.com/text/) メソッドの代わりに [.text()](https://api.jquery.com/html/) メソッドを使用してください。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-222">If you are using jQuery, use the [.text()](https://api.jquery.com/text/) method instead of the [.html()](https://api.jquery.com/html/) method.</span></span>

- <span data-ttu-id="4d2f8-223">
  [toStaticHTML](https://developer.mozilla.org/en-US/docs/Web/HTML/Reference) メソッドを使用して、ユーザーの入力から動的な HTML 要素と属性を削除したうえで、\*\*innerHTML\*\* に入力を渡してください。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-223">Use the [toStaticHTML](https://developer.mozilla.org/en-US/docs/Web/HTML/Reference) method to remove any dynamic HTML elements and attributes in users' input before passing it to **innerHTML**.</span></span>

- <span data-ttu-id="4d2f8-224">
  [encodeURIComponent](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/encodeuricomponent) または [encodeURI](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/encodeuri) 関数を使用して、参照元 URL またはユーザーの入力を含む URL として使用できるようにテキストをエンコードしてください。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-224">Use the [encodeURIComponent](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/encodeuricomponent) or [encodeURI](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/encodeuri) function to encode text that is intended to be a URL that comes from or contains user input.</span></span>

- <span data-ttu-id="4d2f8-225">より安全に使用できる Web ソリューションを作成するためのその他のベスト プラクティスについては、「[セキュリティで保護されたアドインを開発する](/previous-versions/windows/apps/hh849625(v=win.10))」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-225">See [Developing secure add-ins](/previous-versions/windows/apps/hh849625(v=win.10)) for more best practices to create more secure web solutions.</span></span>

### <a name="tips-to-prevent-clickjacking"></a><span data-ttu-id="4d2f8-226">「クリックジャック」を防止するためのヒント</span><span class="sxs-lookup"><span data-stu-id="4d2f8-226">Tips to prevent "Clickjacking"</span></span>

<span data-ttu-id="4d2f8-227">Office アドインは、Office クライアントアプリケーションを使用してブラウザーで実行している場合、iframe でレンダリングされるため、以下のヒントを使用して、ユーザーが機密情報を公開するようにハッカーによって使用される手法である [jack](https://en.wikipedia.org/wiki/Clickjacking) のリスクを最小限に抑えます。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-227">Because Office Add-ins are rendered in an iframe when running in a browser with Office client applications, use the following tips to minimize the risk of [clickjacking](https://en.wikipedia.org/wiki/Clickjacking) -- a technique used by hackers to fool users into revealing confidential information.</span></span>

<span data-ttu-id="4d2f8-p126">まず、アドインが実行できる機密性の高いアクションを特定します。これには、未承認のユーザーが悪用できる、財務トランザクションの開始や機密データの公開などのアクションが含まれます。たとえば、アドインが支払いをユーザー定義の受信者に送信できる場合があります。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-p126">First, identify sensitive actions that your add-in can perform. These include any actions that an unauthorized user could use with malicious intent, such as initiating a financial transaction or publishing sensitive data. For example, your add-in might let the user send a payment to a user-defined recipient.</span></span>

<span data-ttu-id="4d2f8-p127">2 番目に、機密性の高いアクションでは、アドインがアクションを実行する前に、ユーザーに確認を求める必要があります。この確認では、アクションの影響を詳細に示す必要があります。また、「許可しない」と書かれた特定のボタンを選択するか、確認を無視することで、必要に応じてユーザーがアクションを止める方法も詳細に示す必要があります。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-p127">Second, for sensitive actions, your add-in should confirm with the user before it executes the action. This confirmation should detail what effect the action will have. It should also detail how the user can prevent the action, if necessary, whether by choosing a specific button marked "Don't Allow" or by ignoring the confirmation.</span></span>

<span data-ttu-id="4d2f8-234">3 番目に、潜在的な攻撃者が確認を非表示にしたり覆い隠したりする可能性がないようにするため、確認をアドインのコンテキストの外部 (HTML ダイアログ ボックスの外部) に表示する必要があります。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-234">Third, to ensure that no potential attacker can hide or mask the confirmation, you should display it outside the context of the add-in (that is, not in an HTML dialog box).</span></span>

<span data-ttu-id="4d2f8-235">確認を取得できる方法の例を次にいくつか示します。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-235">Here are some examples of how you could get confirmation:</span></span>

- <span data-ttu-id="4d2f8-236">確認のリンクが含まれている電子メールをユーザーに送信します。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-236">Send an email to the user that contains a confirmation link.</span></span>

- <span data-ttu-id="4d2f8-237">ユーザーがアドインで入力できる確認コードが含まれているテキスト メッセージをユーザーに送信します。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-237">Send a text message to the user that includes a confirmation code that the user can enter in the add-in.</span></span>

- <span data-ttu-id="4d2f8-p128">iframe に対応していないページについて、新しいブラウザー ウィンドウで確認ダイアログを開きます。これは通常、ログイン ページで使用するパターンです。新しいダイアログを作成するには、[ダイアログ API](../develop/dialog-api-in-office-add-ins.md) を使用します。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-p128">Open a confirmation dialog in a new browser window to a page that cannot be iframed. This is typically the pattern that is used by login pages. Use the [dialog api](../develop/dialog-api-in-office-add-ins.md) to create a new dialog.</span></span>

<span data-ttu-id="4d2f8-p129">また、ユーザーへの連絡に使用されているアドレスが、潜在的な攻撃者によって提供されている可能性がないことを確認してください。たとえば、支払いの確認には、承認されたユーザーのアカウントに関するファイル内のアドレスを使用します。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-p129">Also, ensure that the address you use for contacting the user couldn't have been provided by a potential attacker. For example, for payment confirmations use the address on file for the authorized user's account.</span></span>

### <a name="other-security-practices"></a><span data-ttu-id="4d2f8-243">その他のセキュリティ手法</span><span class="sxs-lookup"><span data-stu-id="4d2f8-243">Other security practices</span></span>

<span data-ttu-id="4d2f8-244">開発者は以下のセキュリティ手法にも注意する必要があります。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-244">Developers should also take note of the following security practices:</span></span>


- <span data-ttu-id="4d2f8-245">ActiveX コントロールはアドイン プラットフォームのクロス プラットフォームの特性をサポートしていないため、開発者は Office アドインで ActiveX コントロールを使用しないでください。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-245">Developers shouldn't use ActiveX controls in Office Add-ins as ActiveX controls don't support the cross-platform nature of the add-in platform.</span></span>

- <span data-ttu-id="4d2f8-p130">コンテンツ アドインと作業ウィンドウ アドインは、ブラウザーが既定で使用するものと同じ SSL 設定を使用することを前提としているため、ほとんどのコンテンツは SSL でのみ提供されていても問題ありません。Outlook アドインは、すべてのコンテンツが SSL で提供されている必要があります。開発者は、アドインの HTML ファイルの場所を示すときに、アドイン マニフェストの **SourceLocation** 要素で HTTPS を使用する URL を指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-p130">Content and task pane add-ins assume the same SSL settings that the browser uses by default, and allows most content to be delivered only by SSL. Outlook add-ins require all content to be delivered by SSL. Developers must specify in the **SourceLocation** element of the add-in manifest a URL that uses HTTPS, to identify the location of the HTML file for the add-in.</span></span>

    <span data-ttu-id="4d2f8-249">アドインが HTTP を使用してコンテンツを配信していないことを確認するために、開発者はアドインをテストするときに、[**コントロール パネル**] の [**インターネット オプション**] で次の設定が選択されていることと、テスト シナリオでセキュリティ警告が表示されないことを確認する必要があります。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-249">To make sure add-ins aren't delivering content by using HTTP, when testing add-ins, developers should make sure the following settings are selected in **Internet Options** in **Control Panel** and no security warnings appear in their test scenarios:</span></span>

    - <span data-ttu-id="4d2f8-250">[**インターネット**ゾーンのセキュリティ設定]、[混在した**コンテンツを表示**する] の設定が [確認] に設定されていることを確認**します。**</span><span class="sxs-lookup"><span data-stu-id="4d2f8-250">Make sure the security setting, **Display mixed content**, for the **Internet** zone is set to **Prompt**.</span></span> <span data-ttu-id="4d2f8-251">これを行うには、[ **インターネットオプション**] で次のように選択します。 [ **セキュリティ** ] タブで、 **インターネット** ゾーン、[ **カスタムレベル**]、[ **表示の混在**したコンテンツを検索] の順にスクロールし、まだ選択されていない場合は [ **プロンプト** ] を選択します。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-251">You can do that by selecting the following in **Internet Options**: on the **Security** tab, select the **Internet** zone, select **Custom level**, scroll to look for **Display mixed content**, and select **Prompt** if it isn't already selected.</span></span>

    - <span data-ttu-id="4d2f8-252">**[インターネット オプション]** ダイアログ ボックスの **[詳細設定]** タブで、**[保護付き/保護なしのサイト間を移動する場合に警告する]** が選択されていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-252">Make sure **Warn if Changing between Secure and not secure mode** is selected in the **Advanced** tab of the **Internet Options** dialog box.</span></span>

- <span data-ttu-id="4d2f8-p132">アドインで CPU コアやメモリ リソースが過剰に使用され、クライアント コンピューターでサービス拒否が発生しないように、アドイン プラットフォームにはリソース使用量の上限が設けられています。開発者はテストの一環として、アドイン プラットフォームがリソース使用量の上限を超えていないかどうかを確認する必要があります。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-p132">To make sure that add-ins don't use excessive CPU core or memory resources and cause any denial of service on a client computer, the add-in platform establishes resource usage limits. As part of testing, developers should verify whether an add-in performs within the resource usage limits.</span></span>

- <span data-ttu-id="4d2f8-255">開発者はアドインを発行する前に、アドイン ファイルで公開される個人を識別できる情報が保護されていることを確認する必要があります。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-255">Before publishing an add-in, developers should make sure that any personal identifiable information that they expose in their add-in files is secure.</span></span>

- <span data-ttu-id="4d2f8-p133">開発者は、アドインの HTML ページ内で直接サード パーティ API やサービス (Bing、Google、Facebook など) にアクセスするためのキーを埋め込まないようにしてください。代わりに、カスタム Web サービスを作成するか、キーを安全な Web ストレージの他の形態で保存して、キー値をアドインに渡すために呼び出すことができるようにする必要があります。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-p133">Developers shouldn't embed keys that they use to access third-party APIs or services (such as Bing, Google, or Facebook) directly in the HTML pages of their add-in. Instead, they should create a custom web service or store the keys in some other form of secure web storage that they can then call to pass the key value to their add-in.</span></span>

- <span data-ttu-id="4d2f8-258">開発者は AppSource にアドインを提出する際に、次の作業を実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-258">Developers should do the following when submitting an add-in to AppSource:</span></span>

  - <span data-ttu-id="4d2f8-259">SSL をサポートする Web サーバーで、提出するアドインをホストする。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-259">Host the add-in they are submitting on a web server that supports SSL.</span></span>
  - <span data-ttu-id="4d2f8-260">法規制に準拠したプライバシー ポリシーを記載した声明を作成する。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-260">Produce a statement outlining a compliant privacy policy.</span></span>
  - <span data-ttu-id="4d2f8-261">アドインの提出時に契約合意書に署名する。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-261">Be ready to sign a contractual agreement upon submitting the add-in.</span></span>

<span data-ttu-id="4d2f8-p134">Outlook アドインの開発者は、リソース使用量のルール以外に、アクティブ化ルールの指定と JavaScript API の使用に関する制限についてもアドインが遵守していることを確認する必要があります。詳細については、「[Outlook アドインのアクティブ化と JavaScript API に関する制限事項](../outlook/limits-for-activation-and-javascript-api-for-outlook-add-ins.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-p134">Other than resource usage rules, developers for Outlook add-ins should also make sure their add-ins observe limits for specifying activation rules and using the JavaScript API. For more information, see [Limits for activation and JavaScript API for Outlook add-ins](../outlook/limits-for-activation-and-javascript-api-for-outlook-add-ins.md).</span></span>

## <a name="it-administrators-control"></a><span data-ttu-id="4d2f8-264">IT 管理者による制御</span><span class="sxs-lookup"><span data-stu-id="4d2f8-264">IT administrators' control</span></span>

<span data-ttu-id="4d2f8-265">企業の設定では、IT 管理者は、AppSource とプライベート カタログへのアクセスの有効化または無効化に対して最終的な権限を持ちます。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-265">In a corporate setting, IT administrators have ultimate authority over enabling or disabling access to AppSource and any private catalogs.</span></span>

<span data-ttu-id="4d2f8-266">Office 設定の管理と適用はグループ ポリシー設定で行われます。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-266">The management and enforcement of Office settings is done with group policy settings.</span></span> <span data-ttu-id="4d2f8-267">これらは、[Office カスタマイズ ツール](/deployoffice/overview-of-the-office-customization-tool-for-click-to-run)と共に [Office 展開ツール](/deployoffice/overview-of-the-office-2016-deployment-tool)を介して構成できます。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-267">These are configurable through the [Office Deployment Tool](/deployoffice/overview-of-the-office-2016-deployment-tool), in conjunction with the [Office Customization Tool](/deployoffice/overview-of-the-office-customization-tool-for-click-to-run).</span></span>

| <span data-ttu-id="4d2f8-268">設定名</span><span class="sxs-lookup"><span data-stu-id="4d2f8-268">Setting name</span></span> | <span data-ttu-id="4d2f8-269">説明</span><span class="sxs-lookup"><span data-stu-id="4d2f8-269">Description</span></span> |
|--------------|-------------|
| <span data-ttu-id="4d2f8-270">セキュリティで保護されていないアドインとカタログの許可</span><span class="sxs-lookup"><span data-stu-id="4d2f8-270">Allow Unsecure web add-ins and Catalogs</span></span> | <span data-ttu-id="4d2f8-271">セキュリティで保護されていないアドインをユーザーが実行できるようにします。セキュリティで保護されていないアドインとは、SSL でセキュリティ保護 (https://) されていない、ユーザーのインターネット ゾーンにない、Web ページまたはカタログの場所が含まれるアドインです。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-271">Allows users to run non-secure add-ins, which are add-ins that have webpage or catalog locations that are not SSL-secured (https://) and are not in users' Internet zones.</span></span> |
| <span data-ttu-id="4d2f8-272">Web アドインのブロック</span><span class="sxs-lookup"><span data-stu-id="4d2f8-272">Block Web Add-ins</span></span> | <span data-ttu-id="4d2f8-273">ユーザーが Web アドインを使用できないようにします。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-273">Allows you to prevent users from using web add-ins.</span></span> |
| <span data-ttu-id="4d2f8-274">Office ストアのブロック</span><span class="sxs-lookup"><span data-stu-id="4d2f8-274">Block the Office Store</span></span> |  <span data-ttu-id="4d2f8-275">Office ストアから入手した Web アドインをユーザーが使用または挿入できないようにします。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-275">Allows you to prevent users from using or inserting web add-ins that come from the Office Store.</span></span> |

> [!IMPORTANT]
> <span data-ttu-id="4d2f8-276">作業グループが複数のリリースの Office を使用している場合は、リリースごとにグループ ポリシー設定を構成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-276">If your working groups are using multiple releases of Office, group policy settings must be configured for each release.</span></span> <span data-ttu-id="4d2f8-277">Office 2013 のグループ ポリシー設定の詳細については、記事「[Office 2013 用アプリの概要](/previous-versions/office/office-2013-resource-kit/jj219429(v%3doffice.15))」の「[グループ ポリシーを使用して、ユーザーが Office 用アプリをインストールおよび使用する方法を管理する](/previous-versions/office/office-2013-resource-kit/jj219429(v=office.15)#using-group-policy-to-manage-how-users-can-install-and-use-apps-for-office)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="4d2f8-277">Please refer to the [Using Group Policy to manage how users can install and use apps for Office](/previous-versions/office/office-2013-resource-kit/jj219429(v=office.15)#using-group-policy-to-manage-how-users-can-install-and-use-apps-for-office) of the [Overview of apps for Office 2013](/previous-versions/office/office-2013-resource-kit/jj219429(v%3doffice.15)) article for details on group policy settings for Office 2013.</span></span>

## <a name="see-also"></a><span data-ttu-id="4d2f8-278">関連項目</span><span class="sxs-lookup"><span data-stu-id="4d2f8-278">See also</span></span>

- [<span data-ttu-id="4d2f8-279">アドインでの API 使用についてアクセス許可を要求する</span><span class="sxs-lookup"><span data-stu-id="4d2f8-279">Requesting permissions for API use in add-ins</span></span>](../develop/requesting-permissions-for-api-use-in-content-and-task-pane-add-ins.md)
- [<span data-ttu-id="4d2f8-280">Outlook アドインに関するプライバシー、アクセス許可、セキュリティ</span><span class="sxs-lookup"><span data-stu-id="4d2f8-280">Privacy, permissions, and security for Outlook add-ins</span></span>](../outlook/privacy-and-security.md)
- [<span data-ttu-id="4d2f8-281">Outlook アドインのアクセス許可を理解する</span><span class="sxs-lookup"><span data-stu-id="4d2f8-281">Understanding Outlook add-in permissions</span></span>](../outlook/understanding-outlook-add-in-permissions.md)
- [<span data-ttu-id="4d2f8-282">Outlook アドインのアクティブ化と JavaScript API の制限</span><span class="sxs-lookup"><span data-stu-id="4d2f8-282">Limits for activation and JavaScript API for Outlook add-ins</span></span>](../outlook/limits-for-activation-and-javascript-api-for-outlook-add-ins.md)
- [<span data-ttu-id="4d2f8-283">Office アドインにおける同一生成元ポリシーの制限への対処</span><span class="sxs-lookup"><span data-stu-id="4d2f8-283">Addressing same-origin policy limitations in Office Add-ins</span></span>](../develop/addressing-same-origin-policy-limitations.md)
- [<span data-ttu-id="4d2f8-284">同一生成元ポリシー</span><span class="sxs-lookup"><span data-stu-id="4d2f8-284">Same Origin Policy</span></span>](https://www.w3.org/Security/wiki/Same_Origin_Policy)
- [<span data-ttu-id="4d2f8-285">同一生成元ポリシー パート 1:ピーク禁止</span><span class="sxs-lookup"><span data-stu-id="4d2f8-285">Same Origin Policy Part 1: No Peeking</span></span>](/archive/blogs/ieinternals/same-origin-policy-part-1-no-peeking)
- [<span data-ttu-id="4d2f8-286">JavaScript の同一生成元ポリシー</span><span class="sxs-lookup"><span data-stu-id="4d2f8-286">Same origin policy for JavaScript</span></span>](https://developer.mozilla.org/docs/Web/Security/Same-origin_policy)
- [<span data-ttu-id="4d2f8-287">IE 保護モード</span><span class="sxs-lookup"><span data-stu-id="4d2f8-287">IE Protect Mode</span></span>](https://support.microsoft.com/help/2761180/apps-for-office-don-t-start-if-you-disable-protected-mode-for-the-restricted-sites-zone-in-internet-explorer)
