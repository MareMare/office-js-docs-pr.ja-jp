---
title: Office アドインのリソースの制限とパフォーマンスの最適化
description: CPU とメモリを含む、Office アドインプラットフォームのリソースの制限について説明します。
ms.date: 07/29/2020
localization_priority: Normal
ms.openlocfilehash: 8c64e5a836d6b998ccd7022e71f595bb331bba8c
ms.sourcegitcommit: 9609bd5b4982cdaa2ea7637709a78a45835ffb19
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/28/2020
ms.locfileid: "47293332"
---
# <a name="resource-limits-and-performance-optimization-for-office-add-ins"></a><span data-ttu-id="f2969-103">Office アドインのリソースの制限とパフォーマンスの最適化</span><span class="sxs-lookup"><span data-stu-id="f2969-103">Resource limits and performance optimization for Office Add-ins</span></span>

<span data-ttu-id="f2969-p101">ユーザーのベスト エクスペリエンスを実現するために、Office アドイン実行時の CPU コア、メモリの使用量、信頼性、および Outlook アドインの正規表現の評価の応答時間を一定以内に保つ必要があります。これらの実行時のリソース使用量の制限は、Windows と OS X 用の Office クライアントに適用され、モバイルアプリやブラウザーでは適用されません。</span><span class="sxs-lookup"><span data-stu-id="f2969-p101">To create the best experience for your users, ensure that your Office Add-in performs within specific limits for CPU core and memory usage, reliability, and, for Outlook add-ins, the response time for evaluating regular expressions. These run-time resource usage limits apply to add-ins running in Office clients on Windows and OS X, but not on mobile apps or in a browser.</span></span>

<span data-ttu-id="f2969-106">また、デスクトップやモバイル デバイス上のアドインについても、アドインの設計と実装でリソース使用量を最適化することによって、そのパフォーマンスを最適化できます。</span><span class="sxs-lookup"><span data-stu-id="f2969-106">You can also optimize the performance of your add-ins on desktop and mobile devices by optimizing the use of resources in your add-in design and implementation.</span></span>

## <a name="resource-usage-limits-for-add-ins"></a><span data-ttu-id="f2969-107">アドインのリソース使用量の制限</span><span class="sxs-lookup"><span data-stu-id="f2969-107">Resource usage limits for add-ins</span></span>

<span data-ttu-id="f2969-108">実行時のリソース使用量の制限は、すべての種類の Office アドインに適用されます。これらの制限は、ユーザーのパフォーマンスを確保し、サービス拒否攻撃を軽減するのに役立ちます。</span><span class="sxs-lookup"><span data-stu-id="f2969-108">Run-time resource usage limits apply to all types of Office Add-ins. These limits help ensure performance for your users and mitigate denial-of-service attacks.</span></span> <span data-ttu-id="f2969-109">使用可能なデータの範囲を使用して、対象の Office アプリケーションで Office アドインをテストし、次の実行時の使用法の制限に対してパフォーマンスを測定します。</span><span class="sxs-lookup"><span data-stu-id="f2969-109">Be sure to test your Office Add-in on your target Office application by using a range of possible data, and measure its performance against the following run-time usage limits:</span></span>

- <span data-ttu-id="f2969-110">**CPU コアの使用率**: 単一の CPU コアの使用率しきい値 90%、既定の 5 秒間隔で 3 回観測。</span><span class="sxs-lookup"><span data-stu-id="f2969-110">**CPU core usage** - A single CPU core usage threshold of 90%, observed three times in default 5-second intervals.</span></span>

   <span data-ttu-id="f2969-111">Office クライアントが CPU コア使用率をチェックする既定の間隔は、5秒ごとです。</span><span class="sxs-lookup"><span data-stu-id="f2969-111">The default interval for an Office client to check CPU core usage is every 5 seconds.</span></span> <span data-ttu-id="f2969-112">Office クライアントが、アドインの CPU コアの使用率をしきい値を超える場合は、ユーザーがアドインの実行を続行するかどうかを確認するメッセージを表示します。</span><span class="sxs-lookup"><span data-stu-id="f2969-112">If the Office client detects the CPU core usage of an add-in is above the threshold value, it displays a message asking if the user wants to continue running the add-in.</span></span> <span data-ttu-id="f2969-113">ユーザーが続行することを選択した場合、Office クライアントは編集セッション中にユーザーに対して再度要求を行いません。</span><span class="sxs-lookup"><span data-stu-id="f2969-113">If the user chooses to continue, the Office client does not ask the user again during that edit session.</span></span> <span data-ttu-id="f2969-114">ユーザーが CPU を集中的に使用するアドインを実行する場合、この警告メッセージの表示を減らすには、管理者は **AlertInterval** レジストリ キーを使用する必要がある可能性があります。</span><span class="sxs-lookup"><span data-stu-id="f2969-114">Administrators might want to use the **AlertInterval** registry key to raise the threshold to reduce the display of this warning message if users run CPU-intensive add-ins.</span></span>

- <span data-ttu-id="f2969-115">**メモリ使用量**: デバイスの利用可能な物理メモリに基づいて動的に決定される、既定のメモリ使用量しきい値。</span><span class="sxs-lookup"><span data-stu-id="f2969-115">**Memory usage** - A default memory usage threshold that is dynamically determined based on the available physical memory of the device.</span></span>

   <span data-ttu-id="f2969-116">既定では、Office クライアントは、デバイス上の物理メモリの使用率が使用可能なメモリの80% を超えることを検出すると、アドインのメモリ使用量、コンテンツアドインと作業ウィンドウアドインのドキュメントレベル、および Outlook アドインのメールボックスレベルで、クライアントによって監視が開始されます。既定の5秒の間隔で、ドキュメントまたはメールボックスレベルのアドインの物理メモリ使用量が50% を超えた場合、クライアントはユーザーに警告を表示します。</span><span class="sxs-lookup"><span data-stu-id="f2969-116">By default, when a Office client detects that physical memory usage on a device exceeds 80% of the available memory, the client starts monitoring the add-in's memory usage, at a document level for content and task pane add-ins, and at a mailbox level for Outlook add-ins. At a default interval of 5 seconds, the client warns the user if physical memory usage for a set of add-ins at the document or mailbox level exceeds 50%.</span></span> <span data-ttu-id="f2969-117">このメモリ使用量の制限は、仮想メモリではなく物理を使用して、タブレットなどの RAM に制限があるデバイスのパフォーマンスを確保します。</span><span class="sxs-lookup"><span data-stu-id="f2969-117">This memory usage limit uses physical rather than virtual memory to ensure performance on devices with limited RAM, such as tablets.</span></span> <span data-ttu-id="f2969-118">管理者は、グローバル設定として **Memoryalertthreshold** Windows レジストリキーを使用して明示的な制限でこの動的設定を上書きできます。 ir は、グローバル設定として **alertinterval** キーを使用してアラート間隔を調整します。</span><span class="sxs-lookup"><span data-stu-id="f2969-118">Administrators can override this dynamic setting with an explicit limit by using the **MemoryAlertThreshold** Windows registry key as a global setting, ir adjust the alert interval by using the **AlertInterval** key as a global setting.</span></span>

- <span data-ttu-id="f2969-119">**クラッシュ許容度**: 既定の制限は、1 つのアドインにつき 4 回。</span><span class="sxs-lookup"><span data-stu-id="f2969-119">**Crash tolerance** - A default limit of four crashes for an add-in.</span></span>

   <span data-ttu-id="f2969-120">管理者は、**RestartManagerRetryLimit** レジストリ キーを使用して、クラッシュのしきい値を調整できます。</span><span class="sxs-lookup"><span data-stu-id="f2969-120">Administrators can adjust the threshold for crashes by using the **RestartManagerRetryLimit** registry key.</span></span>

- <span data-ttu-id="f2969-121">**アプリケーションのブロッキング**: アドインが応答しないままになる時間のしきい値は 5 秒間。</span><span class="sxs-lookup"><span data-stu-id="f2969-121">**Application blocking** - Prolonged unresponsiveness threshold of 5 seconds for an add-in.</span></span>

   <span data-ttu-id="f2969-122">これは、アドインと Office アプリケーションのユーザーエクスペリエンスに影響します。</span><span class="sxs-lookup"><span data-stu-id="f2969-122">This affects the user's experiences of the add-in and the Office application.</span></span> <span data-ttu-id="f2969-123">この場合、Office アプリケーションは、ドキュメントまたはメールボックス (該当する場合) に対してすべてのアクティブなアドインを自動的に再起動し、アドインが応答しなくなったことをユーザーに警告します。</span><span class="sxs-lookup"><span data-stu-id="f2969-123">When this occurs, the Office application automatically restarts all the active add-ins for a document or mailbox (where applicable), and warns the user as to which add-in became unresponsive.</span></span> <span data-ttu-id="f2969-124">アドインが時間のかかるタスクを実行していて定期的に処理を発生させないときに、このしきい値に到達する場合があります。</span><span class="sxs-lookup"><span data-stu-id="f2969-124">Add-ins can reach this threshold when they do not regularly yield processing while performing long-running tasks.</span></span> <span data-ttu-id="f2969-125">ブロッキングが発生しないようにする手法があります。</span><span class="sxs-lookup"><span data-stu-id="f2969-125">There are techniques to ensure that blocking does not occur.</span></span> <span data-ttu-id="f2969-126">管理者は、このしきい値を上書きすることはできません。</span><span class="sxs-lookup"><span data-stu-id="f2969-126">Administrators cannot override this threshold.</span></span>

### <a name="outlook-add-ins"></a><span data-ttu-id="f2969-127">Outlook アドイン</span><span class="sxs-lookup"><span data-stu-id="f2969-127">Outlook add-ins</span></span>

<span data-ttu-id="f2969-p106">Outlook アドインが前述の CPU コア使用率、メモリ使用量、またはクラッシュ許容度のしきい値を超えると、そのアドインは Outlook で無効化されます。Exchange 管理センターにはそのアプリの無効状態が表示されます。</span><span class="sxs-lookup"><span data-stu-id="f2969-p106">If any Outlook add-in exceeds the preceding thresholds for CPU core or memory usage, or tolerance limit for crashes, Outlook disables the add-in. The Exchange Admin Center displays the disabled status of the app.</span></span>

> [!NOTE]
> <span data-ttu-id="f2969-130">Outlook on the web やモバイル端末ではなく、Outlook リッチ クライアントによってのみ、リソース使用量をモニターする場合でも、リッチ クライアントが Outlook アドインを無効化すると、このアドインは Outlook on the web やモバイル端末でも無効化されます。</span><span class="sxs-lookup"><span data-stu-id="f2969-130">Even though only the Outlook rich clients and not Outlook on the web or mobile devices monitor resource usage, if a rich client disables an Outlook add-in, that add-in is also disabled for use in Outlook on the web and mobile devices.</span></span>

<span data-ttu-id="f2969-131">CPU コア、メモリ、および信頼性ルールだけでなく、Outlook アドインは次のアクティブ化のルールを監視する必要があります。</span><span class="sxs-lookup"><span data-stu-id="f2969-131">In addition to the CPU core, memory, and reliability rules, Outlook add-ins should observe the following rules on activation:</span></span>

- <span data-ttu-id="f2969-p107">**正規表現の応答時間**: Outlook で Outlook アドインのマニフェスト内のすべての正規表現を評価する時間の既定のしきい値は 1,000 ミリ秒。このしきい値を超えると、Outlook は後で評価を再試行します。</span><span class="sxs-lookup"><span data-stu-id="f2969-p107">**Regular expressions response time** - A default threshold of 1,000 milliseconds for Outlook to evaluate all regular expressions in the manifest of an Outlook add-in. Exceeding the threshold causes Outlook to retry evaluation at a later time.</span></span>

    <span data-ttu-id="f2969-134">管理者は、Windows レジストリでグループ ポリシーまたはアプリケーション固有の設定として **OutlookActivationAlertThreshold** 設定を使用して、この 1,000 ミリ秒の既定のしきい値を調節できます。</span><span class="sxs-lookup"><span data-stu-id="f2969-134">Using a group policy or application-specific setting in the Windows registry, administrators can adjust this default threshold value of 1,000 milliseconds in the **OutlookActivationAlertThreshold** setting.</span></span>

- <span data-ttu-id="f2969-135">**正規表現の再評価**: Outlook でマニフェスト内の正規表現を再評価する既定の制限は 3 回。</span><span class="sxs-lookup"><span data-stu-id="f2969-135">**Regular expressions re-evaluation** - A default limit of three times for Outlook to reevaluate all the regular expressions in a manifest.</span></span> <span data-ttu-id="f2969-136">適用されるしきい値 (既定の 1,000 ミリ秒、または Windows レジストリに **OutlookActivationAlertThreshold** 設定が存在する場合はその設定で指定された値) を 3 回とも超えて評価に失敗すると、その Outlook アドインは Outlook で無効化されます。</span><span class="sxs-lookup"><span data-stu-id="f2969-136">If evaluation fails all three times by exceeding the applicable threshold (which is either the default of 1,000 milliseconds or a value specified by **OutlookActivationAlertThreshold**, if that setting exists in the Windows registry), Outlook disables the Outlook add-in.</span></span> <span data-ttu-id="f2969-137">Exchange 管理センターに [無効] の状態が表示され、Outlook リッチクライアントおよび Outlook on the web およびモバイルデバイスで使用するアドインが無効になっています。</span><span class="sxs-lookup"><span data-stu-id="f2969-137">The Exchange Admin Center displays the disabled status, and the add-in is disabled for use in the Outlook rich clients, and Outlook on the web and mobile devices.</span></span>

    <span data-ttu-id="f2969-138">管理者は、Windows レジストリでグループ ポリシーまたはアプリケーション固有の設定として **OutlookActivationManagerRetryLimit** 設定を使用して、評価を再試行するこの回数を調節できます。</span><span class="sxs-lookup"><span data-stu-id="f2969-138">Using a group policy or application-specific setting in the Windows registry, administrators can adjust this number of times to retry evaluation in the **OutlookActivationManagerRetryLimit** setting.</span></span>

### <a name="excel-add-ins"></a><span data-ttu-id="f2969-139">Excel アドイン</span><span class="sxs-lookup"><span data-stu-id="f2969-139">Excel add-ins</span></span>

<span data-ttu-id="f2969-140">Excel アドインを作成している場合は、ブックを操作するときに以下のサイズ制限に注意してください。</span><span class="sxs-lookup"><span data-stu-id="f2969-140">If you're building an Excel add-in, be aware of the following size limitations when interacting with the workbook:</span></span>

- <span data-ttu-id="f2969-141">Excel on the web ではペイロードのサイズが要求と応答で 5 MB に制限されています。</span><span class="sxs-lookup"><span data-stu-id="f2969-141">Excel on the web has a payload size limit for requests and responses of 5MB.</span></span> <span data-ttu-id="f2969-142">その制限を超えると、`RichAPI.Error` がスローされます。</span><span class="sxs-lookup"><span data-stu-id="f2969-142">`RichAPI.Error` will be thrown if that limit is exceeded.</span></span>
- <span data-ttu-id="f2969-143">範囲は、取得操作に500万のセルに制限されます。</span><span class="sxs-lookup"><span data-stu-id="f2969-143">A range is limited to five million cells for get operations.</span></span>

<span data-ttu-id="f2969-144">ユーザー入力がこれらの制限を超えていることが予想される場合は、必ずデータを確認してから、を呼び出してください `context.sync()` 。</span><span class="sxs-lookup"><span data-stu-id="f2969-144">If you expect user input to exceed these limits, be sure to check the data before calling `context.sync()`.</span></span> <span data-ttu-id="f2969-145">必要に応じて、操作を小さな部分に分割します。</span><span class="sxs-lookup"><span data-stu-id="f2969-145">Split the operation into smaller pieces as needed.</span></span> <span data-ttu-id="f2969-146">`context.sync()`各サブ操作を呼び出して、それらの操作が再度一括されないようにしてください。</span><span class="sxs-lookup"><span data-stu-id="f2969-146">Be sure to call `context.sync()` for each sub-operation to avoid those operations getting batched together again.</span></span>

<span data-ttu-id="f2969-147">これらの制限は、通常、大きな範囲を超えています。</span><span class="sxs-lookup"><span data-stu-id="f2969-147">These limitations are typically exceeded by large ranges.</span></span> <span data-ttu-id="f2969-148">アドインでは、範囲内のセルを戦略的に更新するために [Rangeareas](/javascript/api/excel/excel.rangeareas) を使用できる場合があります。</span><span class="sxs-lookup"><span data-stu-id="f2969-148">Your add-in might be able to use [RangeAreas](/javascript/api/excel/excel.rangeareas) to strategically update cells within a larger range.</span></span> <span data-ttu-id="f2969-149">詳細については、「 [Excel アドインで複数の範囲を同時に操作](../excel/excel-add-ins-multiple-ranges.md) する」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="f2969-149">See [Work with multiple ranges simultaneously in Excel add-ins](../excel/excel-add-ins-multiple-ranges.md) for more information.</span></span>

### <a name="task-pane-and-content-add-ins"></a><span data-ttu-id="f2969-150">作業ウィンドウ アドインとコンテンツ アドイン</span><span class="sxs-lookup"><span data-stu-id="f2969-150">Task pane and content add-ins</span></span>

<span data-ttu-id="f2969-151">いずれかのコンテンツまたは作業ウィンドウアドインが CPU コアまたはメモリ使用率のしきい値を超えている場合、またはクラッシュの許容範囲制限が超過している場合は、対応する Office アプリケーションによってユーザーに対して警告が表示されます。</span><span class="sxs-lookup"><span data-stu-id="f2969-151">If any content or task pane add-in exceeds the preceding thresholds on CPU core or memory usage, or tolerance limit for crashes, the corresponding Office application displays a warning for the user.</span></span> <span data-ttu-id="f2969-152">この時点で、ユーザーは次のどちらかの処理を実行できます。</span><span class="sxs-lookup"><span data-stu-id="f2969-152">At this point, the user can do one of the following:</span></span>

- <span data-ttu-id="f2969-153">アドインを再起動します。</span><span class="sxs-lookup"><span data-stu-id="f2969-153">Restart the add-in.</span></span>
- <span data-ttu-id="f2969-p113">しきい値を超えたというそれ以降の警告をキャンセルします。理想的な対処としては、ユーザーはそのアドインをドキュメントから削除する必要があります。そのアドインの使用を続行すると、さらにパフォーマンスと安定性の問題が発生する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="f2969-p113">Cancel further alerts about exceeding that threshold. Ideally, the user should then delete the add-in from the document; continuing the add-in would risk further performance and stability issues.</span></span>  

## <a name="verifying-resource-usage-issues-in-the-telemetry-log"></a><span data-ttu-id="f2969-156">テレメトリ ログでリソース使用量の問題を確認する</span><span class="sxs-lookup"><span data-stu-id="f2969-156">Verifying resource usage issues in the Telemetry Log</span></span>

<span data-ttu-id="f2969-p114">Office には、Office アドインでのリソースの使用に関する問題も含めて、ローカル コンピューター上で実行される Office ソリューションの一定のイベント (読み込む、開く、閉じる、およびエラー) の記録を保守するテレメトリ ログが用意されています。テレメトリ ログを設定してある場合は、Excel を使用して、ローカル ドライブ上の次の既定の場所にあるテレメトリ ログを開くことができます。</span><span class="sxs-lookup"><span data-stu-id="f2969-p114">Office provides a Telemetry Log that maintains a record of certain events (loading, opening, closing, and errors) of Office solutions running on the local computer, including resource usage issues in an Office Add-in. If you have the Telemetry Log set up, you can use Excel to open the Telemetry Log in the following default location on your local drive:</span></span>

`%Users%\<Current user>\AppData\Local\Microsoft\Office\15.0\Telemetry`

<span data-ttu-id="f2969-p115">それぞれのアドインについてテレメトリ ログで追跡されるイベントごとに、そのイベントの発生日付/時刻、イベント ID、重大度、および短い説明的なタイトル、そのアドインのフレンドリ名と ID、イベントをログに記録したアプリケーションが記入されています。テレメトリ ログをリフレッシュすれば、現在の追跡済みイベントを確認できます。次の表は、テレメトリ ログで追跡された Outlook アドインの例を示しています。</span><span class="sxs-lookup"><span data-stu-id="f2969-p115">For each event that the Telemetry Log tracks for an add-in, there is a date/time of the occurrence, event ID, severity, and short descriptive title for the event, the friendly name and unique ID of the add-in, and the application that logged the event. You can refresh the Telemetry Log to see the current tracked events. The following table shows examples of Outlook add-ins that were tracked in the Telemetry log.</span></span>

|<span data-ttu-id="f2969-162">**日付/時刻**</span><span class="sxs-lookup"><span data-stu-id="f2969-162">**Date/Time**</span></span>|<span data-ttu-id="f2969-163">**イベント ID**</span><span class="sxs-lookup"><span data-stu-id="f2969-163">**Event ID**</span></span>|<span data-ttu-id="f2969-164">**重大度**</span><span class="sxs-lookup"><span data-stu-id="f2969-164">**Severity**</span></span>|<span data-ttu-id="f2969-165">**タイトル**</span><span class="sxs-lookup"><span data-stu-id="f2969-165">**Title**</span></span>|<span data-ttu-id="f2969-166">**ファイル**</span><span class="sxs-lookup"><span data-stu-id="f2969-166">**File**</span></span>|<span data-ttu-id="f2969-167">**ID**</span><span class="sxs-lookup"><span data-stu-id="f2969-167">**ID**</span></span>|<span data-ttu-id="f2969-168">**アプリケーション**</span><span class="sxs-lookup"><span data-stu-id="f2969-168">**Application**</span></span>|
|:-----|:-----|:-----|:-----|:-----|:-----|:-----|
|<span data-ttu-id="f2969-169">10/8/2012 5:57:10 PM</span><span class="sxs-lookup"><span data-stu-id="f2969-169">10/8/2012 5:57:10 PM</span></span>|<span data-ttu-id="f2969-170">7 </span><span class="sxs-lookup"><span data-stu-id="f2969-170">7</span></span>||<span data-ttu-id="f2969-171">アドインのマニフェストが正常にダウンロードされました</span><span class="sxs-lookup"><span data-stu-id="f2969-171">add-in manifest downloaded successfully</span></span>|<span data-ttu-id="f2969-172">重要人物</span><span class="sxs-lookup"><span data-stu-id="f2969-172">Who's Who</span></span>|<span data-ttu-id="f2969-173">69cc567c-6737-4c49-88dd-123334943a22</span><span class="sxs-lookup"><span data-stu-id="f2969-173">69cc567c-6737-4c49-88dd-123334943a22</span></span>|<span data-ttu-id="f2969-174">Outlook</span><span class="sxs-lookup"><span data-stu-id="f2969-174">Outlook</span></span>|
|<span data-ttu-id="f2969-175">10/8/2012 5:57:01 PM</span><span class="sxs-lookup"><span data-stu-id="f2969-175">10/8/2012 5:57:01 PM</span></span>|<span data-ttu-id="f2969-176">7 </span><span class="sxs-lookup"><span data-stu-id="f2969-176">7</span></span>||<span data-ttu-id="f2969-177">アドインのマニフェストが正常にダウンロードされました</span><span class="sxs-lookup"><span data-stu-id="f2969-177">add-in manifest downloaded successfully</span></span>|<span data-ttu-id="f2969-178">LinkedIn</span><span class="sxs-lookup"><span data-stu-id="f2969-178">LinkedIn</span></span>|<span data-ttu-id="f2969-179">333bf46d-7dad-4f2b-8cf4-c19ddc78b723</span><span class="sxs-lookup"><span data-stu-id="f2969-179">333bf46d-7dad-4f2b-8cf4-c19ddc78b723</span></span>|<span data-ttu-id="f2969-180">Outlook</span><span class="sxs-lookup"><span data-stu-id="f2969-180">Outlook</span></span>|

<span data-ttu-id="f2969-181">次の表は、通常、Office アドインについてテレメトリ ログで追跡されるイベントを示しています。</span><span class="sxs-lookup"><span data-stu-id="f2969-181">The following table lists the events that the Telemetry Log tracks for Office Add-ins in general.</span></span>

|<span data-ttu-id="f2969-182">**イベント ID**</span><span class="sxs-lookup"><span data-stu-id="f2969-182">**Event ID**</span></span>|<span data-ttu-id="f2969-183">**タイトル**</span><span class="sxs-lookup"><span data-stu-id="f2969-183">**Title**</span></span>|<span data-ttu-id="f2969-184">**重大度**</span><span class="sxs-lookup"><span data-stu-id="f2969-184">**Severity**</span></span>|<span data-ttu-id="f2969-185">**説明**</span><span class="sxs-lookup"><span data-stu-id="f2969-185">**Description**</span></span>|
|:-----|:-----|:-----|:-----|
|<span data-ttu-id="f2969-186">7 </span><span class="sxs-lookup"><span data-stu-id="f2969-186">7</span></span>|<span data-ttu-id="f2969-187">アドインのマニフェストが正常にダウンロードされました</span><span class="sxs-lookup"><span data-stu-id="f2969-187">Add-in manifest downloaded successfully</span></span>||<span data-ttu-id="f2969-188">Office アドインのマニフェストが正常に読み込まれ、Office アプリケーションによって読み取られました。</span><span class="sxs-lookup"><span data-stu-id="f2969-188">The manifest of the Office Add-in was successfully loaded and read by the Office application.</span></span>|
|<span data-ttu-id="f2969-189">8 </span><span class="sxs-lookup"><span data-stu-id="f2969-189">8</span></span>|<span data-ttu-id="f2969-190">アドインのマニフェストがダウンロードされませんでした</span><span class="sxs-lookup"><span data-stu-id="f2969-190">Add-in manifest did not download</span></span>|<span data-ttu-id="f2969-191">重大</span><span class="sxs-lookup"><span data-stu-id="f2969-191">Critical</span></span>|<span data-ttu-id="f2969-192">Office アプリケーションは、SharePoint カタログ、コーポレートカタログ、または AppSource から Office アドインのマニフェストファイルを読み込むことができませんでした。</span><span class="sxs-lookup"><span data-stu-id="f2969-192">The Office application was unable to load the manifest file for the Office Add-in from the SharePoint catalog, corporate catalog, or AppSource.</span></span>|
|<span data-ttu-id="f2969-193">9 </span><span class="sxs-lookup"><span data-stu-id="f2969-193">9</span></span>|<span data-ttu-id="f2969-194">アドインのマークアップを解析できませんでした</span><span class="sxs-lookup"><span data-stu-id="f2969-194">Add-in markup could not be parsed</span></span>|<span data-ttu-id="f2969-195">重大</span><span class="sxs-lookup"><span data-stu-id="f2969-195">Critical</span></span>|<span data-ttu-id="f2969-196">Office アプリケーションは Office アドインマニフェストを読み込みましたが、アプリの HTML マークアップを読み取れませんでした。</span><span class="sxs-lookup"><span data-stu-id="f2969-196">The Office application loaded the Office Add-in manifest, but could not read the HTML markup of the app.</span></span>|
|<span data-ttu-id="f2969-197">10 </span><span class="sxs-lookup"><span data-stu-id="f2969-197">10</span></span>|<span data-ttu-id="f2969-198">アドインの CPU 使用率が高すぎます</span><span class="sxs-lookup"><span data-stu-id="f2969-198">Add-in used too much CPU</span></span>|<span data-ttu-id="f2969-199">重大</span><span class="sxs-lookup"><span data-stu-id="f2969-199">Critical</span></span>|<span data-ttu-id="f2969-200">Office アドインは、限定された時間内に CPU リソースの 90% 超を使用しました。</span><span class="sxs-lookup"><span data-stu-id="f2969-200">The Office Add-in used more than 90% of the CPU resources over a finite period of time.</span></span>|
|<span data-ttu-id="f2969-201">15 </span><span class="sxs-lookup"><span data-stu-id="f2969-201">15</span></span>|<span data-ttu-id="f2969-202">アドインは文字列検索のタイムアウトのため無効になっています</span><span class="sxs-lookup"><span data-stu-id="f2969-202">Add-in disabled due to string search time-out</span></span>||<span data-ttu-id="f2969-p116">Outlook アドインは電子メールの件名とメッセージを検索して、それらを正規表現で表示するかどうかを決定します。**[File]** 列に記された Outlook アドインは、正規表現での一致を試みている最中に繰り返しタイムアウトしたため、Outlook によって無効にされました。</span><span class="sxs-lookup"><span data-stu-id="f2969-p116">Outlook add-ins search the subject line and message of an e-mail to determine whether they should be displayed by using a regular expression. The Outlook add-in listed in the **File** column was disabled by Outlook because it timed out repeatedly while trying to match a regular expression.</span></span>|
|<span data-ttu-id="f2969-205">18 </span><span class="sxs-lookup"><span data-stu-id="f2969-205">18</span></span>|<span data-ttu-id="f2969-206">アドインは正常に終了しました</span><span class="sxs-lookup"><span data-stu-id="f2969-206">Add-in closed successfully</span></span>||<span data-ttu-id="f2969-207">Office アプリケーションは、Office アドインを正常に閉じることができました。</span><span class="sxs-lookup"><span data-stu-id="f2969-207">The Office application was able to close the Office Add-in successfully.</span></span>|
|<span data-ttu-id="f2969-208">年</span><span class="sxs-lookup"><span data-stu-id="f2969-208">19</span></span>|<span data-ttu-id="f2969-209">アドインで実行時エラーが発生しました</span><span class="sxs-lookup"><span data-stu-id="f2969-209">Add-in encountered runtime error</span></span>|<span data-ttu-id="f2969-210">重大</span><span class="sxs-lookup"><span data-stu-id="f2969-210">Critical</span></span>|<span data-ttu-id="f2969-211">Office アドインに、エラーの原因となる問題がありました。</span><span class="sxs-lookup"><span data-stu-id="f2969-211">The Office Add-in had a problem that caused it to fail.</span></span> <span data-ttu-id="f2969-212">詳細については、エラーが発生したコンピューター上で Windows イベント ビューアーを使用して **Microsoft Office Alerts** ログを確認してください。</span><span class="sxs-lookup"><span data-stu-id="f2969-212">For more details, look at the **Microsoft Office Alerts** log using the Windows Event Viewer on the computer that encountered the error.</span></span>|
|<span data-ttu-id="f2969-213">1280</span><span class="sxs-lookup"><span data-stu-id="f2969-213">20</span></span>|<span data-ttu-id="f2969-214">アドインでライセンスを確認できませんでした</span><span class="sxs-lookup"><span data-stu-id="f2969-214">Add-in failed to verify licensing</span></span>|<span data-ttu-id="f2969-215">重大</span><span class="sxs-lookup"><span data-stu-id="f2969-215">Critical</span></span>|<span data-ttu-id="f2969-216">Office アドインのライセンス情報を確認できないか、有効期限が切れている可能性があります。</span><span class="sxs-lookup"><span data-stu-id="f2969-216">The licensing information for the Office Add-in could not be verified and may have expired.</span></span> <span data-ttu-id="f2969-217">詳細については、エラーが発生したコンピューター上で Windows イベント ビューアーを使用して **Microsoft Office Alerts** ログを確認してください。</span><span class="sxs-lookup"><span data-stu-id="f2969-217">For more details, look at the **Microsoft Office Alerts** log using the Windows Event Viewer on the computer that encountered the error.</span></span>|

<span data-ttu-id="f2969-218">詳細については、「[テレメトリ ダッシュボードを展開する](/previous-versions/office/office-2013-resource-kit/jj219431(v=office.15))」および「[テレメトリ ログを使用した Office ファイルおよびカスタム ソリューションのトラブルシューティング](/office/client-developer/shared/troubleshooting-office-files-and-custom-solutions-with-the-telemetry-log)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="f2969-218">For more information, see [Deploying Telemetry Dashboard](/previous-versions/office/office-2013-resource-kit/jj219431(v=office.15)) and [Troubleshooting Office files and custom solutions with the telemetry log](/office/client-developer/shared/troubleshooting-office-files-and-custom-solutions-with-the-telemetry-log).</span></span>

## <a name="design-and-implementation-techniques"></a><span data-ttu-id="f2969-219">設計および実装上のテクニック</span><span class="sxs-lookup"><span data-stu-id="f2969-219">Design and implementation techniques</span></span>

<span data-ttu-id="f2969-220">CPU 使用率、メモリ使用量、クラッシュ許容度、UI の応答性に対するリソース制限は、リッチ クライアント上で実行される Office アドインにのみ適用されますが、サポートするすべてのクライアントおよびデバイス上でアドインが十分なパフォーマンスを発揮するためには、これらのリソース使用量およびバッテリーの使用量を最適化することが重要になります。</span><span class="sxs-lookup"><span data-stu-id="f2969-220">While the resources limits on CPU and memory usage, crash tolerance, UI responsiveness apply to Office Add-ins running only on the rich clients, optimizing the usage of these resources and battery should be a priority if you want your add-in to perform satisfactorily on all supporting clients and devices.</span></span> <span data-ttu-id="f2969-221">アドインで長時間実行される処理があったり、大規模なデータ セットを処理したりする場合は、最適化が特に重要です。</span><span class="sxs-lookup"><span data-stu-id="f2969-221">Optimization is particularly important if your add-in carries out long-running operations or handles large data sets.</span></span> <span data-ttu-id="f2969-222">次の一覧に、CPU 負荷の高い操作を小さなチャンクに分割して、アドインが過剰なリソース消費を避け、Office アプリケーションの応答性を維持できるようにする方法を示します。</span><span class="sxs-lookup"><span data-stu-id="f2969-222">The following list suggests some techniques to break up CPU-intensive or data-intensive operations into smaller chunks so that your add-in can avoid excessive resource consumption and the Office application can remain responsive:</span></span>

- <span data-ttu-id="f2969-223">制限のないデータセットからの大量のデータをアドインで読み取る必要があるシナリオでは、テーブルからデータを読み取る場合にページ付けを適用したり、またはより小さいサイズの読み取り操作に分割して 1 回の操作で処理するデータ量を小さくし、1 回の操作ですべてのデータを読み取ることがないようにします。</span><span class="sxs-lookup"><span data-stu-id="f2969-223">In a scenario where your add-in needs to read a large volume of data from an unbounded dataset, you can apply paging when reading the data from a table, or reduce the size of data in each shorter read operation, rather than attempting to complete the read in one single operation.</span></span> <span data-ttu-id="f2969-224">この操作を行うには、グローバルオブジェクトの [setTimeout](https://developer.mozilla.org/docs/Web/API/WindowOrWorkerGlobalScope/setTimeout) メソッドを使用して、入力と出力の時間を制限します。</span><span class="sxs-lookup"><span data-stu-id="f2969-224">You can do this through the [setTimeout](https://developer.mozilla.org/docs/Web/API/WindowOrWorkerGlobalScope/setTimeout) method of the global object to limit the duration of input and output.</span></span> <span data-ttu-id="f2969-225">It also handles the data in defined chunks instead of randomly unbounded data.</span><span class="sxs-lookup"><span data-stu-id="f2969-225">It also handles the data in defined chunks instead of randomly unbounded data.</span></span> <span data-ttu-id="f2969-226">別の方法として、 [async](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/async_function) を使用して約束を処理する方法があります。</span><span class="sxs-lookup"><span data-stu-id="f2969-226">Another option is to use [async](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/async_function) to handle your Promises.</span></span>

- <span data-ttu-id="f2969-p121">アドインで CPU 使用率の高いアルゴリズムを使用して大量のデータを処理する場合は、Web Workers を使用してバックグラウンドで時間のかかるタスクを実行しつつ、フォアグラウンドで別のスクリプト (ユーザー インターフェイスへの進行状況の表示など) を実行できます。Web Workers は、ユーザー アクティビティをブロックせず、HTML ページの応答性を維持します。Web Workers の例については、「[ウェブ ワーカーの基本](https://www.html5rocks.com/tutorials/workers/basics/)」を参照してください。Web Workers API の詳細については、「[Web Workers](https://developer.mozilla.org/docs/Web/API/Web_Workers_API)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="f2969-p121">If your add-in uses a CPU-intensive algorithm to process a large volume of data, you can use web workers to perform the long-running task in the background while running a separate script in the foreground, such as displaying progress in the user interface. Web workers do not block user activities and allow the HTML page to remain responsive. For an example of web workers, see [The Basics of Web Workers](https://www.html5rocks.com/tutorials/workers/basics/). See [Web Workers](https://developer.mozilla.org/docs/Web/API/Web_Workers_API) for more information about the Web Workers API.</span></span>

- <span data-ttu-id="f2969-231">アドインで CPU 使用率の高いアルゴリズムを使用しているが、データの入出力を小さなセットに分割できる場合は、Web サービスの作成を検討します。データを Web サービスに渡して CPU の負荷をオフロードし、非同期コールバックを待機します。</span><span class="sxs-lookup"><span data-stu-id="f2969-231">If your add-in uses a CPU-intensive algorithm but you can divide the data input or output into smaller sets, consider creating a web service, passing the data to the web service to off-load the CPU, and wait for an asynchronous callback.</span></span>

- <span data-ttu-id="f2969-232">想定する最大量のデータでアドインをテストして、アドインにおける処理をその最大量までに制限します。</span><span class="sxs-lookup"><span data-stu-id="f2969-232">Test your add-in against the highest volume of data you expect, and restrict your add-in to process up to that limit.</span></span>

### <a name="performance-improvements-with-the-application-specific-apis"></a><span data-ttu-id="f2969-233">アプリケーション固有の Api によるパフォーマンスの向上</span><span class="sxs-lookup"><span data-stu-id="f2969-233">Performance improvements with the application-specific APIs</span></span>

<span data-ttu-id="f2969-234">[アプリケーション固有の api モデルを使用](../develop/application-specific-api-model.md)する際のパフォーマンスのヒントは、Excel、OneNote、Visio、および Word 用のアプリケーション固有の api を使用する際のガイダンスを提供します。</span><span class="sxs-lookup"><span data-stu-id="f2969-234">The performance tips in [Using the application-specific API model](../develop/application-specific-api-model.md) provide guidance when using the application-specific APIs for Excel, OneNote, Visio, and Word.</span></span> <span data-ttu-id="f2969-235">要約すると、次のことを行う必要があります。</span><span class="sxs-lookup"><span data-stu-id="f2969-235">In summary, you should:</span></span>

- <span data-ttu-id="f2969-236">[必要なプロパティのみを読み込む](../develop/application-specific-api-model.md#calling-load-without-parameters-not-recommended)。</span><span class="sxs-lookup"><span data-stu-id="f2969-236">[Only load necessary properties](../develop/application-specific-api-model.md#calling-load-without-parameters-not-recommended).</span></span>
- <span data-ttu-id="f2969-237">[同期 () の呼び出しの数を最小限に](../develop/application-specific-api-model.md#performance-tip-minimize-the-number-of-sync-calls)します。</span><span class="sxs-lookup"><span data-stu-id="f2969-237">[Minimize the number of sync() calls](../develop/application-specific-api-model.md#performance-tip-minimize-the-number-of-sync-calls).</span></span> <span data-ttu-id="f2969-238">「」を参照してください。コードで呼び出しを管理する方法について詳しくは [、「ループでのコンテキストの同期」メソッドの使用を避けて](correlated-objects-pattern.md) `sync` ください。</span><span class="sxs-lookup"><span data-stu-id="f2969-238">Read [Avoid using the context.sync method in loops](correlated-objects-pattern.md) for further information on how to manage `sync` calls in your code.</span></span>
- <span data-ttu-id="f2969-239">[作成するプロキシオブジェクトの数を最小限に](../develop/application-specific-api-model.md#performance-tip-minimize-the-number-of-proxy-objects-created)します。</span><span class="sxs-lookup"><span data-stu-id="f2969-239">[Minimize the number of proxy objects created](../develop/application-specific-api-model.md#performance-tip-minimize-the-number-of-proxy-objects-created).</span></span> <span data-ttu-id="f2969-240">次のセクションで説明するように、プロキシオブジェクトを不要することもできます。</span><span class="sxs-lookup"><span data-stu-id="f2969-240">You can also untrack proxy objects, as described in the next section.</span></span>

#### <a name="untrack-unneeded-proxy-objects"></a><span data-ttu-id="f2969-241">不要不要なプロキシオブジェクト</span><span class="sxs-lookup"><span data-stu-id="f2969-241">Untrack unneeded proxy objects</span></span>

<span data-ttu-id="f2969-242">[プロキシオブジェクト](../develop/application-specific-api-model.md#proxy-objects) は、が呼び出されるまでメモリ内に保持 `RequestContext.sync()` されます。</span><span class="sxs-lookup"><span data-stu-id="f2969-242">[Proxy objects](../develop/application-specific-api-model.md#proxy-objects) persist in memory until `RequestContext.sync()` is called.</span></span> <span data-ttu-id="f2969-243">大規模なバッチ操作では、アドインが 1 回のみ必要とするプロキシ オブジェクトが大量に生成されることがあります。それらのオブジェクトは、バッチの実行前にメモリから解放できます。</span><span class="sxs-lookup"><span data-stu-id="f2969-243">Large batch operations may generate a lot of proxy objects that are only needed once by the add-in and can be released from memory before the batch executes.</span></span>

<span data-ttu-id="f2969-244">メソッドは、 `untrack()` オブジェクトをメモリから解放します。</span><span class="sxs-lookup"><span data-stu-id="f2969-244">The `untrack()` method releases the object from memory.</span></span> <span data-ttu-id="f2969-245">このメソッドは、多くのアプリケーション固有の API プロキシオブジェクトに実装されています。</span><span class="sxs-lookup"><span data-stu-id="f2969-245">This method is implemented on many application-specific API proxy objects.</span></span> <span data-ttu-id="f2969-246">アドインがこのオブジェクトを使用して `untrack()` 実行された後に呼び出しを行うと、多数のプロキシオブジェクトを使用する場合のパフォーマンスが大幅に向上します。</span><span class="sxs-lookup"><span data-stu-id="f2969-246">Calling `untrack()` after your add-in is done with the object should yield a noticeable performance benefit when using large numbers of proxy objects.</span></span>

> [!NOTE]
> <span data-ttu-id="f2969-247">`Range.untrack()` は、[ClientRequestContext.trackedObjects.remove(thisRange)](/javascript/api/office/officeextension.trackedobjects#remove-object-) のショートカットです。</span><span class="sxs-lookup"><span data-stu-id="f2969-247">`Range.untrack()` is a shortcut for [ClientRequestContext.trackedObjects.remove(thisRange)](/javascript/api/office/officeextension.trackedobjects#remove-object-).</span></span> <span data-ttu-id="f2969-248">プロキシ オブジェクトは、コンテキスト内の追跡対象オブジェクト リストから削除することで追跡解除できます。</span><span class="sxs-lookup"><span data-stu-id="f2969-248">Any proxy object can be untracked by removing it from the tracked objects list in the context.</span></span>

<span data-ttu-id="f2969-249">次の Excel コードサンプルでは、一度に1つのセルを選択して、選択範囲にデータを入力します。</span><span class="sxs-lookup"><span data-stu-id="f2969-249">The following Excel code sample fills a selected range with data, one cell at a time.</span></span> <span data-ttu-id="f2969-250">セルに値が追加されると、そのセルを表している範囲の追跡が解除されます。</span><span class="sxs-lookup"><span data-stu-id="f2969-250">After the value is added to the cell, the range representing that cell is untracked.</span></span> <span data-ttu-id="f2969-251">10,000 から 20,000 個のセルの範囲を選択して、このコードを実行します。最初の実行では `cell.untrack()` の行を使用し、その後でこの行を削除して実行します。</span><span class="sxs-lookup"><span data-stu-id="f2969-251">Run this code with a selected range of 10,000 to 20,000 cells, first with the `cell.untrack()` line, and then without it.</span></span> <span data-ttu-id="f2969-252">`cell.untrack()` の行がないコードよりも、この行があるコードの方が高速になることがわかります。</span><span class="sxs-lookup"><span data-stu-id="f2969-252">You should notice the code runs faster with the `cell.untrack()` line than without it.</span></span> <span data-ttu-id="f2969-253">また、クリーンアップの手順にかかる時間が短くなるため、その後の応答時間も速くなることがわかります。</span><span class="sxs-lookup"><span data-stu-id="f2969-253">You may also notice a quicker response time afterwards, since the cleanup step takes less time.</span></span>

```js
Excel.run(async (context) => {
    var largeRange = context.workbook.getSelectedRange();
    largeRange.load(["rowCount", "columnCount"]);
    await context.sync();

    for (var i = 0; i < largeRange.rowCount; i++) {
        for (var j = 0; j < largeRange.columnCount; j++) {
            var cell = largeRange.getCell(i, j);
            cell.values = [[i *j]];

            // Call untrack() to release the range from memory.
            cell.untrack();
        }
    }

    await context.sync();
});
```

<span data-ttu-id="f2969-254">不要オブジェクトに必要なものは、何千ものものを扱っている場合にのみ重要になることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="f2969-254">Note that needing to untrack objects only becomes important when you're dealing with thousands of them.</span></span> <span data-ttu-id="f2969-255">ほとんどのアドインでは、プロキシオブジェクト追跡を管理する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="f2969-255">Most add-ins will not need to manage proxy object tracking.</span></span>

## <a name="see-also"></a><span data-ttu-id="f2969-256">関連項目</span><span class="sxs-lookup"><span data-stu-id="f2969-256">See also</span></span>

- [<span data-ttu-id="f2969-257">Office アドインのプライバシーとセキュリティ</span><span class="sxs-lookup"><span data-stu-id="f2969-257">Privacy and security for Office Add-ins</span></span>](../concepts/privacy-and-security.md)
- [<span data-ttu-id="f2969-258">Outlook アドインのアクティブ化と JavaScript API の制限</span><span class="sxs-lookup"><span data-stu-id="f2969-258">Limits for activation and JavaScript API for Outlook add-ins</span></span>](../outlook/limits-for-activation-and-javascript-api-for-outlook-add-ins.md)
- [<span data-ttu-id="f2969-259">Excel の JavaScript API を使用した、パフォーマンスの最適化</span><span class="sxs-lookup"><span data-stu-id="f2969-259">Performance optimization using the Excel JavaScript API</span></span>](../excel/performance.md)
