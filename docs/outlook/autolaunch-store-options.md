---
title: イベント ベースの Outlook アドインの AppSource 登録情報オプション
description: イベント ベースのアクティブ化を実装する Outlook アドインで使用できる AppSource 登録情報オプションについて説明します。
ms.topic: article
ms.date: 10/13/2022
ms.localizationpriority: medium
ms.openlocfilehash: b8908fde484186fdb9bea9cda4520358278712f6
ms.sourcegitcommit: d402c37fc3388bd38761fedf203a7d10fce4e899
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/21/2022
ms.locfileid: "68664666"
---
# <a name="appsource-listing-options-for-your-event-based-outlook-add-in"></a>イベント ベースの Outlook アドインの AppSource 登録情報オプション

エンド ユーザーが [イベント ベースのアクティブ化](autolaunch.md) 機能にアクセスするには、組織の管理者がアドインを展開する必要があります。 イベント ベースのアクティブ化は、エンド ユーザーが [AppSource](https://appsource.microsoft.com) からアドインを直接取得した場合に制限されます。 たとえば、Contoso アドインにイベント ベースの関数が含まれている場合、アドインの自動呼び出しは、アドインが組織の管理者によってエンド ユーザーにインストールされた場合にのみ発生します。それ以外の場合、アドインの自動呼び出しはブロックされます。

エンド ユーザーまたは管理者は、AppSource またはアプリ内 Office ストアを通じてアドインを取得できます。 アドインの主要なシナリオまたはワークフローでイベント ベースのアクティブ化が必要な場合は、アドインを管理者の展開のみに制限できます。 この制限を有効にするために、AppSource でアドインのフライト コード URL を指定できます。 フライト コードにより、これらの特別な URL を持つエンド ユーザーのみが登録情報にアクセスできます。 URL の例を次に示します。

`https://appsource.microsoft.com/product/office/WA200002862?flightCodes=EventBasedTest1`

フライト コードが有効になっている場合、ユーザーと管理者は、AppSource またはアプリ内 Office ストアでその名前でアドインを明示的に検索することはできません。 アドインの作成者は、これらのフライト コードを組織の管理者と非公開で共有してアドインの展開を行うことができます。

> [!NOTE]
> エンド ユーザーはフライト コードを使用してアドインをインストールできますが、アドインにはイベント ベースのアクティブ化は含まれません。

[!INCLUDE [outlook-smart-alerts-deployment](../includes/outlook-smart-alerts-deployment.md)]

## <a name="specify-a-flight-code"></a>フライト コードを指定する

アドインのフライト コードを指定するには、アドインを発行するときに、 **認定に関するメモ** でコードを共有します。 **重要**: フライト コードでは大文字と小文字が区別されます。

![発行プロセス中の [認定に関するメモ] 画面のフライト コードのサンプル要求。](../images/outlook-publish-notes-for-certification.png)

## <a name="deploy-add-in-with-flight-code"></a>フライト コードを使用してアドインをデプロイする

フライト コードが設定されると、アプリ認定チームから URL を受け取ります。 その後、管理者と URL を非公開で共有できます。

アドインを展開するには、管理者は次の手順を使用できます。

- Microsoft 365 管理者アカウントで admin.microsoft.com または AppSource.com にサインインします。 アドインでシングル サインオン (SSO) が有効になっている場合は、グローバル管理者の資格情報が必要です。
- フライト コード URL を Web ブラウザーで開きます。
- アドインの一覧ページで、[ **今すぐ入手**] を選択します。 統合アプリ ポータルにリダイレクトする必要があります。

## <a name="unrestricted-appsource-listing"></a>無制限の AppSource の一覧

アドインが重要なシナリオにイベント ベースのアクティブ化を使用しない場合 (つまり、アドインは自動呼び出しなしで正常に動作します)、特別なフライト コードなしで AppSource にアドインを一覧表示することを検討してください。 エンド ユーザーが AppSource からアドインを取得した場合、ユーザーに対して自動アクティブ化は行われません。 ただし、作業ウィンドウや関数コマンドなど、アドインの他のコンポーネントを使用できます。

> [!IMPORTANT]
> これは一時的な制限です。 今後、アドインを直接取得するエンド ユーザーに対して、イベント ベースのアドインのアクティブ化を有効にする予定です。

## <a name="update-existing-add-ins-to-include-event-based-activation"></a>イベント ベースのアクティブ化を含むように既存のアドインを更新する

既存のアドインを更新してイベント ベースのアクティブ化を含め、検証のために再送信し、制限付き AppSource リストと無制限の AppSource リストのどちらを使用するかを決定できます。

更新されたアドインが承認されると、以前にアドインを展開した組織の管理者は、管理センターの **[統合アプリ** ] セクションに更新メッセージを受け取ります。 メッセージは、イベント ベースのアクティブ化の変更について管理者に通知します。 管理者が変更を受け入れると、更新プログラムがエンド ユーザーに展開されます。

![[統合アプリ] 画面のアプリ更新通知。](../images/outlook-deploy-update-notification.png)

アドインを自分でインストールしたエンド ユーザーの場合、イベント ベースのアクティブ化機能は、アドインが更新された後でも機能しません。

## <a name="admin-consent-for-installing-event-based-add-ins"></a>イベント ベースのアドインをインストールするための同意を管理する

**[統合アプリ**] 画面からイベント ベースのアドインが展開されるたびに、管理者は展開ウィザードでアドインのイベント ベースのアクティブ化機能に関する詳細を取得します。 詳細は、[アプリの **アクセス許可と機能] セクションに** 表示されます。 管理者には、アドインが自動的にアクティブ化できるすべてのイベントが表示されます。

![新しいアプリをデプロイするときに、[アクセス許可要求を受け入れる] 画面。](../images/outlook-deploy-accept-permissions-requests.png)

同様に、既存のアドインがイベント ベースの機能に更新されると、管理者はアドインに "Update Pending" 状態を表示します。 更新されたアドインは、[ **アプリのアクセス許可と機能** ] セクションに記載されている変更 (アドインが自動的にアクティブ化できるイベントのセットなど) に管理者が同意した場合にのみデプロイされます。

新しいイベント ベースのアクティブ化機能をアドインに追加するたびに、管理者は管理ポータルに更新フローを表示し、追加のイベントに同意する必要があります。

![更新されたアプリをデプロイするときの "更新" フロー。](../images/outlook-deploy-update-flow.png)

## <a name="see-also"></a>関連項目

- [イベント ベースのアクティブ化のために Outlook アドインを構成する](autolaunch.md)
