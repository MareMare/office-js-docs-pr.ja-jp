---
title: Outlook アドインで日付値を処理する
description: JavaScript API Office JavaScript Date オブジェクトは、ほとんどの日付と時刻の格納および取得に使用されます。
ms.date: 10/31/2019
localization_priority: Normal
ms.openlocfilehash: 0ad4aac4653c5f1b303573ea75a43f6e715ef20e
ms.sourcegitcommit: 883f71d395b19ccfc6874a0d5942a7016eb49e2c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/09/2021
ms.locfileid: "53348462"
---
# <a name="tips-for-handling-date-values-in-outlook-add-ins"></a><span data-ttu-id="8f473-103">Outlook アドインで日付値を処理するためのヒント</span><span class="sxs-lookup"><span data-stu-id="8f473-103">Tips for handling date values in Outlook add-ins</span></span>

<span data-ttu-id="8f473-104">JavaScript API Office JavaScript [Date](https://www.w3schools.com/jsref/jsref_obj_date.asp)オブジェクトを使用して、ほとんどの記憶域と日付と時刻の取得を行います。</span><span class="sxs-lookup"><span data-stu-id="8f473-104">The Office JavaScript API uses the JavaScript [Date](https://www.w3schools.com/jsref/jsref_obj_date.asp) object for most of the storage and retrieval of dates and times.</span></span> 

<span data-ttu-id="8f473-105">`Date`このオブジェクトは、getUTCDate、getUTCHour、getUTCMinutes、toUTCString[](https://www.w3schools.com/jsref/jsref_toutcstring.asp)[](https://www.w3schools.com/jsref/jsref_getutcdate.asp)[](https://www.w3schools.com/jsref/jsref_getutchours.asp)などのメソッドを提供し、要求された日付または時刻の値をユニバーサル座標時刻 (UTC)[](https://www.w3schools.com/jsref/jsref_getutcminutes.asp)時刻に従って返します。</span><span class="sxs-lookup"><span data-stu-id="8f473-105">That `Date` object provides methods such as [getUTCDate](https://www.w3schools.com/jsref/jsref_getutcdate.asp), [getUTCHour](https://www.w3schools.com/jsref/jsref_getutchours.asp), [getUTCMinutes](https://www.w3schools.com/jsref/jsref_getutcminutes.asp), and [toUTCString](https://www.w3schools.com/jsref/jsref_toutcstring.asp), which return the requested date or time value according to Universal Coordinated Time (UTC) time.</span></span>

<span data-ttu-id="8f473-106">オブジェクト `Date` には、getDate、getHour、getMinutes、toString[](https://www.w3schools.com/jsref/jsref_tostring_date.asp)[](https://www.w3schools.com/jsref/jsref_getminutes.asp)[](https://www.w3schools.com/jsref/jsref_getutcdate.asp)などの他のメソッドも用意されています。このメソッドは、要求された日付または時刻を "ローカル時刻" に従って返します。 [](https://www.w3schools.com/jsref/jsref_getutchours.asp)</span><span class="sxs-lookup"><span data-stu-id="8f473-106">The `Date` object also provides other methods such as [getDate](https://www.w3schools.com/jsref/jsref_getutcdate.asp), [getHour](https://www.w3schools.com/jsref/jsref_getutchours.asp), [getMinutes](https://www.w3schools.com/jsref/jsref_getminutes.asp), and [toString](https://www.w3schools.com/jsref/jsref_tostring_date.asp), which return the requested date or time according to "local time".</span></span>

<span data-ttu-id="8f473-107">"現地時刻" の概念は、主にクライアント コンピューター上のブラウザーおよびオペレーティング システムによって判断されます。</span><span class="sxs-lookup"><span data-stu-id="8f473-107">The concept of "local time" is largely determined by the browser and operating system on the client computer.</span></span> <span data-ttu-id="8f473-108">たとえば、Windows ベースのクライアント コンピューターで実行されているほとんどのブラウザーでは、JavaScript の呼び出しは、クライアント コンピューターの Windows で設定されたタイム ゾーンに基 `getDate` づいて日付を返します。</span><span class="sxs-lookup"><span data-stu-id="8f473-108">For instance, on most browsers running on a Windows-based client computer, a JavaScript call to `getDate`, returns a date based on the time zone set in Windows on the client computer.</span></span>

<span data-ttu-id="8f473-109">次の例では、ローカル時間にオブジェクトを作成し、その日付を UTC の日付文字列に変換 `Date` `myLocalDate` `toUTCString` する呼び出しを行います。</span><span class="sxs-lookup"><span data-stu-id="8f473-109">The following example creates a `Date` object `myLocalDate` in local time, and calls `toUTCString` to convert that date to a date string in UTC.</span></span>

```js
// Create and get the current date represented 
// in the client computer time zone.
var myLocalDate = new Date (); 

// Convert the Date value in the client computer time zone
// to a date string in UTC, and display the string.
document.write ("The current UTC time is " + 
    myLocalDate.toUTCString());
```

<span data-ttu-id="8f473-110">JavaScript オブジェクトを使用して、UTC またはクライアント コンピューターのタイム ゾーンに基づいて日付または時刻の値を取得することができますが `Date` **、Date** オブジェクトは 1 つの点で制限されます。他の特定のタイム ゾーンの日付または時刻の値を返すメソッドは提供されません。</span><span class="sxs-lookup"><span data-stu-id="8f473-110">While you can use the JavaScript `Date` object to get a date or time value based on UTC or the client computer time zone, the **Date** object is limited in one respect - it does not provide methods to return a date or time value for any other specific time zone.</span></span> <span data-ttu-id="8f473-111">たとえば、クライアント コンピューターが東部標準時 (EST) に設定されている場合、太平洋標準時 (PST) などの EST または UTC 以外の時間値を取得できるメソッドはありません `Date` 。</span><span class="sxs-lookup"><span data-stu-id="8f473-111">For example, if your client computer is set to be on Eastern Standard Time (EST), there is no `Date` method that allows you to get the hour value other than in EST or UTC, such as Pacific Standard Time (PST).</span></span>


## <a name="date-related-features-for-outlook-add-ins"></a><span data-ttu-id="8f473-112">Outlook アドインの日付関連機能</span><span class="sxs-lookup"><span data-stu-id="8f473-112">Date-related features for Outlook add-ins</span></span>

<span data-ttu-id="8f473-113">前述の JavaScript の制限は、Office JavaScript API を使用して、Outlook リッチ クライアント、および Outlook on the web またはモバイル デバイスで実行される Outlook アドインの日付または時刻の値を処理する場合に影響を与えます。</span><span class="sxs-lookup"><span data-stu-id="8f473-113">The aforementioned JavaScript limitation has an implication for you, when you use the Office JavaScript API to handle date or time values in Outlook add-ins that run in an Outlook rich client, and in Outlook on the web or mobile devices.</span></span>


### <a name="time-zones-for-outlook-clients"></a><span data-ttu-id="8f473-114">Outlook クライアントのタイム ゾーン</span><span class="sxs-lookup"><span data-stu-id="8f473-114">Time zones for Outlook clients</span></span>

<span data-ttu-id="8f473-115">わかりやすくするため、問題のタイム ゾーンを定義します。</span><span class="sxs-lookup"><span data-stu-id="8f473-115">For clarity, let's define the time zones in question.</span></span>

|<span data-ttu-id="8f473-116">**タイム ゾーン**</span><span class="sxs-lookup"><span data-stu-id="8f473-116">**Time zone**</span></span>|<span data-ttu-id="8f473-117">**説明**</span><span class="sxs-lookup"><span data-stu-id="8f473-117">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="8f473-118">クライアント コンピューターのタイム ゾーン</span><span class="sxs-lookup"><span data-stu-id="8f473-118">Client computer time zone</span></span>|<span data-ttu-id="8f473-119">これは、クライアント コンピューターのオペレーティング システムで設定されています。</span><span class="sxs-lookup"><span data-stu-id="8f473-119">This is set on the operating system of the client computer.</span></span> <span data-ttu-id="8f473-120">ほとんどのブラウザーでは、クライアント コンピューターのタイム ゾーンを使用して、JavaScript オブジェクトの日付または時刻の値を表示 `Date` します。</span><span class="sxs-lookup"><span data-stu-id="8f473-120">Most browsers use the client computer time zone to display date or time values of the JavaScript `Date` object.</span></span><br/><br/><span data-ttu-id="8f473-121">Outlook リッチ クライアントでは、このタイム ゾーンを使用して、ユーザー インターフェイスの日付または時刻の値を表示します。</span><span class="sxs-lookup"><span data-stu-id="8f473-121">An Outlook rich client uses this time zone to display date or time values in the user interface.</span></span> <br/><br/><span data-ttu-id="8f473-122">たとえば、Windows を実行しているクライアント コンピューター上の Outlook では、Windows 上で設定されているタイム ゾーンをローカル タイム ゾーンとして使用します。</span><span class="sxs-lookup"><span data-stu-id="8f473-122">For example, on a client computer running Windows, Outlook uses the time zone set on Windows as the local time zone.</span></span> <span data-ttu-id="8f473-123">Mac では、ユーザーがクライアント コンピューターのタイム ゾーンを変更した場合、mac の Outlook でタイム ゾーンを更新するように求めるメッセージが表示Outlookされます。</span><span class="sxs-lookup"><span data-stu-id="8f473-123">On the Mac, if the user changes the time zone on the client computer, Outlook on Mac would prompt the user to update the time zone in Outlook as well.</span></span>|
|<span data-ttu-id="8f473-124">Exchange 管理センター (EAC) のタイム ゾーン</span><span class="sxs-lookup"><span data-stu-id="8f473-124">Exchange Admin Center (EAC) time zone</span></span>|<span data-ttu-id="8f473-125">ユーザーが初めてユーザーまたはモバイル デバイスにログオンするときに、このタイム ゾーン値 (および優先言語) を設定Outlook on the webユーザーが設定します。</span><span class="sxs-lookup"><span data-stu-id="8f473-125">The user sets this time zone value (and the preferred language) when he or she logs on to Outlook on the web or mobile devices the first time.</span></span> <br/><br/><span data-ttu-id="8f473-126">Outlook on the webモバイル デバイスは、このタイム ゾーンを使用して、ユーザー インターフェイスに日付または時刻の値を表示します。</span><span class="sxs-lookup"><span data-stu-id="8f473-126">Outlook on the web and mobile devices use this time zone to display date or time values in the user interface.</span></span>|

<span data-ttu-id="8f473-127">Outlook リッチ クライアントはクライアント コンピューターのタイム ゾーンを使用し、Outlook on the web とモバイル デバイスのユーザー インターフェイスは EAC タイム ゾーンを使用します。Outlook リッチ クライアントと Outlook on the web またはモバイル デバイスで実行すると、同じメールボックスにインストールされている同じアドインのローカル時間が異なる場合があります。</span><span class="sxs-lookup"><span data-stu-id="8f473-127">Because an Outlook rich client uses the client computer time zone, and the user interface of Outlook on the web and mobile devices uses the EAC time zone, the local time for the same add-in installed for the same mailbox can be different when running in an Outlook rich client and in Outlook on the web or mobile devices.</span></span> <span data-ttu-id="8f473-128">Outlook アドイン開発者は日付の値を適切に入力して出力し、その値が、ユーザーから対応するクライアントに求められるタイム ゾーンと常に一致するようにする必要があります。</span><span class="sxs-lookup"><span data-stu-id="8f473-128">As an Outlook add-in developer, you should appropriately input and output date values so that those values are always consistent with the time zone that the user expects on the corresponding client.</span></span>


### <a name="date-related-api"></a><span data-ttu-id="8f473-129">日付関連の API</span><span class="sxs-lookup"><span data-stu-id="8f473-129">Date-related API</span></span>

<span data-ttu-id="8f473-130">日付関連の機能をサポートする JavaScript API Officeプロパティとメソッドを次に示します。</span><span class="sxs-lookup"><span data-stu-id="8f473-130">The following are the properties and methods in the Office JavaScript API that support date-related features.</span></span>

|<span data-ttu-id="8f473-131">API メンバー</span><span class="sxs-lookup"><span data-stu-id="8f473-131">API member</span></span>|<span data-ttu-id="8f473-132">タイム ゾーン表現</span><span class="sxs-lookup"><span data-stu-id="8f473-132">Time zone representation</span></span>|<span data-ttu-id="8f473-133">Outlook リッチ クライアントの例</span><span class="sxs-lookup"><span data-stu-id="8f473-133">Example in an Outlook rich client</span></span>|<span data-ttu-id="8f473-134">モバイル デバイスOutlook on the web例</span><span class="sxs-lookup"><span data-stu-id="8f473-134">Example in Outlook on the web or mobile devices</span></span>|
|--------------|----------------------------|-------------------------------------|-------------------|
|[<span data-ttu-id="8f473-135">Office.context.mailbox.userProfile.timeZone</span><span class="sxs-lookup"><span data-stu-id="8f473-135">Office.context.mailbox.userProfile.timeZone</span></span>](/javascript/api/outlook/office.userprofile?view=outlook-js-preview&preserve-view=true#timezone)|<span data-ttu-id="8f473-136">Outlook リッチ クライアントでは、このプロパティはクライアント コンピューターのタイム ゾーンを返します。</span><span class="sxs-lookup"><span data-stu-id="8f473-136">In an Outlook rich client, this property returns the client computer time zone.</span></span> <span data-ttu-id="8f473-137">モバイル Outlook on the webでは、このプロパティは EAC タイム ゾーンを返します。</span><span class="sxs-lookup"><span data-stu-id="8f473-137">In Outlook on the web and mobile devices, this property returns the EAC time zone.</span></span> |<span data-ttu-id="8f473-138">EST</span><span class="sxs-lookup"><span data-stu-id="8f473-138">EST</span></span>|<span data-ttu-id="8f473-139">PST</span><span class="sxs-lookup"><span data-stu-id="8f473-139">PST</span></span>|
|<span data-ttu-id="8f473-140">[Office.context.mailbox.item.dateTimeCreated](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties) および [Office.context.mailbox.item.dateTimeModified](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties)</span><span class="sxs-lookup"><span data-stu-id="8f473-140">[Office.context.mailbox.item.dateTimeCreated](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties) and [Office.context.mailbox.item.dateTimeModified](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties)</span></span>|<span data-ttu-id="8f473-141">これらの各プロパティは、JavaScript オブジェクトを返 `Date` します。</span><span class="sxs-lookup"><span data-stu-id="8f473-141">Each of these properties returns a JavaScript `Date` object.</span></span> <span data-ttu-id="8f473-142">次の例に示すように、この値は UTC が正しく、リッチ クライアント、Outlook、モバイル デバイスOutlook on the web `Date` `myUTCDate` 同じです。</span><span class="sxs-lookup"><span data-stu-id="8f473-142">This `Date` value is UTC-correct, as shown in the following example - `myUTCDate` has the same value in an Outlook rich client, Outlook on the web and mobile devices.</span></span><br/><br/>`var myDate = Office.mailbox.item.dateTimeCreated;`<br/>`var myUTCDate = myDate.getUTCDate;`<br/><br/><span data-ttu-id="8f473-143">ただし、呼び出しはクライアント コンピューターのタイム ゾーンの日付値を返します。これは、Outlook リッチ クライアント インターフェイスで日付時刻の値を表示するために使用されるタイム ゾーンと一致しますが、Outlook on the web とモバイル デバイスがユーザー インターフェイスで使用する EAC タイム ゾーンとは異なる場合があります。 `myDate.getDate`</span><span class="sxs-lookup"><span data-stu-id="8f473-143">However, calling  `myDate.getDate` returns a date value in the client computer time zone, which is consistent with the time zone used to display date times values in the Outlook rich client interface, but may be different from the EAC time zone that Outlook on the web and mobile devices use in its user interface.</span></span>|<span data-ttu-id="8f473-144">アイテムが午前 9 時 (UTC) に作成された場合:</span><span class="sxs-lookup"><span data-stu-id="8f473-144">If the item is created at 9am UTC:</span></span><br/><br/>`Office.mailbox.item.`<br/><span data-ttu-id="8f473-145">`dateTimeCreated.getHours` は、午前 4 時 (EST) を返します。</span><span class="sxs-lookup"><span data-stu-id="8f473-145">`dateTimeCreated.getHours` returns 4am EST.</span></span><br/><br/><span data-ttu-id="8f473-146">アイテムが午前 11 時 (UTC) に変更された場合:</span><span class="sxs-lookup"><span data-stu-id="8f473-146">If the item is modified at 11am UTC:</span></span><br/><br/>`Office.mailbox.item.`<br/><span data-ttu-id="8f473-147">`dateTimeModified.getHours` は、午前 6 時 (EST) を返します。</span><span class="sxs-lookup"><span data-stu-id="8f473-147">`dateTimeModified.getHours` returns 6am EST.</span></span>|<span data-ttu-id="8f473-148">アイテムの作成時刻が午前 9 時 (UTC) の場合:</span><span class="sxs-lookup"><span data-stu-id="8f473-148">If the item creation time is 9am UTC:</span></span><br/><br/>`Office.mailbox.item.`</br><span data-ttu-id="8f473-149">`dateTimeCreated.getHours` は、午前 4 時 (EST) を返します。</span><span class="sxs-lookup"><span data-stu-id="8f473-149">`dateTimeCreated.getHours` returns 4am EST.</span></span><br/><br/><span data-ttu-id="8f473-150">アイテムが午前 11 時 (UTC) に変更された場合:</span><span class="sxs-lookup"><span data-stu-id="8f473-150">If the item is modified at 11am UTC:</span></span><br/><br/>`Office.mailbox.item.`</br><span data-ttu-id="8f473-151">`dateTimeModified.getHours` は、午前 6 時 (EST) を返します。</span><span class="sxs-lookup"><span data-stu-id="8f473-151">`dateTimeModified.getHours` returns 6am EST.</span></span><br/><br/><span data-ttu-id="8f473-152">ユーザー インターフェイスで作成時刻や変更時刻を表示する場合は、まず時刻を PST に変換して、他のユーザー インターフェイスと一貫性を保つようにします。</span><span class="sxs-lookup"><span data-stu-id="8f473-152">Notice that if you want to display the creation or modification time in the user interface, you would want to first convert the time to PST to be consistent with the rest of the user interface.</span></span>|
|[<span data-ttu-id="8f473-153">Office.context.mailbox.displayNewAppointmentForm</span><span class="sxs-lookup"><span data-stu-id="8f473-153">Office.context.mailbox.displayNewAppointmentForm</span></span>](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods)|<span data-ttu-id="8f473-154">各 Start パラメーター  _と End_ パラメーター _には_ JavaScript オブジェクトが必要 `Date` です。</span><span class="sxs-lookup"><span data-stu-id="8f473-154">Each of the  _Start_ and _End_ parameters requires a JavaScript `Date` object.</span></span> <span data-ttu-id="8f473-155">引数は、Outlook リッチ クライアントまたはモバイル デバイスのユーザー インターフェイスで使用されるタイム ゾーンに関係なく、UTC Outlook on the webする必要があります。</span><span class="sxs-lookup"><span data-stu-id="8f473-155">The arguments should be UTC-correct regardless of the time zone used in the user interface of an Outlook rich client, or Outlook on the web or mobile devices.</span></span>|<span data-ttu-id="8f473-156">予定フォームの開始時刻と終了時刻が午前 9 時 (UTC) と午前 11 時 (UTC) の場合、`start` と `end` の引数は正しい UTC 時刻である必要があります。つまり、</span><span class="sxs-lookup"><span data-stu-id="8f473-156">If the start and end times for the appointment form are 9am UTC and 11am UTC, then you should assure that the `start` and `end` arguments are UTC-correct, which means:</span></span><br/><br/><ul><li><span data-ttu-id="8f473-157">`start.getUTCHours` は午前 9 時 (UTC) を返します。</span><span class="sxs-lookup"><span data-stu-id="8f473-157">`start.getUTCHours` returns 9am UTC</span></span></li><li><span data-ttu-id="8f473-158">`end.getUTCHours` は午前 11 時 (UTC) を返します。</span><span class="sxs-lookup"><span data-stu-id="8f473-158">`end.getUTCHours` returns 11am UTC</span></span></li></ul>|<span data-ttu-id="8f473-159">予定フォームの開始時刻と終了時刻が午前 9 時 (UTC) と午前 11 時 (UTC) の場合、`start` と `end` の引数は正しい UTC 時刻である必要があります。つまり、</span><span class="sxs-lookup"><span data-stu-id="8f473-159">If the start and end times for the appointment form are 9am UTC and 11am UTC, then you should assure that the `start` and `end` arguments are UTC-correct, which means:</span></span><br/><br/><ul><li><span data-ttu-id="8f473-160">`start.getUTCHours` は午前 9 時 (UTC) を返します。</span><span class="sxs-lookup"><span data-stu-id="8f473-160">`start.getUTCHours` returns 9am UTC</span></span></li><li><span data-ttu-id="8f473-161">`end.getUTCHours` は午前 11 時 (UTC) を返します。</span><span class="sxs-lookup"><span data-stu-id="8f473-161">`end.getUTCHours` returns 11am UTC</span></span></li></ul>|

## <a name="helper-methods-for-date-related-scenarios"></a><span data-ttu-id="8f473-162">日付関連のシナリオ向けのヘルパー メソッド</span><span class="sxs-lookup"><span data-stu-id="8f473-162">Helper methods for date-related scenarios</span></span>


<span data-ttu-id="8f473-163">前のセクションで説明したように、Outlook on the web またはモバイル デバイスのユーザーの "現地時間" は Outlook リッチ クライアントで異なる場合がありますが、JavaScript **Date** オブジェクトはクライアント コンピューターのタイム ゾーンまたは UTC への変換のみをサポートします。Office JavaScript API には [、Office.context.mailbox.convertToLocalClientTime](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods)と [Office.context.mailbox.convertToUtcTime](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods)という 2 つのヘルパー メソッドが提供されています。</span><span class="sxs-lookup"><span data-stu-id="8f473-163">As described in the preceding sections, because the "local time" for a user in Outlook on the web or mobile devices can be different on an Outlook rich client, but the JavaScript **Date** object supports converting to only the client computer time zone or UTC, the Office JavaScript API provides two helper methods: [Office.context.mailbox.convertToLocalClientTime](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods) and [Office.context.mailbox.convertToUtcClientTime](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods).</span></span>

<span data-ttu-id="8f473-164">これらのヘルパー メソッドは、Outlook リッチ クライアント、Outlook on the web、およびモバイル デバイスで、次の 2 つの日付関連のシナリオで日付または時刻を異なる方法で処理する必要がある場合に対応するため、アドインの異なるクライアントに対して "書き込み 1 回" を強化します。</span><span class="sxs-lookup"><span data-stu-id="8f473-164">These helper methods take care of any need to handle date or time differently for the following two date-related scenarios, in an Outlook rich client, Outlook on the web and mobile devices, thus reinforcing "write-once" for different clients of your add-in.</span></span>


### <a name="scenario-a-displaying-item-creation-or-modified-time"></a><span data-ttu-id="8f473-165">シナリオ A: アイテムの作成時刻または変更時刻の表示</span><span class="sxs-lookup"><span data-stu-id="8f473-165">Scenario A: Displaying item creation or modified time</span></span>

<span data-ttu-id="8f473-166">ユーザー インターフェイスでアイテムの作成時間 ( ) または変更時刻 ( ) を表示する場合は、まず、これらのプロパティによって提供されるオブジェクトを変換して、適切な現地時間で辞書表現を `Item.dateTimeCreated` `Item.dateTimeModified` 取得します `convertToLocalClientTime` `Date` 。</span><span class="sxs-lookup"><span data-stu-id="8f473-166">If you are displaying the item creation time (`Item.dateTimeCreated`) or modification time (`Item.dateTimeModified`in the user interface, first use `convertToLocalClientTime` to convert the `Date` object provided by these properties to obtain a dictionary representation in the appropriate local time.</span></span> <span data-ttu-id="8f473-167">その後、辞書の日付部分を表示します。</span><span class="sxs-lookup"><span data-stu-id="8f473-167">Then display the parts of the dictionary date.</span></span> <span data-ttu-id="8f473-168">このシナリオの例を次に示します。</span><span class="sxs-lookup"><span data-stu-id="8f473-168">The following is an example of this scenario.</span></span>


```js
// This date is UTC-correct.
var myDate = Office.context.mailbox.item.dateTimeCreated;

// Call helper method to get date in dictionary format, 
// represented in the appropriate local time.
// In an Outlook rich client, this is dictionary format 
// in client computer time zone.
// In Outlook on the web or mobile devices, this dictionary 
// format is in EAC time zone.
var myLocalDictionaryDate = Office.context.mailbox.convertToLocalClientTime(myDate);

// Display different parts of the dictionary date.
document.write ("The item was created at " + myLocalDictionaryDate["hours"] + 
    ":" + myLocalDictionaryDate["minutes"]);)
```

<span data-ttu-id="8f473-169">リッチ クライアントとモバイル デバイスの違いOutlook `convertToLocalClientTime` 注意Outlook on the web注意してください。</span><span class="sxs-lookup"><span data-stu-id="8f473-169">Note that `convertToLocalClientTime` takes care of the difference between an Outlook rich client, and Outlook on the web or mobile devices:</span></span>


- <span data-ttu-id="8f473-170">現在のアプリケーションがリッチ クライアントである場合、このメソッドは、リッチ クライアント ユーザー インターフェイスの残りの部分と一致する、同じクライアント コンピュータータイム ゾーン内の辞書表現に表現を `convertToLocalClientTime` `Date` 変換します。</span><span class="sxs-lookup"><span data-stu-id="8f473-170">If `convertToLocalClientTime` detects the current application is a rich client, the method converts the `Date` representation to a dictionary representation in the same client computer time zone, consistent with the rest of the rich client user interface.</span></span>
    
- <span data-ttu-id="8f473-171">現在のアプリケーションが Outlook on the web またはモバイル デバイスである場合、このメソッドは UTC 正しい表現を `convertToLocalClientTime` EAC タイム ゾーンの辞書形式に変換し、Outlook on the web またはモバイル デバイスの他のユーザー インターフェイスと一致します。 `Date`</span><span class="sxs-lookup"><span data-stu-id="8f473-171">If `convertToLocalClientTime` detects the current application is Outlook on the web or mobile devices, the method converts the UTC-correct `Date` representation to a dictionary format in the EAC time zone, consistent with the rest of the Outlook on the web or mobile devices user interface.</span></span>
    

### <a name="scenario-b-displaying-start-and-end-dates-in-a-new-appointment-form"></a><span data-ttu-id="8f473-172">シナリオ B: 新しい予定フォームの開始日付と終了日付の表示</span><span class="sxs-lookup"><span data-stu-id="8f473-172">Scenario B: Displaying start and end dates in a new appointment form</span></span>

<span data-ttu-id="8f473-173">現地時間で表される日付と時刻の値の異なる部分を入力として取得し、この辞書入力値を予定フォームの開始時刻または終了時刻として指定する場合は、まずヘルパー メソッドを使用して辞書値を UTC 正しいオブジェクトに変換します。 `convertToUtcClientTime` `Date`</span><span class="sxs-lookup"><span data-stu-id="8f473-173">If you are obtaining as input different parts of a date-time value represented in the local time, and would like to provide this dictionary input value as a start or end time in an appointment form, first use the `convertToUtcClientTime` helper method to convert the dictionary value to a UTC-correct `Date` object.</span></span>

<span data-ttu-id="8f473-174">次の例では、`myLocalDictionaryStartDate` および `myLocalDictionaryEndDate` をユーザーから取得した辞書形式の日付と時刻の値と仮定しています。</span><span class="sxs-lookup"><span data-stu-id="8f473-174">In the following example, assume  `myLocalDictionaryStartDate` and `myLocalDictionaryEndDate` are date-time values in dictionary format that you have obtained from the user.</span></span> <span data-ttu-id="8f473-175">これらの値は、クライアント プラットフォームに依存する現地時間に基づいて設定されます。</span><span class="sxs-lookup"><span data-stu-id="8f473-175">These values are based on the local time, dependent on the client platform.</span></span>

```js
var myUTCCorrectStartDate = Office.context.mailbox.convertToUtcClientTime(myLocalDictionaryStartDate);
var myUTCCorrectEndDate = Office.context.mailbox.convertToUtcClientTime(myLocalDictionaryEndDate);

```

<span data-ttu-id="8f473-176">出力結果の値 `myUTCCorrectStartDate` と `myUTCCorrectEndDate` は、正しい UTC です。</span><span class="sxs-lookup"><span data-stu-id="8f473-176">The resultant values,  `myUTCCorrectStartDate` and `myUTCCorrectEndDate`, are UTC-correct.</span></span> <span data-ttu-id="8f473-177">次に、これらのオブジェクトをメソッドの Start パラメーターと End パラメーターの引数として渡して、新 `Date` しい予定 `Mailbox.displayNewAppointmentForm` フォームを表示します。</span><span class="sxs-lookup"><span data-stu-id="8f473-177">Then pass these `Date` objects as arguments for the _Start_ and _End_ parameters of the `Mailbox.displayNewAppointmentForm` method to display the new appointment form.</span></span>

<span data-ttu-id="8f473-178">リッチ クライアントとモバイル デバイスの違いOutlook `convertToUtcClientTime` 注意Outlook on the web注意してください。</span><span class="sxs-lookup"><span data-stu-id="8f473-178">Note that `convertToUtcClientTime` takes care of the difference between an Outlook rich client, and Outlook on the web or mobile devices:</span></span>


- <span data-ttu-id="8f473-179">現在のアプリケーションがリッチ クライアントOutlook検出した場合、メソッドは単に辞書表現を `convertToUtcClientTime` オブジェクトに変換 `Date` します。</span><span class="sxs-lookup"><span data-stu-id="8f473-179">If `convertToUtcClientTime` detects the current application is an Outlook rich client, the method simply converts the dictionary representation to a `Date` object.</span></span> <span data-ttu-id="8f473-180">この `Date` オブジェクトは UTC で正しく、予期される値です `displayNewAppointmentForm` 。</span><span class="sxs-lookup"><span data-stu-id="8f473-180">This `Date` object is UTC-correct, as expected by `displayNewAppointmentForm`.</span></span>
    
- <span data-ttu-id="8f473-181">現在のアプリケーションが Outlook on the web またはモバイル デバイスである場合、このメソッドは EAC タイム ゾーンで表される日付と時刻の値の辞書形式をオブジェクト `convertToUtcClientTime` に変換 `Date` します。</span><span class="sxs-lookup"><span data-stu-id="8f473-181">If `convertToUtcClientTime` detects the current application is Outlook on the web or mobile devices, the method converts the dictionary format of the date and time values expressed in the EAC time zone to a `Date` object.</span></span> <span data-ttu-id="8f473-182">この `Date` オブジェクトは UTC で正しく、予期される値です `displayNewAppointmentForm` 。</span><span class="sxs-lookup"><span data-stu-id="8f473-182">This `Date` object is UTC-correct, as expected by `displayNewAppointmentForm`.</span></span>
    
## <a name="see-also"></a><span data-ttu-id="8f473-183">関連項目</span><span class="sxs-lookup"><span data-stu-id="8f473-183">See also</span></span>

- [<span data-ttu-id="8f473-184">テスト用に Outlook アドインを展開してインストールする</span><span class="sxs-lookup"><span data-stu-id="8f473-184">Deploy and install Outlook add-ins for testing</span></span>](testing-and-tips.md)
