---
title: Outlook アドインの認証オプション
description: Outlook アドインは、特定のシナリオに応じて、さまざまな認証メソッドを提供します。
ms.date: 04/28/2020
localization_priority: Priority
ms.openlocfilehash: 0a8c61a3e722cf1bcbfd1d9706c2dc41a7271345
ms.sourcegitcommit: be23b68eb661015508797333915b44381dd29bdb
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/08/2020
ms.locfileid: "44606491"
---
# <a name="authentication-options-in-outlook-add-ins"></a><span data-ttu-id="c7042-103">Outlook アドインの認証オプション</span><span class="sxs-lookup"><span data-stu-id="c7042-103">Authentication options in Outlook add-ins</span></span>

<span data-ttu-id="c7042-104">Outlook アドインは、アドインをホストするサーバー、内部ネットワーク、クラウド内の別の場所などに関わらず、インターネット上のあらゆる場所から情報にアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="c7042-104">Your Outlook add-in can access information from anywhere on the Internet, whether from the server that hosts the add-in, from your internal network, or from somewhere else in the cloud.</span></span> <span data-ttu-id="c7042-105">その情報が保護されている場合、アドインにはユーザーを認証する方法が必要になります。</span><span class="sxs-lookup"><span data-stu-id="c7042-105">If that information is protected, your add-in needs a way to authenticate your user.</span></span> <span data-ttu-id="c7042-106">Outlook アドインは、特定のシナリオに応じて、さまざまな認証メソッドを提供します。</span><span class="sxs-lookup"><span data-stu-id="c7042-106">Outlook add-ins provide a number of different methods to authenticate, depending on your specific scenario.</span></span>

## <a name="single-sign-on-access-token-preview"></a><span data-ttu-id="c7042-107">シングル サインオン アクセス トークン (プレビュー)</span><span class="sxs-lookup"><span data-stu-id="c7042-107">Single sign-on access token (preview)</span></span>

<span data-ttu-id="c7042-108">シングル サインオン アクセス トークンは、アドインがアクセス トークンを認証および取得して [Microsoft Graph API](/graph/overview) を呼び出すための、シームレスな方法を提供します。</span><span class="sxs-lookup"><span data-stu-id="c7042-108">Single sign-on access tokens provide a seamless way for your add-in to authenticate and obtain access tokens to call the [Microsoft Graph API](/graph/overview).</span></span> <span data-ttu-id="c7042-109">ユーザーが資格情報を入力する必要がないため、この機能は摩擦を低減します。</span><span class="sxs-lookup"><span data-stu-id="c7042-109">This capability reduces friction since the user is not required to enter their credentials.</span></span>

> [!NOTE]
> <span data-ttu-id="c7042-110">現在、シングル サインオン API は、Word、Excel、Outlook、PowerPoint のプレビューでサポートされていますが、運用環境のアドインでは**使用してはいけません**。シングル サインオン API の現在のサポート対象に関する詳細については、「[IdentityAPI の要件セット](../reference/requirement-sets/identity-api-requirement-sets.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="c7042-110">The Single Sign-on API is currently supported in preview for Word, Excel, Outlook, and PowerPoint, and should **not** be used in production add-ins. For more information about where the Single Sign-on API is currently supported, see [IdentityAPI requirement sets](../reference/requirement-sets/identity-api-requirement-sets.md).</span></span>
>
> <span data-ttu-id="c7042-111">SSO を使用するには、アドインのスタートアップ HTML ページの https://appsforoffice.microsoft.com/lib/beta/hosted/office.js から Office JavaScript ライブラリのベータ版を読み込む必要があります。</span><span class="sxs-lookup"><span data-stu-id="c7042-111">To use SSO, you must load the beta version of the Office JavaScript Library from https://appsforoffice.microsoft.com/lib/beta/hosted/office.js in the startup HTML page of the add-in.</span></span>
>
> <span data-ttu-id="c7042-112">Outlook アドインで作業している場合は、Office 365 テナントの先進認証が有効になっていることを確認してください。</span><span class="sxs-lookup"><span data-stu-id="c7042-112">If you are working with an Outlook add-in, be sure to enable Modern Authentication for the Office 365 tenancy.</span></span> <span data-ttu-id="c7042-113">この方法の詳細については、「[Exchange Online: テナントの先進認証を有効にする方法](https://social.technet.microsoft.com/wiki/contents/articles/32711.exchange-online-how-to-enable-your-tenant-for-modern-authentication.aspx)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="c7042-113">For information about how to do this, see [Exchange Online: How to enable your tenant for modern authentication](https://social.technet.microsoft.com/wiki/contents/articles/32711.exchange-online-how-to-enable-your-tenant-for-modern-authentication.aspx).</span></span>

<span data-ttu-id="c7042-114">アドインが次の場合は、SSO アクセス トークンの使用を検討してください。</span><span class="sxs-lookup"><span data-stu-id="c7042-114">Consider using SSO access tokens if your add-in:</span></span>

- <span data-ttu-id="c7042-115">主に Office 365 ユーザーが使用する。</span><span class="sxs-lookup"><span data-stu-id="c7042-115">Is used primarily by Office 365 users</span></span>
- <span data-ttu-id="c7042-116">次のものにアクセスする必要がある。</span><span class="sxs-lookup"><span data-stu-id="c7042-116">Needs access to:</span></span>
  - <span data-ttu-id="c7042-117">Microsoft Graph の一部として公開されている Microsoft サービス</span><span class="sxs-lookup"><span data-stu-id="c7042-117">Microsoft services that are exposed as part of Microsoft Graph</span></span>
  - <span data-ttu-id="c7042-118">ユーザーが制御する Microsoft 以外のサービス</span><span class="sxs-lookup"><span data-stu-id="c7042-118">A non-Microsoft service that you control</span></span>

<span data-ttu-id="c7042-119">SSO 認証方法は、Azure Active Directory が提供する [OAuth2 On-Behalf-Of フロー](/azure/active-directory/develop/active-directory-v2-protocols-oauth-on-behalf-of)を使用します。</span><span class="sxs-lookup"><span data-stu-id="c7042-119">The SSO authentication method uses the [OAuth2 On-Behalf-Of flow provided by Azure Active Directory](/azure/active-directory/develop/active-directory-v2-protocols-oauth-on-behalf-of).</span></span> <span data-ttu-id="c7042-120">それには、アドインを[アプリケーション登録ポータル](https://apps.dev.microsoft.com/)に登録し、必要な Microsoft Graph スコープをマニフェストで指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="c7042-120">It requires that the add-in register in the [Application Registration Portal](https://apps.dev.microsoft.com/) and specify any required Microsoft Graph scopes in its manifest.</span></span>

<span data-ttu-id="c7042-121">この方法を使用すると、アドインはサーバーのバックエンド API にスコープされたアクセス トークンを取得できます。</span><span class="sxs-lookup"><span data-stu-id="c7042-121">Using this method, your add-in can obtain an access token scoped to your server back-end API.</span></span> <span data-ttu-id="c7042-122">アドインはこれを `Authorization` ヘッダーのベアラー トークンとして使用して、API へのコールバックを認証します。</span><span class="sxs-lookup"><span data-stu-id="c7042-122">The add-in uses this as a bearer token in the `Authorization` header to authenticate a call back to your API.</span></span> <span data-ttu-id="c7042-123">その時点で、サーバーでは次の操作を実行できます。</span><span class="sxs-lookup"><span data-stu-id="c7042-123">At that point your server can:</span></span>

- <span data-ttu-id="c7042-124">On-Behalf-Of フローを完了して、Microsoft Graph API にスコープ設定されたアクセス トークンを取得する</span><span class="sxs-lookup"><span data-stu-id="c7042-124">Complete the On-Behalf-Of flow to obtain an access token scoped to the Microsoft Graph API</span></span>
- <span data-ttu-id="c7042-125">トークン内の ID 情報を使用して、独自のバックエンド サービスに対するユーザーの識別と認証を確立する</span><span class="sxs-lookup"><span data-stu-id="c7042-125">Use the identity information in the token to establish the user's identity and authenticate to your own back-end services</span></span>

<span data-ttu-id="c7042-126">より詳しい概要については、[SSO 認証方式の概要全文](../develop/sso-in-office-add-ins.md)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="c7042-126">For a more detailed overview, see the [full overview of the SSO authentication method](../develop/sso-in-office-add-ins.md).</span></span>

<span data-ttu-id="c7042-127">Outlook アドインでの SSO トークンの使用の詳細については、「[Outlook アドインでシングルサインオン トークンを使用してユーザーを認証する](authenticate-a-user-with-an-sso-token.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="c7042-127">For details on using the SSO token in an Outlook add-in, see [Authenticate a user with an single-sign-on token in an Outlook add-in](authenticate-a-user-with-an-sso-token.md).</span></span>

<span data-ttu-id="c7042-128">SSO トークンを使用するアドインのサンプルについては、「[AttachmentsDemo サンプル アドイン](https://github.com/OfficeDev/outlook-add-in-attachments-demo)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="c7042-128">For a sample add-in that uses the SSO token, see [AttachmentsDemo Sample Add-in](https://github.com/OfficeDev/outlook-add-in-attachments-demo).</span></span>

## <a name="exchange-user-identity-token"></a><span data-ttu-id="c7042-129">Exchange のユーザー ID トークン</span><span class="sxs-lookup"><span data-stu-id="c7042-129">Exchange user identity token</span></span>

<span data-ttu-id="c7042-130">Exchange のユーザー ID トークンは、アドインがユーザーの ID を確立する方法を提供します。</span><span class="sxs-lookup"><span data-stu-id="c7042-130">Exchange user identity tokens provide a way for your add-in to establish the identity of the user.</span></span> <span data-ttu-id="c7042-131">ユーザーの ID を確認することで、バックエンド システムにワンタイム認証を実行し、将来の要求に対する認証としてユーザー ID トークンを使用することができます。</span><span class="sxs-lookup"><span data-stu-id="c7042-131">By verifying the user's identity, you can then perform a one-time authentication into your back-end system, then accept the user identity token as an authorization for future requests.</span></span> <span data-ttu-id="c7042-132">次の場合、Exchange のユーザー ID トークンを使用します。</span><span class="sxs-lookup"><span data-stu-id="c7042-132">Use the Exchange user identity token:</span></span>

- <span data-ttu-id="c7042-133">アドインが主に Exchange のオンプレミス ユーザーによって使用される場合。</span><span class="sxs-lookup"><span data-stu-id="c7042-133">When the add-in is used primarily by Exchange on-premises users.</span></span>
- <span data-ttu-id="c7042-134">アドインが、ユーザーが制御する Microsoft 以外のサービスにアクセスする必要がある場合。</span><span class="sxs-lookup"><span data-stu-id="c7042-134">When the add-in needs access to a non-Microsoft service that you control.</span></span>
- <span data-ttu-id="c7042-135">SSO をサポートしていないバージョンの Office でアドインが実行されている場合の代替認証 (および Microsoft Graph の認証) として。</span><span class="sxs-lookup"><span data-stu-id="c7042-135">As a fallback authentication (and authorization to Microsoft Graph) when the add-in is running on a version of Office that doesn't support SSO.</span></span>

<span data-ttu-id="c7042-136">アドインでは、[getUserIdentityTokenAsync](/javascript/api/outlook/office.mailbox#getuseridentitytokenasync-callback--usercontext-) を呼び出して Exchange のユーザー ID トークンを取得できます。</span><span class="sxs-lookup"><span data-stu-id="c7042-136">Your add-in can call [getUserIdentityTokenAsync](/javascript/api/outlook/office.mailbox#getuseridentitytokenasync-callback--usercontext-) to get Exchange user identity tokens.</span></span> <span data-ttu-id="c7042-137">それらのトークンの使用の詳細については、「[Exchange の ID トークンを使用してユーザーを認証する](authenticate-a-user-with-an-identity-token.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="c7042-137">For details on using these tokens, see [Authenticate a user with an identity token for Exchange](authenticate-a-user-with-an-identity-token.md).</span></span>

## <a name="access-tokens-obtained-via-oauth2-flows"></a><span data-ttu-id="c7042-138">OAuth2 フローで取得されたアクセス トークン</span><span class="sxs-lookup"><span data-stu-id="c7042-138">Access tokens obtained via OAuth2 flows</span></span>

<span data-ttu-id="c7042-139">アドインは、OAuth2 をサポートするサードパーティのサービスにアクセスして承認することもできます。</span><span class="sxs-lookup"><span data-stu-id="c7042-139">Add-ins can also access third-party services that support OAuth2 for authorization.</span></span> <span data-ttu-id="c7042-140">アドインが次の場合は、OAuth2 トークンの使用を検討してください。</span><span class="sxs-lookup"><span data-stu-id="c7042-140">Consider using OAuth2 tokens if your add-in:</span></span>

- <span data-ttu-id="c7042-141">ユーザーの制御外のサードパーティ サービスにアクセスする必要がある</span><span class="sxs-lookup"><span data-stu-id="c7042-141">Needs access to a third-party service outside of your control</span></span>

<span data-ttu-id="c7042-142">この方法を使用すると、アドインはユーザーに、[displayDialogAsync](/javascript/api/office/office.ui#displaydialogasync-startaddress--options--callback-) メソッドを使用して OAuth2 フローを初期化するか、OAuth2 の暗黙のフローに [office-js-helpers ライブラリ](https://github.com/OfficeDev/office-js-helpers)を使用することでサービスにサインインするよう求めるダイアログを表示します。</span><span class="sxs-lookup"><span data-stu-id="c7042-142">Using this method, your add-in prompts the user to sign-in to the service either by using the [displayDialogAsync](/javascript/api/office/office.ui#displaydialogasync-startaddress--options--callback-) method to initialize the OAuth2 flow, or by using the [office-js-helpers library](https://github.com/OfficeDev/office-js-helpers) to the OAuth2 Implicit flow.</span></span>

## <a name="callback-tokens"></a><span data-ttu-id="c7042-143">コールバック トークン</span><span class="sxs-lookup"><span data-stu-id="c7042-143">Callback tokens</span></span>

<span data-ttu-id="c7042-144">コールバック トークンは、[Exchange Web サービス (EWS)](/exchange/client-developer/exchange-web-services/explore-the-ews-managed-api-ews-and-web-services-in-exchange) または [Outlook REST API](/previous-versions/office/office-365-api/api/version-2.0/use-outlook-rest-api) を使用した、サーバーのバックエンドからユーザーのメールボックスへのアクセスを提供します。</span><span class="sxs-lookup"><span data-stu-id="c7042-144">Callback tokens provide access to the user's mailbox from your server back-end, either using [Exchange Web Services (EWS)](/exchange/client-developer/exchange-web-services/explore-the-ews-managed-api-ews-and-web-services-in-exchange), or the [Outlook REST API](/previous-versions/office/office-365-api/api/version-2.0/use-outlook-rest-api).</span></span> <span data-ttu-id="c7042-145">アドインが次の場合は、コールバック トークンの使用を検討してください。</span><span class="sxs-lookup"><span data-stu-id="c7042-145">Consider using callback tokens if your add-in:</span></span>

- <span data-ttu-id="c7042-146">サーバーのバックエンドからユーザーのメールボックスにアクセスする必要がある。</span><span class="sxs-lookup"><span data-stu-id="c7042-146">Needs access to the user's mailbox from your server back-end.</span></span>

<span data-ttu-id="c7042-147">アドインは、[getCallbackTokenAsync メソッド](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods)の 1 つを使用して、コールバック トークンを取得します。</span><span class="sxs-lookup"><span data-stu-id="c7042-147">Add-ins obtain callback tokens using one of the [getCallbackTokenAsync](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods) methods.</span></span> <span data-ttu-id="c7042-148">アクセスのレベルは、アドイン マニフェストで指定されたアクセス許可によって制御されます。</span><span class="sxs-lookup"><span data-stu-id="c7042-148">The level of access is controlled by the permissions specified in the add-in manifest.</span></span>
