---
title: アドインと Azure を使用してアドインVisual Studio Code発行する
description: アドインを使用してアドインを発行するVisual Studio CodeおよびAzure Active Directory
ms.date: 08/12/2020
localization_priority: Normal
ms.openlocfilehash: ab8daf3dfb87c809cd812da45246ce2d5ca9e743
ms.sourcegitcommit: ee9e92a968e4ad23f1e371f00d4888e4203ab772
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/23/2021
ms.locfileid: "53076939"
---
# <a name="publish-an-add-in-developed-with-visual-studio-code"></a><span data-ttu-id="dc068-103">Visual Studio Code で開発されたアドインを発行する</span><span class="sxs-lookup"><span data-stu-id="dc068-103">Publish an add-in developed with Visual Studio Code</span></span>

<span data-ttu-id="dc068-104">この記事では、Yeoman ジェネレーターを使用して作成し、[Visual Studio Code (VS Code)](https://code.visualstudio.com) またはその他のエディターで開発した Office アドインを発行する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="dc068-104">This article describes how to publish an Office Add-in that you created using the Yeoman generator and developed with [Visual Studio Code (VS Code)](https://code.visualstudio.com) or any other editor.</span></span>

> [!NOTE]
> <span data-ttu-id="dc068-105">Visual Studio を使用して作成した Office アドインの発行の詳細については、「[Visual Studio を使用してアドインを発行する](package-your-add-in-using-visual-studio.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="dc068-105">For information about publishing an Office Add-in that you created using Visual Studio, see [Publish your add-in using Visual Studio](package-your-add-in-using-visual-studio.md).</span></span>

## <a name="publishing-an-add-in-for-other-users-to-access"></a><span data-ttu-id="dc068-106">他のユーザーがアクセスできるようにアドインを発行する</span><span class="sxs-lookup"><span data-stu-id="dc068-106">Publishing an add-in for other users to access</span></span>

<span data-ttu-id="dc068-107">Office アドインは、Web アプリケーションとマニフェスト ファイルで構成されています。</span><span class="sxs-lookup"><span data-stu-id="dc068-107">An Office Add-in consists of a web application and a manifest file.</span></span> <span data-ttu-id="dc068-108">Web アプリケーションはアドインのユーザー インターフェイスと機能を定義し、マニフェストは Web アプリケーションの場所を指定し、アドインの設定と機能を定義します。</span><span class="sxs-lookup"><span data-stu-id="dc068-108">The web application defines the add-in's user interface and functionality, while the manifest specifies the location of the web application and defines settings and capabilities of the add-in.</span></span>

<span data-ttu-id="dc068-109">開発中は、ローカル Web サーバー () でアドインを実行できます `localhost` 。</span><span class="sxs-lookup"><span data-stu-id="dc068-109">While you're developing, you can run the add-in on your local web server (`localhost`).</span></span> <span data-ttu-id="dc068-110">他のユーザーがアクセスするために発行する準備ができたら、Web アプリケーションを展開し、マニフェストを更新して、展開されたアプリケーションの URL を指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="dc068-110">When you're ready to publish it for other users to access, you'll need to deploy the web application and update the manifest to specify the URL of the deployed application.</span></span>

<span data-ttu-id="dc068-111">アドインが必要に応じて動作している場合は、拡張機能を使用してVisual Studio Code直接Azure Storageできます。</span><span class="sxs-lookup"><span data-stu-id="dc068-111">When your add-in is working as desired, you can publish it directly through Visual Studio Code using the Azure Storage extension.</span></span>

## <a name="using-visual-studio-code-to-publish"></a><span data-ttu-id="dc068-112">発行にVisual Studio Codeを使用する</span><span class="sxs-lookup"><span data-stu-id="dc068-112">Using Visual Studio Code to publish</span></span>

>[!NOTE]
> <span data-ttu-id="dc068-113">これらの手順は、Yeoman ジェネレーターを使用して作成されたプロジェクトでのみ機能します。</span><span class="sxs-lookup"><span data-stu-id="dc068-113">These steps only work for projects created with the Yeoman generator.</span></span>

1. <span data-ttu-id="dc068-114">プロジェクトのルート フォルダーからプロジェクトを開Visual Studio Code (VS Code)。</span><span class="sxs-lookup"><span data-stu-id="dc068-114">Open your project from its root folder in Visual Studio Code (VS Code).</span></span>
2. <span data-ttu-id="dc068-115">[拡張機能] ビューで、VS Code拡張機能を検索Azure Storageインストールします。</span><span class="sxs-lookup"><span data-stu-id="dc068-115">From the Extensions view in VS Code, search for the Azure Storage extension and install it.</span></span>
3. <span data-ttu-id="dc068-116">インストールが完了すると、アクティビティ バーに Azure アイコンが追加されます。</span><span class="sxs-lookup"><span data-stu-id="dc068-116">Once installed, an Azure icon is added to the Activity Bar.</span></span> <span data-ttu-id="dc068-117">拡張機能にアクセスするには、それを選択します。</span><span class="sxs-lookup"><span data-stu-id="dc068-117">Select it to access the extension.</span></span> <span data-ttu-id="dc068-118">アクティビティ バーが非表示の場合は、拡張機能にアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="dc068-118">If your Activity Bar is hidden, you won't be able to access the extension.</span></span> <span data-ttu-id="dc068-119">[アクティビティ バーの表示] を選択して、[アクティビティ **バー>表示>を表示します**。</span><span class="sxs-lookup"><span data-stu-id="dc068-119">Show the Activity Bar by selecting **View > Appearance > Show Activity Bar**.</span></span>
4. <span data-ttu-id="dc068-120">拡張機能で [Azure にサインイン] を選択して Azure アカウント **にサインインします**。</span><span class="sxs-lookup"><span data-stu-id="dc068-120">When in the extension, sign in to your Azure account by selecting **Sign in to Azure**.</span></span> <span data-ttu-id="dc068-121">[無料の Azure アカウントの作成] を選択して、Azure アカウントをまだ持ってない場合は **、Azure アカウントを作成することもできます**。</span><span class="sxs-lookup"><span data-stu-id="dc068-121">You can also create an Azure account if you don't already have one by selecting **Create a free Azure account**.</span></span> <span data-ttu-id="dc068-122">提供されている手順に従ってアカウントを設定します。</span><span class="sxs-lookup"><span data-stu-id="dc068-122">Follow the provided steps to set up your account.</span></span>
5. <span data-ttu-id="dc068-123">Azure アカウントにサインインすると、拡張機能に Azure ストレージ アカウントが表示されます。</span><span class="sxs-lookup"><span data-stu-id="dc068-123">Once you have signed in to your Azure account, you'll see your Azure storage accounts appear in the extension.</span></span> <span data-ttu-id="dc068-124">ストレージ アカウントをまだ持ってない場合は、[新しいストレージ アカウントの作成] オプションを使用して作成 **する必要** があります。</span><span class="sxs-lookup"><span data-stu-id="dc068-124">If you don't already have a storage account, you'll need to create one using the **Create new storage account** option.</span></span> <span data-ttu-id="dc068-125">'a-z' と '0-9' のみを使用して、ストレージ アカウントにグローバルに一意の名前を付け加える。</span><span class="sxs-lookup"><span data-stu-id="dc068-125">Name your storage account a globally unique name, using only 'a-z' and '0-9'.</span></span> <span data-ttu-id="dc068-126">既定では、ストレージ アカウントと同じ名前のリソース グループが作成されます。</span><span class="sxs-lookup"><span data-stu-id="dc068-126">Note that by default, this creates a storage account and a resource group with the same name.</span></span> <span data-ttu-id="dc068-127">ストレージ アカウントは米国西部に自動的に設定されます。</span><span class="sxs-lookup"><span data-stu-id="dc068-127">It automatically puts the storage account in West US.</span></span> <span data-ttu-id="dc068-128">これは、Azure アカウントを介して [オンラインで調整できます](https://portal.azure.com/)。</span><span class="sxs-lookup"><span data-stu-id="dc068-128">This can be adjusted online through [your Azure account](https://portal.azure.com/).</span></span>
6. <span data-ttu-id="dc068-129">ストレージ アカウントを選択して保持 (右クリック) し、[静的 Web サイトの構成 **] を選択します**。</span><span class="sxs-lookup"><span data-stu-id="dc068-129">Select and hold (right-click) your storage account, choosing **Configure static website**.</span></span> <span data-ttu-id="dc068-130">インデックス ドキュメント名と 404 ドキュメント名を入力する必要があります。</span><span class="sxs-lookup"><span data-stu-id="dc068-130">You'll be asked to enter the index document name and the 404 document name.</span></span> <span data-ttu-id="dc068-131">インデックス ドキュメント名を既定から `index.html` に変更します **`taskpane.html`** 。</span><span class="sxs-lookup"><span data-stu-id="dc068-131">Change the index document name from the default `index.html` to **`taskpane.html`**.</span></span> <span data-ttu-id="dc068-132">また、404 ドキュメント名を変更する場合がありますが、変更する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="dc068-132">You may decide to also change the 404 document name but are not required to.</span></span>
7. <span data-ttu-id="dc068-133">ストレージを再度選択して保持 (右クリック) します。今回は [静的 Web サイトの参照 **] を選択します**。</span><span class="sxs-lookup"><span data-stu-id="dc068-133">Select and hold (right-click) your storage again, this time choosing **Browse static website**.</span></span> <span data-ttu-id="dc068-134">開くブラウザー ウィンドウから、Web サイトの URL をコピーします。</span><span class="sxs-lookup"><span data-stu-id="dc068-134">From the browser window that opens, copy the website URL.</span></span>
8. <span data-ttu-id="dc068-135">このVS Codeプロジェクトのマニフェスト ファイル ( ) を開き、ローカル ホスト URL (など) への参照をコピーした `manifest.xml` `https://localhost:3000` URL に変更します。</span><span class="sxs-lookup"><span data-stu-id="dc068-135">In VS Code, open your project's manifest file (`manifest.xml`) and change any reference to your localhost URL (such as `https://localhost:3000`) to the URL you've copied.</span></span> <span data-ttu-id="dc068-136">このエンドポイントは、新しく作成したストレージ アカウントの静的 Web サイト URL です。</span><span class="sxs-lookup"><span data-stu-id="dc068-136">This endpoint is the static website URL for your newly created storage account.</span></span> <span data-ttu-id="dc068-137">マニフェスト ファイルに変更を保存します。</span><span class="sxs-lookup"><span data-stu-id="dc068-137">Save the changes to your manifest file.</span></span>
9. <span data-ttu-id="dc068-138">コマンド ライン プロンプトを開き、アドイン プロジェクトのルート ディレクトリに移動します。</span><span class="sxs-lookup"><span data-stu-id="dc068-138">Open a command line prompt and navigate to the root directory of your add-in project.</span></span> <span data-ttu-id="dc068-139">次に、次のコマンドを実行して、すべてのファイルを実稼働展開用に準備します。</span><span class="sxs-lookup"><span data-stu-id="dc068-139">Then run the following command to prepare all files for production deployment.</span></span>

    ```command&nbsp;line
    npm run build
    ```

    <span data-ttu-id="dc068-140">ビルドが完了すると、アドイン プロジェクトのルート ディレクトリにある **dist** フォルダーに、以降の手順で展開するファイルが含まれます。</span><span class="sxs-lookup"><span data-stu-id="dc068-140">When the build completes, the **dist** folder in the root directory of your add-in project will contain the files that you'll deploy in subsequent steps.</span></span>

10. <span data-ttu-id="dc068-141">展開するには、ファイル エクスプローラーを選択し **、dist** フォルダーを選択して保持 (右クリック) し、[静的 Web サイトに展開する] **を選択します**。</span><span class="sxs-lookup"><span data-stu-id="dc068-141">To deploy, select the Files explorer, select and hold (right-click) your **dist** folder, and choose **Deploy to Static Website**.</span></span> <span data-ttu-id="dc068-142">メッセージが表示されたら、前に作成したストレージ アカウントを選択します。</span><span class="sxs-lookup"><span data-stu-id="dc068-142">When prompted, select the storage account you created previously.</span></span>

![静的 Web サイトへの展開。](../images/deploy-to-static-website.png)

11. <span data-ttu-id="dc068-144">展開が完了すると **、[Web サイト** への参照] メッセージが表示され、展開されたアプリ コードのプライマリ エンドポイントを開く場合に選択できます。</span><span class="sxs-lookup"><span data-stu-id="dc068-144">When deployment is complete, a **Browse to website** message appears which you can select to open the primary endpoint of the deployed app code.</span></span>

## <a name="see-also"></a><span data-ttu-id="dc068-145">関連項目</span><span class="sxs-lookup"><span data-stu-id="dc068-145">See also</span></span>

- [<span data-ttu-id="dc068-146">Visual Studio Code を使用して Office アドインを開発する</span><span class="sxs-lookup"><span data-stu-id="dc068-146">Develop Office Add-ins with Visual Studio Code</span></span>](../develop/develop-add-ins-vscode.md)
- [<span data-ttu-id="dc068-147">Office アドインを展開し、発行する</span><span class="sxs-lookup"><span data-stu-id="dc068-147">Deploy and publish your Office Add-in</span></span>](../publish/publish.md)
