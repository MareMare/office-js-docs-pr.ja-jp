

1. [https://apps.dev.microsoft.com/](https://apps.dev.microsoft.com)にナビゲートします。

1. ダイアログが表示されたら、*** 管理者*** の資格情報を使用して Office 365 テナントにサインインします。 たとえば、MyName@contoso.onmicrosoft.com のようにします

1. **[アプリの追加]** をクリックします。

1. 表示されたら、**［$ADD-IN-NAME$］** をアプリ名として入力してから **［アプリケーションの作成］** をクリックします。

1. アプリの構成ページが開いたら、**[アプリケーション ID]** をコピーして保存します。これは、この後の手順で使用します。

    > [!NOTE]
    > この ID は、Office ホスト アプリケーション (たとえば、PowerPoint、Word、Excel) などの別のアプリケーションが、このアプリケーションへの承認されたアクセスを求めるときの「対象ユーザー」値になります。また、そのアプリケーションが Microsoft Graph への承認されたアクセスを求めるときには、このアプリケーションの「クライアント ID」になります。

1. **[アプリケーション シークレット]** セクションで、**[新しいパスワードを生成する]** をクリックします。新しいパスワード (「アプリケーション シークレット」とも呼びます) が示されたポップアップ ダイアログが開きます。*このパスワードをすぐにコピーして、アプリケーション ID と共に保存します。* これは、この後の手順で必要になります。その後で、ダイアログを閉じます。

1. **[プラットフォーム]** セクションで、**[プラットフォームの追加]** をクリックします。

1. 開いたダイアログで、**[Web API]** を選択します。

1. **アプリケーション ID URI** は、"api://$App ID GUID$"のフォームで生成されています。 **［$FQDN-WITHOUT-PROTOCOL$］** を二重のスラッシュと GUID の間に（スラッシュ「/」を末尾に追加するかたちで）挿入します。 ID 全体には `api://$FQDN-WITHOUT-PROTOCOL$/$App ID GUID$` というフォームが必要です。例えば、 `api://localhost:6789/c6c1f32b-5e55-4997-881a-753cc1d563b7`のようにします。

    > [!NOTE]
    > ドメインを既に所有している場合に、所有しているというエラーが表示された場合は、 [［クイックスタート」に従います。これは、Azure Active Directory にカスタムドメイン名を追加](https://docs.microsoft.com/azure/active-directory/add-custom-domain) し、 それを登録してから、この手順を繰り返します。 (Office 365 テナントに管理者の資格情報でサインインしていない場合、このエラーも発生する可能性があります。 手順 2 を参照してください。 サインアウトして管理者の資格情報でもう一度サインインし、手順 3 から手順を繰り返します。)

    > [!NOTE]
    > ** アプリケーション ID URI** のすぐ下の**   スコープ ** 名のドメイン部分は、`/access_as_user` を末尾に追加するかたちで、一致するように自動的に変更されます。例えば、 `api://localhost:6789/c6c1f32b-5e55-4997-881a-753cc1d563b7/access_as_user`のようになります。

1. **[事前承認済みアプリケーション]** セクションで、アドインの Web アプリケーションに対して承認するアプリケーションを特定します。 次のそれぞれの ID を事前承認する必要があります。 1 つの ID を入力するたびに、新しい空のテキスト ボックスが表示されます。 (GUID のみを入力してください。)
    * `d3590ed6-52b3-4102-aeff-aad2292ab01c` (Microsoft Office)
    * `57fb890c-0dab-4253-a5e0-7188c88b2bb4` (Office Online)
    * `bc59ab01-8403-45c6-8796-ac3ef710b3e3` (Office Online)

1. それぞれの**  [アプリケーション ID]** の横の**  [スコープ]** ドロップダウンを開いて、`api://$FQDN-WITHOUT-PROTOCOL$/$App ID GUID$/access_as_user` のボックスをオンにします。

1. **[プラットフォーム]** セクションの上部にある **[プラットフォームの追加]** を再度クリックして、**[Web]** を選択します。

1. ** [プラットフォーム]** の下側の新しい ** [Web]** セクションで、**[リダイレクト URL]** として `https://$FQDN-WITHOUT-PROTOCOL$` を入力します。

1. **[Microsoft Graph のアクセス許可]** セクションを下にスクロールして、**[委任されたアクセス許可]** サブセクションを表示します。**[追加]** ボタンを使用して、**[アクセス許可の選択]** ダイアログを開きます。

1. ダイアログ ボックスで、 [`profile`] ボックスおよびアドインに必要な他の AAD および Microsoft Graph 許可をチェックします。 次に、例を示します。

    * Files.Read.All
    * offline_access
    * openid
    * profile

    > [!NOTE]
    > `User.Read` アクセス許可は既定でリストされています。 必要でないアクセス許可は依頼しない方がよいため、アドインで実際に必要でなければ、このアクセス許可のチェックボックスをオフにすることをお勧めします。

1. ダイアログの下部にある **[OK]** をクリックします。

1. 登録ページの下部にある **[保存]** をクリックします。
