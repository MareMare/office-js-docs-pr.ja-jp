

1. [https://apps.dev.microsoft.com/](https://apps.dev.microsoft.com) に移動します。

1. ***管理者***の資格情報を使用して Office 365 テナントにサインインします。 たとえば、MyName@contoso.onmicrosoft.com

1. **[アプリの追加]** をクリックします。

1. ダイアログが表示されたら、アプリ名として **$ADD-IN-NAME$** を入力して、**[アプリケーションの作成]** をクリックします。

1. アプリの構成ページが開いたら、**[アプリケーション ID]** をコピーして保存します。これは、この後の手順で使用します。

    > [!NOTE]
    > この ID は、Office ホスト アプリケーション (たとえば、PowerPoint、Word、Excel) などの別のアプリケーションが、このアプリケーションへの承認されたアクセスを求めるときの「対象ユーザー」値になります。また、そのアプリケーションが Microsoft Graph への承認されたアクセスを求めるときには、このアプリケーションの「クライアント ID」になります。

1. **[アプリケーション シークレット]** セクションで、**[新しいパスワードを生成する]** をクリックします。新しいパスワード (「アプリケーション シークレット」とも呼びます) が示されたポップアップ ダイアログが開きます。*このパスワードをすぐにコピーして、アプリケーション ID と共に保存します。* これは、この後の手順で必要になります。その後で、ダイアログを閉じます。

1. **[プラットフォーム]** セクションで、**[プラットフォームの追加]** をクリックします。

1. 開いたダイアログで、**[Web API]** を選択します。

1. **[アプリケーション ID URI]** が、"api://$App ID GUID$" という形式で生成されています。 ダブル スラッシュと GUID の間に **$FQDN-WITHOUT-PROTOCOL$** (末尾にスラッシュ "/" を付けて) を挿入します。 全体の ID は `api://$FQDN-WITHOUT-PROTOCOL$/$App ID GUID$` の形式になります。例: `api://localhost:6789/c6c1f32b-5e55-4997-881a-753cc1d563b7`。

    > [!NOTE]
    > ドメインを所有しているにもかかわらず、そのドメインが既に所有されているというエラーが表示される場合は、「[クイック スタート: カスタム ドメイン名を Azure Active Directory に追加する](/azure/active-directory/add-custom-domain)」の手順に従って登録し、この手順を繰り返します。 (このエラーは、Office 365 テナントで管理者の資格情報を使用してサインインしていない場合にも発生することがあります。 手順 2 を参照してください。 サインアウトして、管理者の資格情報を使用して再度サインインし、手順 3 からプロセスを繰り返します。)

    > [!NOTE]
    > **[アプリケーション ID URI]** のすぐ下の **[スコープ]** 名のドメイン部分は、一致するように自動的に変更され、末尾に`/access_as_user` が追加されます。例: `api://localhost:6789/c6c1f32b-5e55-4997-881a-753cc1d563b7/access_as_user`。

1. **[事前承認済みアプリケーション]** セクションで、アドインの Web アプリケーションに対して承認するアプリケーションを特定します。 次のそれぞれの ID を事前承認する必要があります。 1 つの ID を入力するたびに、新しい空のテキスト ボックスが表示されます。 (GUID のみを入力してください。)
    * `d3590ed6-52b3-4102-aeff-aad2292ab01c` (Microsoft Office)
    * `57fb890c-0dab-4253-a5e0-7188c88b2bb4` (Office Online)
    * `bc59ab01-8403-45c6-8796-ac3ef710b3e3` (Office Online)

1. それぞれの **[アプリケーション ID]** の横の **[スコープ]** ドロップダウンを開いて、`api://$FQDN-WITHOUT-PROTOCOL$/$App ID GUID$/access_as_user` のボックスをオンにします。

1. **[プラットフォーム]** セクションの上部にある **[プラットフォームの追加]** を再度クリックして、**[Web]** を選択します。

1. **[プラットフォーム]** の下側の新しい **[Web]** セクションで、**[リダイレクト URL]** として `https://$FQDN-WITHOUT-PROTOCOL$` を入力します。

1. **[Microsoft Graph のアクセス許可]** セクションを下にスクロールして、**[委任されたアクセス許可]** サブセクションを表示します。**[追加]** ボタンを使用して、**[アクセス許可の選択]** ダイアログを開きます。

1. ダイアログ ボックスで、`profile` のチェック ボックスと、アドインに必要なその他の AAD と Microsoft Graph のアクセス許可をオンにします。 次に例を示します。

    * Files.Read.All
    * offline_access
    * openid
    * profile

    > [!NOTE]
    > `User.Read` アクセス許可は既定でリストされています。 必要でないアクセス許可は依頼しない方がよいため、アドインが実際に必要でない場合は、このアクセス許可のボックスのチェックをオフにしておくことをお勧めします。

1. ダイアログの下部にある **[OK]** をクリックします。

1. 登録ページの下部にある **[保存]** をクリックします。
