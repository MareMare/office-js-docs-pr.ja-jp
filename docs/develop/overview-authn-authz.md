---
title: Office アドインにおける認証と承認の概要
description: ''
ms.date: 08/07/2019
localization_priority: Priority
ms.openlocfilehash: 2733f8af9f236347e52269c9e73b322b4310e2a9
ms.sourcegitcommit: 1dc1bb0befe06d19b587961da892434bd0512fb5
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/13/2019
ms.locfileid: "36302957"
---
# <a name="overview-of-authentication-and-authorization-in-office-add-ins"></a><span data-ttu-id="25036-102">Office アドインにおける認証と承認の概要</span><span class="sxs-lookup"><span data-stu-id="25036-102">Overview of identity, authentication, and authorization in Office 2013</span></span>

<span data-ttu-id="25036-103">既定では、Web アプリケーション、つまり Office アドインでは匿名アクセスが許可されていますが、ログインによる認証をユーザーに要求できます。</span><span class="sxs-lookup"><span data-stu-id="25036-103">Web applications and, hence, Office Add-ins allow anonymous access by default, but you can require users to authenticate with a login.</span></span> <span data-ttu-id="25036-104">特に、ユーザーが Microsoft アカウントまたは職場や学校 (Office 365) のアカウントのいずれかを使用してログインすることを要求できます。</span><span class="sxs-lookup"><span data-stu-id="25036-104">In particular, you can require that your users be logged in with either a Microsoft Account or a Work or School (Office 365) account.</span></span> <span data-ttu-id="25036-105">これによりユーザーの確認がアドインで可能になることから、このタスクはユーザー認証と呼ばれています。</span><span class="sxs-lookup"><span data-stu-id="25036-105">This task is called user authentication because it enables the add-in to know who the user is.</span></span>

<span data-ttu-id="25036-106">アドインはまた、Microsoft Graph データ (ユーザーの Office 365 プロファイル、OneDrive ファイル、SharePoint データなど) や Google、Facebook、LinkedIn、SalesForce、GitHub などの外部ソース内のデータにアクセスするためのユーザーの同意を取得することもできます。</span><span class="sxs-lookup"><span data-stu-id="25036-106">Your add-in can also get the user's consent to access their Microsoft Graph data (such as their Office 365 profile, OneDrive files, and SharePoint data) or to data in other external sources such as Google, Facebook, LinkedIn, SalesForce, and GitHub.</span></span> <span data-ttu-id="25036-107">これにより承認されるのはユーザーではなく*アドイン*であることから、このタスクはアドイン (またはアプリ) 承認と呼ばれています。</span><span class="sxs-lookup"><span data-stu-id="25036-107">This task is called add-in (or app) authorization, because it is the *add-in* that is being authorized, not the user.</span></span>

<span data-ttu-id="25036-108">これらの認証を実行するには、2 つの方法があります。</span><span class="sxs-lookup"><span data-stu-id="25036-108">You have a choice of two ways to accomplish these authentications.</span></span>

- <span data-ttu-id="25036-109">**Office シングル サインオン (SSO)**: *現在プレビュー中*のシステムで、ユーザーが Office にログインすると、それがアドインへのログインとしても機能することを可能にします。</span><span class="sxs-lookup"><span data-stu-id="25036-109">**Office Single Sign-on (SSO)**: A system, *currently in preview*, that enables the user's login to Office to also function as a login to the add-in.</span></span> <span data-ttu-id="25036-110">アドインでは、必要に応じて、Microsoft Graph へのアドインの承認を行うために、ユーザーの Office の資格情報を使用できます。</span><span class="sxs-lookup"><span data-stu-id="25036-110">Optionally, the add-in can also use the user's Office credentials to authorize the add-in to Microsoft Graph.</span></span> <span data-ttu-id="25036-111">(Microsoft 以外のソースは、このシステムからはアクセスできません。)</span><span class="sxs-lookup"><span data-stu-id="25036-111">(Non-Microsoft sources are not accessible through this system.)</span></span>
- <span data-ttu-id="25036-112">**Azure Active Directory での Web アプリケーションの認証と承認**: これは、新しい機能または特別な機能ではありません。</span><span class="sxs-lookup"><span data-stu-id="25036-112">**Web Application Authentication and Authorization with Azure Active Directory**: This isn't something new or special.</span></span> <span data-ttu-id="25036-113">これは、Office SSO システムの導入以前に Office アドイン (およびその他の Web アプリ) でユーザーの認証とアプリの承認を行うために使用されていた方法で、Office SSO を使用できないシナリオでは現在でも使用されています。</span><span class="sxs-lookup"><span data-stu-id="25036-113">It's just the way Office add-in (and other web apps) authenticated users and authorized apps before there was an Office SSO system and is still used in scenarios where Office SSO cannot be.</span></span>

<span data-ttu-id="25036-114">次のフローチャートは、アドイン開発者が判断する必要がある項目を示しています。</span><span class="sxs-lookup"><span data-stu-id="25036-114">The following flowchart shows you the decisions that you need to make as an add-in developer.</span></span> <span data-ttu-id="25036-115">詳細については、この記事で後述します。</span><span class="sxs-lookup"><span data-stu-id="25036-115">Authentication options are discussed later in this article.</span></span>

![Office アドインで認証および承認を可能にするための判断フローチャートを示す画像](../images/auth-decisions-flowchart.gif)

## <a name="user-authentication-without-sso"></a><span data-ttu-id="25036-117">SSO を使用しないユーザー認証</span><span class="sxs-lookup"><span data-stu-id="25036-117">User authentication without SSO</span></span>

<span data-ttu-id="25036-118">他の Web アプリケーションの場合と同様、Office アドインでのユーザーの認証は Azure Active Directory (AAD) を使用して行えますが、ログイン ページを iFrame 内で開くことが AAD により許可されていない点が異なります。</span><span class="sxs-lookup"><span data-stu-id="25036-118">You can authenticate a user in an Office Add-in with Azure Active Directory (AAD) as you would any in any other web application with one exception: AAD does not allow its login page to open in an iframe.</span></span> <span data-ttu-id="25036-119">Office アドインが *Office on the web* で実行されている場合、作業ウィンドウとして iFrame が使用されます。</span><span class="sxs-lookup"><span data-stu-id="25036-119">When an Office Add-in is running on *Office on the web*, the task pane is an iframe.</span></span> <span data-ttu-id="25036-120">これは、AAD のログイン画面は、Office ダイアログ API を使用して開かれるダイアログで開く必要があることを意味します。</span><span class="sxs-lookup"><span data-stu-id="25036-120">This means that you will need to open the AAD login screen in a dialog opened with the Office Dialog API.</span></span> <span data-ttu-id="25036-121">このことは、認証ヘルパー ライブラリの使用方法に影響します。</span><span class="sxs-lookup"><span data-stu-id="25036-121">This affects how you use authentication helper libraries.</span></span> <span data-ttu-id="25036-122">詳細については、「[Office ダイアログ API を使用して認証と承認を行う](auth-with-office-dialog-api.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="25036-122">For more information, see [Authentication with the Office Dialog API](auth-with-office-dialog-api.md).</span></span>

<span data-ttu-id="25036-123">AAD での認証のプログラミングの詳細については、「[Microsoft identity platform (v2.0) overview (Microsoft ID プラットフォーム (v2.0) の概要)](/azure/active-directory/develop/v2-overview)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="25036-123">For information about programming authentication with AAD, begin with [Microsoft identity platform (v2.0) overview](/azure/active-directory/develop/v2-overview).</span></span> <span data-ttu-id="25036-124">このドキュメント セットには、多くのチュートリアルやガイドの他、関連するサンプルやライブラリへのリンクが含まれています。</span><span class="sxs-lookup"><span data-stu-id="25036-124">There are many tutorials and guides in that documentation set, as well as links to relevant samples and libraries.</span></span> <span data-ttu-id="25036-125">「[Office ダイアログ API を使用して認証と承認を行う](auth-with-office-dialog-api.md)」の説明にあるように、Office ダイアログで実行するサンプル内のコードを調整する必要がある場合があります。</span><span class="sxs-lookup"><span data-stu-id="25036-125">As explained in [Authentication with the Office Dialog API](auth-with-office-dialog-api.md), you may need to adjust the code in the samples to run in the Office Dialog.</span></span>

## <a name="access-to-microsoft-graph-without-sso"></a><span data-ttu-id="25036-126">SSO を使用しないで Microsoft Graph にアクセスする</span><span class="sxs-lookup"><span data-stu-id="25036-126">Access to Microsoft Graph without SSO</span></span>

<span data-ttu-id="25036-127">Azure Active Directory (AAD) から Graph へのアクセス トークンを取得することで、アドイン用の Microsoft Graph データへの承認を取得できます。</span><span class="sxs-lookup"><span data-stu-id="25036-127">You can get authorization to Microsoft Graph data for your add-in by obtaining an access token to Graph from Azure Active Directory (AAD).</span></span> <span data-ttu-id="25036-128">これは、Office SSO を使用せずに行えます。</span><span class="sxs-lookup"><span data-stu-id="25036-128">You can do this without relying on Office SSO.</span></span> <span data-ttu-id="25036-129">方法の詳細については、「[Access to Microsoft Graph without SSO (SSO を使用せずに Microsoft Graph にアクセスする)](authorize-to-microsoft-graph-without-sso.md)」を参照してください。この記事には詳細情報やサンプルへのリンクが含まれています。</span><span class="sxs-lookup"><span data-stu-id="25036-129">For more information about how, see [Access to Microsoft Graph without SSO](authorize-to-microsoft-graph-without-sso.md) which has more details and links to samples.</span></span>

## <a name="user-authentication-with-sso"></a><span data-ttu-id="25036-130">SSO を使用したユーザー認証</span><span class="sxs-lookup"><span data-stu-id="25036-130">User authentication with SSO</span></span>

<span data-ttu-id="25036-131">SSO を使用してユーザーを認証するために、作業ウィンドウまたは関数ファイル内のコードが [getAccessTokenAsync](/javascript/api/office/office.auth#getaccesstokenasync-options--callback-) メソッドを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="25036-131">To use SSO to authenticate the user, your code in a task pane or function file calls the [getAccessTokenAsync](/javascript/api/office/office.auth#getaccesstokenasync-options--callback-) method.</span></span> <span data-ttu-id="25036-132">ユーザーが Office にサインインしていない場合、Office でダイアログが開き、Azure Active Directory のログインページに移動します。</span><span class="sxs-lookup"><span data-stu-id="25036-132">If the user is not signed into Office, Office will open a dialog and navigate it to the Azure Active Directory login page.</span></span> <span data-ttu-id="25036-133">ユーザーがサインインすると、またはユーザーが既にサインインしている場合、メソッドによりアクセス トークンが返されます。</span><span class="sxs-lookup"><span data-stu-id="25036-133">After the user is signed in, or if the user is already signed in, the method returns an access token.</span></span> <span data-ttu-id="25036-134">このトークンは、**代理**フロー内のブートストラップ トークンです。</span><span class="sxs-lookup"><span data-stu-id="25036-134">The token is a bootstrap token in the **On Behalf Of** flow.</span></span> <span data-ttu-id="25036-135">(「[Access to Microsoft Graph without SSO (SSO を使用せずに Microsoft Graph にアクセスする)](#access-to-microsoft-graph-with-sso)」を参照してください。) ただし、このトークンには `preferred_username`、`name`、`sub`、および `oid` を含む、現在のユーザーに固有の複数の要求が含まれるため、ID トークンとしても使用できます。</span><span class="sxs-lookup"><span data-stu-id="25036-135">(See [Access to Microsoft Graph with SSO](#access-to-microsoft-graph-with-sso).) However, it can be used as an ID token as well, because it contains several claims that are unique to the current user, including `preferred_username`, `name`, `sub`, and `oid`.</span></span> <span data-ttu-id="25036-136">最終的なユーザー ID として使用するプロパティに関するガイダンスについては、「[Microsoft identity platform access tokens (Microsoft ID プラットフォームのアクセス トークン)](https://docs.microsoft.com/ja-JP/azure/active-directory/develop/access-tokens#payload-claims)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="25036-136">For guidance on which property to use as the ultimate user ID, see [Microsoft identity platform access tokens](https://docs.microsoft.com/en-us/azure/active-directory/develop/access-tokens#payload-claims).</span></span> <span data-ttu-id="25036-137">これらのトークンの例については、「[Example access token (アクセス トークンの例)](sso-in-office-add-ins.md#example-access-token)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="25036-137">For an example of a one of these tokens, see the [Example access token](sso-in-office-add-ins.md#example-access-token).</span></span>

<span data-ttu-id="25036-138">コードにより目的の要求がトークンから抽出されると、管理下のユーザー テーブルまたはユーザー データベース内でその値を使用してユーザーが検索されます。</span><span class="sxs-lookup"><span data-stu-id="25036-138">After your code has extracted the desired claim from the token, it uses that value to look up the user in a user table or user database that you maintain.</span></span> <span data-ttu-id="25036-139">ユーザー設定やユーザーのアカウントの状態などのユーザー関連情報を格納するには、データベースを使用します。</span><span class="sxs-lookup"><span data-stu-id="25036-139">Use the database to store user-relative information such as the user's preferences or the state of the user's account.</span></span> <span data-ttu-id="25036-140">SSO を使用しているため、ユーザーは個別にアドインにサインインを行いません。このため、ユーザーのパスワードを保存する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="25036-140">Since you are using SSO, your users don't sign-in separately to your add-in, so you do not need to store a password for the user.</span></span>

<span data-ttu-id="25036-141">SSO を使用するユーザー認証を実装する前に、「[Office アドインのシングル サインオンを有効化する](sso-in-office-add-ins.md)」の記事を十分に理解しておく必要があります。次のサンプルも確認しておいてください。</span><span class="sxs-lookup"><span data-stu-id="25036-141">Before you begin implementing user authentication with SSO, be sure that you are thoroughly familiar with the article [Enable single sign-on for Office Add-ins](sso-in-office-add-ins.md). Note also these samples:</span></span>

- <span data-ttu-id="25036-142">[Office アドイン NodeJS SSO](https://github.com/OfficeDev/Office-Add-in-NodeJS-SSO): 特に、トークンのデコードと解析に [jswebtoken](https://github.com/auth0/node-jsonwebtoken) ライブラリを使用する [auth.ts](https://github.com/OfficeDev/Office-Add-in-NodeJS-SSO/blob/master/Completed/src/auth.ts) ファイル。</span><span class="sxs-lookup"><span data-stu-id="25036-142">[Office Add-in NodeJS SSO](https://github.com/OfficeDev/Office-Add-in-NodeJS-SSO), especially the file [auth.ts](https://github.com/OfficeDev/Office-Add-in-NodeJS-SSO/blob/master/Completed/src/auth.ts) which uses the library [jswebtoken](https://github.com/auth0/node-jsonwebtoken) to decode and parse the token.</span></span> <span data-ttu-id="25036-143">(ただし、この例では、トークンは ID トークンとしては使用されません。</span><span class="sxs-lookup"><span data-stu-id="25036-143">(This sample, however, does not use the token as an ID token.</span></span> <span data-ttu-id="25036-144">この例では、トークンは、**代理**フローを使用して Microsoft Graph にアクセスするために使用されます。)</span><span class="sxs-lookup"><span data-stu-id="25036-144">It uses it to get access to Microsoft Graph with the **On Behalf Of** flow.)</span></span>
- <span data-ttu-id="25036-145">[Office アドイン ASP.NET SSO](https://github.com/OfficeDev/Office-Add-in-ASPNET-SSO): 特に、トークンから要求を抽出するために [System.Security.Claims.ClaimsPrincipal](https://docs.microsoft.com/dotnet/api/system.security.claims.claimsprincipal) クラスのライブラリを使用する [ValuesController.ts](https://github.com/OfficeDev/Office-Add-in-ASPNET-SSO/blob/master/Complete/Office-Add-in-ASPNET-SSO-WebAPI/Controllers/ValuesController.cs) ファイル。</span><span class="sxs-lookup"><span data-stu-id="25036-145">[Office Add-in ASP.NET SSO](https://github.com/OfficeDev/Office-Add-in-ASPNET-SSO), especially the file [ValuesController.ts](https://github.com/OfficeDev/Office-Add-in-ASPNET-SSO/blob/master/Complete/Office-Add-in-ASPNET-SSO-WebAPI/Controllers/ValuesController.cs) which uses the library [System.Security.Claims.ClaimsPrincipal](https://docs.microsoft.com/dotnet/api/system.security.claims.claimsprincipal) class to extract claims from the token.</span></span> <span data-ttu-id="25036-146">(ただし、この例では、トークンは ID トークンとしては使用されません。</span><span class="sxs-lookup"><span data-stu-id="25036-146">(This sample, however, does not use the token as an ID token.</span></span> <span data-ttu-id="25036-147">この例では `scope` 要求がトークンから抽出され、この要求は、**代理**フローを使用して Microsoft Graph にアクセスするために使用されます。)</span><span class="sxs-lookup"><span data-stu-id="25036-147">It extracts a `scope` claim from the token and uses it to get access to Microsoft Graph with the **On Behalf Of** flow.)</span></span>

## <a name="access-to-microsoft-graph-with-sso"></a><span data-ttu-id="25036-148">SSO を使用した Microsoft Graph へのアクセス</span><span class="sxs-lookup"><span data-stu-id="25036-148">Access to Microsoft Graph with SSO</span></span>

<span data-ttu-id="25036-149">SSO を使用して Microsoft Graph にアクセスするために、作業ウィンドウまたは関数ファイル内のアドインが [getAccessTokenAsync](/javascript/api/office/office.auth#getaccesstokenasync-options--callback-) メソッドを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="25036-149">To use SSO to get access to Microsoft Graph, your add-in in a task pane or function file calls the [getAccessTokenAsync](/javascript/api/office/office.auth#getaccesstokenasync-options--callback-) method.</span></span> <span data-ttu-id="25036-150">ユーザーが Office にサインインしていない場合、Office でダイアログが開き、Azure Active Directory のログインページに移動します。</span><span class="sxs-lookup"><span data-stu-id="25036-150">If the user is not signed into Office, Office will open a dialog and navigate it to the Azure Active Directory login page.</span></span> <span data-ttu-id="25036-151">ユーザーがサインインすると、またはユーザーが既にサインインしている場合、メソッドによりアクセス トークンが返されます。</span><span class="sxs-lookup"><span data-stu-id="25036-151">After the user is signed in, or if the user is already signed in, the method returns an access token.</span></span> <span data-ttu-id="25036-152">このトークンは、**代理**フロー内のブートストラップ トークンです。</span><span class="sxs-lookup"><span data-stu-id="25036-152">The token is a bootstrap token in the **On Behalf Of** flow.</span></span> <span data-ttu-id="25036-153">特に、このトークンには 値 `access_as_user` を持つ `scope` 要求が含まれます。</span><span class="sxs-lookup"><span data-stu-id="25036-153">Specifically, it has a `scope` claim with the value `access_as_user`.</span></span> <span data-ttu-id="25036-154">トークンでの要求に関するガイダンスについては、「[Microsoft identity platform access tokens (Microsoft ID プラットフォームのアクセス トークン)](https://docs.microsoft.com/ja-JP/azure/active-directory/develop/access-tokens#payload-claims)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="25036-154">For guidance about the claims in the token, see [Microsoft identity platform access tokens](https://docs.microsoft.com/en-us/azure/active-directory/develop/access-tokens#payload-claims).</span></span> <span data-ttu-id="25036-155">これらのトークンの例については、「[Example access token (アクセス トークンの例)](sso-in-office-add-ins.md#example-access-token)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="25036-155">For an example of a one of these tokens, see the [Example access token](sso-in-office-add-ins.md#example-access-token).</span></span>

<span data-ttu-id="25036-156">コードがトークンを取得すると、コードは**代理**フロー内でこのトークンを使用して、2 つ目のトークンである Microsoft Graph へのアクセス トークンを取得します。</span><span class="sxs-lookup"><span data-stu-id="25036-156">After your code obtains the token, it uses it in the **On Behalf Of** flow to obtain a second token: an access token to Microsoft Graph.</span></span>

<span data-ttu-id="25036-157">Office SSO の実装を開始する前に、次の 2 つの記事を十分に理解しておく必要があります。</span><span class="sxs-lookup"><span data-stu-id="25036-157">Before you begin implementing Office SSO, be sure that you are thoroughly familiar with these two articles:</span></span>

- [<span data-ttu-id="25036-158">Office アドインのシングル サインオンを有効化する</span><span class="sxs-lookup"><span data-stu-id="25036-158">Enable single sign-on for Office Add-ins</span></span>](sso-in-office-add-ins.md)
- [<span data-ttu-id="25036-159">SSO を使用した Microsoft Graph への承認</span><span class="sxs-lookup"><span data-stu-id="25036-159">Authorize to Microsoft Graph with SSO</span></span>](authorize-to-microsoft-graph.md)

<span data-ttu-id="25036-160">また、ここに示すチュートリアル記事のうち少なくとも 1 つに目を通してください。</span><span class="sxs-lookup"><span data-stu-id="25036-160">You should also read at least one of the walkthrough articles listed here.</span></span> <span data-ttu-id="25036-161">これらの手順を実行しない場合でも、これらの記事にはOffice SSO の実装方法および**代理**フローに関する重要な情報が含まれています。</span><span class="sxs-lookup"><span data-stu-id="25036-161">Even if you don't carry out the steps, these contain valuable information about how you implement Office SSO and the **On Behalf Of** flow.</span></span> 

- [<span data-ttu-id="25036-162">シングル サインオンを使用する ASP.NET Office アドインを作成する</span><span class="sxs-lookup"><span data-stu-id="25036-162">Create an ASP.NET Office Add-in that uses single sign-on</span></span>](create-sso-office-add-ins-aspnet.md)
- [<span data-ttu-id="25036-163">シングル サインオンを使用する Node.js Office アドインを作成する</span><span class="sxs-lookup"><span data-stu-id="25036-163">Create a Node.js Office Add-in that uses single sign-on</span></span>](create-sso-office-add-ins-nodejs.md)

<span data-ttu-id="25036-164">次のサンプルにも目を通してください。</span><span class="sxs-lookup"><span data-stu-id="25036-164">Note also these samples:</span></span>

- [<span data-ttu-id="25036-165">Office アドイン NodeJS SSO</span><span class="sxs-lookup"><span data-stu-id="25036-165">Office Add-in NodeJS SSO</span></span>](https://github.com/OfficeDev/Office-Add-in-NodeJS-SSO)
- [<span data-ttu-id="25036-166">Office アドイン ASP.NET SSO</span><span class="sxs-lookup"><span data-stu-id="25036-166">Office Add-in ASP.NET SSO</span></span>](https://github.com/OfficeDev/Office-Add-in-ASPNET-SSO)

## <a name="access-to-non-microsoft-data-sources"></a><span data-ttu-id="25036-167">Microsoft 以外のデータ ソースへのアクセス</span><span class="sxs-lookup"><span data-stu-id="25036-167">Access to non-Microsoft data sources</span></span>

<span data-ttu-id="25036-168">大手のオンライン サービス (Google、Facebook、LinkedIn、SalesForce、GitHub など) では、開発者は、ユーザーが自分のアカウントに別のアプリケーションからアクセスできるようにすることが可能です。</span><span class="sxs-lookup"><span data-stu-id="25036-168">Popular online services, including Office 365, Google, Facebook, LinkedIn, SalesForce, and GitHub, let developers give users access to their accounts in other applications.</span></span> <span data-ttu-id="25036-169">これにより、開発者はこれらのサービスを Office アドインに含めることができます。</span><span class="sxs-lookup"><span data-stu-id="25036-169">This gives you the ability to include these services in your Office Add-in.</span></span> <span data-ttu-id="25036-170">アドインでこれを実行する方法の概要については、「[Authorize external services in your Office Add-in (Office アドインで外部サービスを承認する)](auth-external-add-ins.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="25036-170">For an overview of the ways that your add-in can do this, see [Authorize external services in your Office Add-in](auth-external-add-ins.md).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="25036-171">コーディングを始める前に、データ ソースのログイン画面を iFrame で開くことがデータ ソースにより許可されているかどうかを確認します。</span><span class="sxs-lookup"><span data-stu-id="25036-171">Before you begin coding, find out if the data source allows its login in screen to be opened in an iFrame.</span></span> <span data-ttu-id="25036-172">Office アドインが *Office on the web* で実行されている場合、作業ウィンドウとして iFrame が使用されます。</span><span class="sxs-lookup"><span data-stu-id="25036-172">When an Office Add-in is running on *Office on the web*, the task pane is an iFrame.</span></span> <span data-ttu-id="25036-173">データ ソースのログインの画面を iFrame で開くことがデータ ソースにより許可されていない場合、ログイン画面は、Office ダイアログ API を使用して開かれるダイアログで開く必要があります。</span><span class="sxs-lookup"><span data-stu-id="25036-173">If the data source does not allow its login screen to be opened in an iFrame, then you will need to open the login screen in a dialog opened with the Office Dialog API.</span></span> <span data-ttu-id="25036-174">詳細については、「[Office ダイアログ API を使用して認証と承認を行う](auth-with-office-dialog-api.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="25036-174">For more information, see [Authentication with the Office Dialog API](auth-with-office-dialog-api.md).</span></span>

