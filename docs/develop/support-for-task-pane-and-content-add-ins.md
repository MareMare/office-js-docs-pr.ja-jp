---
title: Office 2013 でのコンテンツ アドインと作業ウィンドウ アドインの Office JavaScript API のサポート
description: ''
ms.date: 12/04/2017
ms.openlocfilehash: cb4bb003966639fd5518fefcd3983ee9ca2fb101
ms.sourcegitcommit: eb74e94d3e1bc1930a9c6582a0a99355d0da34f2
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/25/2018
ms.locfileid: "25005016"
---
# <a name="office-javascript-api-support-for-content-and-task-pane-add-ins-in-office-2013"></a><span data-ttu-id="bc891-102">Office 2013 でのコンテンツ アドインと作業ウィンドウ アドインの Office JavaScript API のサポート</span><span class="sxs-lookup"><span data-stu-id="bc891-102">Office JavaScript API support for content and task pane add-ins in Office 2013</span></span>


<span data-ttu-id="bc891-p101">[Office JavaScript API](https://docs.microsoft.com/javascript/office/javascript-api-for-office?view=office-js) を使用して、Office 2013 ホスト アプリケーションの作業ウィンドウやコンテンツ用のアドインを作成できます。コンテンツと作業ウィンドウのアドインをサポートするオブジェクトとメソッドは、次のように分類されます。</span><span class="sxs-lookup"><span data-stu-id="bc891-p101">You can use the [Office JavaScript API](https://docs.microsoft.com/javascript/office/javascript-api-for-office?view=office-js) to create task pane or content add-ins for Office 2013 host applications. The objects and methods that content and task pane add-ins support are categorized as follows:</span></span>


1. <span data-ttu-id="bc891-p102">**他の Office アドインと共有する共通のオブジェクト。** これらのオブジェクトには、[Office](https://docs.microsoft.com/javascript/api/office?view=office-js)、[Context](https://docs.microsoft.com/javascript/api/office/office.context?view=office-js)、および [AsyncResult](https://docs.microsoft.com/javascript/api/office/office.asyncresult?view=office-js) があります。**Office** オブジェクトは Office JavaScript API のルート オブジェクトです。**Context** オブジェクトはアドインのランタイム環境を表します。**Office** と **Context** は、いずれも Office アドインの基礎となるオブジェクトです。**AsyncResult** オブジェクトは、ユーザーが文書内で選択したものを読み取る **getSelectedDataAsync** メソッドに返されたデータなどの非同期操作の結果を表します。</span><span class="sxs-lookup"><span data-stu-id="bc891-p102">**Common objects shared with other Office Add-ins.** These objects include [Office](https://docs.microsoft.com/javascript/api/office?view=office-js), [Context](https://docs.microsoft.com/javascript/api/office/office.context?view=office-js), and [AsyncResult](https://docs.microsoft.com/javascript/api/office/office.asyncresult?view=office-js). The  **Office** object is the root object of the Office JavaScript API. The **Context** object represents the add-in's runtime environment. Both **Office** and **Context** are the fundamental objects for any Office Add-in. The **AsyncResult** object represents the results of an asynchronous operation, such as the data returned to the **getSelectedDataAsync** method, which reads what a user has selected in a document.</span></span>
    
2.  <span data-ttu-id="bc891-110">**Document オブジェクト**</span><span class="sxs-lookup"><span data-stu-id="bc891-110">**The Document object**</span></span> <span data-ttu-id="bc891-111">コンテンツ アドインと作業ウィンドウ アドインで連絡可能な API の大部分は、 [ドキュメント](https://docs.microsoft.com/javascript/api/office/office.document?view=office-js) オブジェクトのメソッド、プロパティ、およびイベントを通して公開されます。</span><span class="sxs-lookup"><span data-stu-id="bc891-111">The majority of the API available to content and task pane add-ins is exposed through the methods, properties, and events of the [Document](https://docs.microsoft.com/javascript/api/office/office.document?view=office-js) object. Using this subset of the API, your content or task pane add-in can perform the tasks described later in this topic.</span></span> <span data-ttu-id="bc891-112">コンテンツや作業ウィンドウのアドインは、 [Office.context.document](https://docs.microsoft.com/javascript/api/office/office.context?view=office-js#document)  プロパティを**Document** オブジェクト へのアクセスに使用でき、また、そこからドキュメントのデータ作業するための、 [Bindings](https://docs.microsoft.com/javascript/api/office/office.bindings?view=office-js) 、 [CustomXmlPart](https://docs.microsoft.com/javascript/api/office/office.customxmlparts?view=office-js) オブジェクトや [getSelectedDataAsync](https://docs.microsoft.com/javascript/api/office/office.document?view=office-js#getselecteddataasync-coerciontype--options--callback-) 、 [setSelectedDataAsync](https://docs.microsoft.com/javascript/api/office/office.document?view=office-js#setselecteddataasync-data--options--callback-)、 [getFileAsync](https://docs.microsoft.com/javascript/api/office/office.document?view=office-js#getfileasync-filetype--options--callback-) メソッドなど、APIの主要なメンバーにアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="bc891-112">A content or task pane add-in can use the [Office.context.document](https://docs.microsoft.com/javascript/api/office/office.context?view=office-js#document) property to access the **Document** object, and through it, can access the key members of the API for working with data in documents, such as the [Bindings](https://docs.microsoft.com/javascript/api/office/office.bindings?view=office-js) and [CustomXmlParts](https://docs.microsoft.com/javascript/api/office/office.customxmlparts?view=office-js) objects, and the [getSelectedDataAsync](https://docs.microsoft.com/javascript/api/office/office.document?view=office-js#getselecteddataasync-coerciontype--options--callback-), [setSelectedDataAsync](https://docs.microsoft.com/javascript/api/office/office.document?view=office-js#setselecteddataasync-data--options--callback-), and [getFileAsync](https://docs.microsoft.com/javascript/api/office/office.document?view=office-js#getfileasync-filetype--options--callback-) methods.</span></span> <span data-ttu-id="bc891-113">**Document** オブジェクト は、ドキュメントが読み取り専用か 編集モード かを判断するための  [mode](https://docs.microsoft.com/javascript/api/office/office.document?view=office-js#mode) プロパティ、現在のドキュメントのURLを取得する [URL](https://docs.microsoft.com/javascript/api/office/office.document?view=office-js#url) プロパティ、そして [Settings](https://docs.microsoft.com/javascript/api/office/office.settings?view=office-js) オブジェクトへのアクセスも提供しています。</span><span class="sxs-lookup"><span data-stu-id="bc891-113">The **Document** object also provides the [mode](https://docs.microsoft.com/javascript/api/office/office.document?view=office-js#mode) property for determining whether a document is read-only or in edit mode, the [url](https://docs.microsoft.com/javascript/api/office/office.document?view=office-js#url) property to get the URL of the current document, and access to the [Settings](https://docs.microsoft.com/javascript/api/office/office.settings?view=office-js) object.</span></span> <span data-ttu-id="bc891-114">**Document** オブジェクトは、 [SelectionChanged](https://docs.microsoft.com/javascript/api/office/office.documentselectionchangedeventargs?view=office-js) イベントのイベントハンドラの追加もサポートするので、ユーザーが文書内の選択を変更したら検出できます。</span><span class="sxs-lookup"><span data-stu-id="bc891-114">The **Document** object also supports adding event handlers for the [SelectionChanged](https://docs.microsoft.com/javascript/api/office/office.documentselectionchangedeventargs?view=office-js) event, so you can detect when a user changes their selection in the document.</span></span>
    
   <span data-ttu-id="bc891-p104">コンテンツ アドインや作業ウィンドウ アドインが **Document** オブジェクトにアクセスできるのは、DOM とランタイム環境が [Office.initialize](https://docs.microsoft.com/javascript/api/office?view=office-js) イベント用のイベント ハンドラーなどで読み込まれた後だけです。アドインが初期化されるときのイベント フローと、DOM とラインタイムが正常に読み込まれたかどうかの確認方法については、「[DOM とランタイム環境の読み込み](loading-the-dom-and-runtime-environment.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="bc891-p104">A content or task pane add-in can access the  **Document** object only after the DOM and runtime environment has been loaded, typically in the event handler for the [Office.initialize](https://docs.microsoft.com/javascript/api/office?view=office-js) event. For information about the flow of events when an add-in is initialized, and how to check that the DOM and runtime and loaded successfully, see [Loading the DOM and runtime environment](loading-the-dom-and-runtime-environment.md).</span></span>
    
3.  <span data-ttu-id="bc891-p105">**特定の機能を操作するためのオブジェクト。** API の特定の機能を操作するには、次のオブジェクトとメソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="bc891-p105">**Objects for working with specific features.** To work with specific features of the API, use the following objects and methods:</span></span>
    
    - <span data-ttu-id="bc891-119">[Bindings](https://docs.microsoft.com/javascript/api/office/office.bindings?view=office-js) オブジェクトのメソッドを使用して、バインドを作成または取得します。また、[Binding](https://docs.microsoft.com/javascript/api/office/office.binding?view=office-js) オブジェクトのメソッドとプロパティを使用して、データを操作します。</span><span class="sxs-lookup"><span data-stu-id="bc891-119">The methods of the [Bindings](https://docs.microsoft.com/javascript/api/office/office.bindings?view=office-js) object to create or get bindings, and the methods and properties of the [Binding](https://docs.microsoft.com/javascript/api/office/office.binding?view=office-js) object to work with data.</span></span>
    
    - <span data-ttu-id="bc891-120">[CustomXmlParts](https://docs.microsoft.com/javascript/api/office/office.customxmlparts?view=office-js)、[CustomXmlPart](https://docs.microsoft.com/javascript/api/office/office.customxmlpart?view=office-js)、および関連するオブジェクトを使用して、Word 文書内のカスタム XML パーツを作成および操作します。</span><span class="sxs-lookup"><span data-stu-id="bc891-120">The [CustomXmlParts](https://docs.microsoft.com/javascript/api/office/office.customxmlparts?view=office-js), [CustomXmlPart](https://docs.microsoft.com/javascript/api/office/office.customxmlpart?view=office-js) and associated objects to create and manipulate custom XML parts in Word documents.</span></span>
    
    - <span data-ttu-id="bc891-121">[File](https://docs.microsoft.com/javascript/api/office/office.file?view=office-js) オブジェクトと [Slice](https://docs.microsoft.com/javascript/api/office/office.slice?view=office-js) オブジェクトを使用して、文書全体のコピーを作成し、それをチャンクまたは「スライス」に分割してから、それらのスライスに含まれるデータを読み取りまたは転送します。</span><span class="sxs-lookup"><span data-stu-id="bc891-121">The [File](https://docs.microsoft.com/javascript/api/office/office.file?view=office-js) and [Slice](https://docs.microsoft.com/javascript/api/office/office.slice?view=office-js) objects to create a copy of the entire document, break it into chunks or "slices", and then read or transmit the data in those slices.</span></span>
    
    - <span data-ttu-id="bc891-122">[Settings](https://docs.microsoft.com/javascript/api/office/office.settings?view=office-js) オブジェクトを使用して、ユーザー設定やアドインの状態などのカスタム データを保存します。</span><span class="sxs-lookup"><span data-stu-id="bc891-122">The [Settings](https://docs.microsoft.com/javascript/api/office/office.settings?view=office-js) object to save custom data, such as user preferences, and add-in state.</span></span>
    

> [!IMPORTANT]
> <span data-ttu-id="bc891-123">API メンバーの一部は、コンテンツ アドインと作業ウィンドウ アドインをホスト可能なすべての Office アプリケーションでサポートされているわけではありません。サポートされているメンバーを特定するには、次のいずれかを参照してください。</span><span class="sxs-lookup"><span data-stu-id="bc891-123">Some of the API members aren't supported across all Office applications that can host content and task pane add-ins. To determine which members are supported, see any of the following:</span></span>

<span data-ttu-id="bc891-124">Office ホスト アプリケーション全体にわたる Office JavaScript API サポートの概要については、「[JavaScript API for Office について](understanding-the-javascript-api-for-office.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="bc891-124">For a summary of Office JavaScript API support across Office host applications, see [Understanding the JavaScript API for Office](understanding-the-javascript-api-for-office.md).</span></span>


## <a name="reading-and-writing-to-an-active-selection"></a><span data-ttu-id="bc891-125">アクティブな選択範囲の読み取りと書き込み</span><span class="sxs-lookup"><span data-stu-id="bc891-125">Reading and writing to an active selection</span></span>

<span data-ttu-id="bc891-p106">文書、スプレッドシート、またはプレゼンテーション内のユーザーの現在の選択範囲に対して読み書きをすることができます。アドイン用のホスト アプリケーションに応じて、[Document](https://docs.microsoft.com/javascript/api/office/office.document?view=office-js#getselecteddataasync-coerciontype--options--callback-) オブジェクトの [getSelectedDataAsync](https://docs.microsoft.com/javascript/api/office/office.document?view=office-js#setselecteddataasync-data--options--callback-) メソッドと [setSelectedDataAsync](https://docs.microsoft.com/javascript/api/office/office.document?view=office-js) メソッド内のパラメーターとして読み書きするデータ構造のタイプを指定できます。たとえば、Word には任意のデータ タイプ (テキスト、HTML、表形式データ、または Office Open XML)、Excel にはテキストと表形式データ、および PowerPoint と Project にはテキストを指定できます。ユーザーの選択範囲に対する変更を検出するためのイベント ハンドラーを作成することもできます。以下の例では、**getSelectedDataAsync** メソッドを使用して、選択範囲からデータをテキストとして取得します。</span><span class="sxs-lookup"><span data-stu-id="bc891-p106">You can read or write to the user's current selection in a document, spreadsheet, or presentation. Depending on the host application for your add-in, you can specify the type of data structure to read or write as a parameter in the [getSelectedDataAsync](https://docs.microsoft.com/javascript/api/office/office.document?view=office-js#getselecteddataasync-coerciontype--options--callback-) and [setSelectedDataAsync](https://docs.microsoft.com/javascript/api/office/office.document?view=office-js#setselecteddataasync-data--options--callback-) methods of the [Document](https://docs.microsoft.com/javascript/api/office/office.document?view=office-js) object. For example, you can specify any type of data (text, HTML, tabular data, or Office Open XML) for Word, text and tabular data for Excel, and text for PowerPoint and Project. You can also create event handlers to detect changes to the user's selection. The following example gets data from the selection as text using the **getSelectedDataAsync** method.</span></span>


```js
Office.context.document.getSelectedDataAsync(
    Office.CoercionType.Text, function (asyncResult) {
        if (asyncResult.status == Office.AsyncResultStatus.Failed) {
            write('Action failed. Error: ' + asyncResult.error.message);
        }
        else {
            write('Selected data: ' + asyncResult.value);
        }
    });

// Function that writes to a div with id='message' on the page.
function write(message){
    document.getElementById('message').innerText += message; 
}

```

<span data-ttu-id="bc891-131">詳細と例については、「[ドキュメントやスプレッドシート内のアクティブな選択範囲へのデータの読み取りおよび書き込み](read-and-write-data-to-the-active-selection-in-a-document-or-spreadsheet.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="bc891-131">For more details and examples, see [Read and write data to the active selection in a document or spreadsheet](read-and-write-data-to-the-active-selection-in-a-document-or-spreadsheet.md).</span></span>


## <a name="binding-to-a-region-in-a-document-or-spreadsheet"></a><span data-ttu-id="bc891-132">文書またはスプレッドシート内の領域へのバインド</span><span class="sxs-lookup"><span data-stu-id="bc891-132">Binding to a region in a document or spreadsheet</span></span>

<span data-ttu-id="bc891-p107">**getSelectedDataAsync** メソッドと **setSelectedDataAsync** メソッドを使用して、文書、スプレッドシート、またはプレゼンテーション内のユーザーの*現在*の選択範囲を読み取りまたは書き込みできます。ただし、ユーザーに選択を要求せずにアドインの複数の実行セッションに渡って文書内の同じ領域にアクセスする場合は、最初にその領域をバインドする必要があります。そのバインドした領域に対するデータおよび選択範囲変更イベントにサブスクライブすることもできます。</span><span class="sxs-lookup"><span data-stu-id="bc891-p107">You can use the  **getSelectedDataAsync** and **setSelectedDataAsync** methods to read or write to the user's *current* selection in a document, spreadsheet, or presentation. However, if you would like to access the same region in a document across sessions of running your add-in without requiring the user to make a selection, you should first bind to that region. You can also subscribe to data and selection change events for that bound region.</span></span>

<span data-ttu-id="bc891-p108">バインドは、[Bindings](https://docs.microsoft.com/javascript/api/office/office.bindings?view=office-js#addfromnameditemasync-itemname--bindingtype--options--callback-) オブジェクトの [addFromNamedItemAsync](https://docs.microsoft.com/javascript/api/office/office.bindings?view=office-js#addfrompromptasync-bindingtype--options--callback-) メソッド、[addFromPromptAsync](https://docs.microsoft.com/javascript/api/office/office.bindings?view=office-js#addfromselectionasync-bindingtype--options--callback-) メソッド、または [addFromSelectionAsync](https://docs.microsoft.com/javascript/api/office/office.bindings?view=office-js) メソッドを使用して追加できます。これらのメソッドは、バインド内のデータにアクセスするため、あるいは、データ変更または選択範囲変更イベントにサブスクライブするために使用可能な識別子を返します。</span><span class="sxs-lookup"><span data-stu-id="bc891-p108">You can add a binding by using [addFromNamedItemAsync](https://docs.microsoft.com/javascript/api/office/office.bindings?view=office-js#addfromnameditemasync-itemname--bindingtype--options--callback-), [addFromPromptAsync](https://docs.microsoft.com/javascript/api/office/office.bindings?view=office-js#addfrompromptasync-bindingtype--options--callback-), or [addFromSelectionAsync](https://docs.microsoft.com/javascript/api/office/office.bindings?view=office-js#addfromselectionasync-bindingtype--options--callback-) methods of the [Bindings](https://docs.microsoft.com/javascript/api/office/office.bindings?view=office-js) object. These methods return an identifier that you can use to access data in the binding, or to subscribe to its data change or selection change events.</span></span>

<span data-ttu-id="bc891-138">**Bindings.addFromSelectionAsync** メソッドを使用して、文書内で現在選択されているテキストにバインドを追加する例を次に示します。</span><span class="sxs-lookup"><span data-stu-id="bc891-138">The following is an example that adds a binding to the currently selected text in a document, by using the  **Bindings.addFromSelectionAsync** method.</span></span>



```js
Office.context.document.bindings.addFromSelectionAsync(
    Office.BindingType.Text, { id: 'myBinding' }, function (asyncResult) {
    if (asyncResult.status == Office.AsyncResultStatus.Failed) {
        write('Action failed. Error: ' + asyncResult.error.message);
    } else {
        write('Added new binding with type: ' +
            asyncResult.value.type + ' and id: ' + asyncResult.value.id);
    }
});

// Function that writes to a div with id='message' on the page.
function write(message){
    document.getElementById('message').innerText += message; 
}
```

<span data-ttu-id="bc891-139">詳細と例については、「[ドキュメントまたはスプレッドシート内の領域へのバインド](bind-to-regions-in-a-document-or-spreadsheet.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="bc891-139">For more details and examples, see [Bind to regions in a document or spreadsheet](bind-to-regions-in-a-document-or-spreadsheet.md).</span></span>


## <a name="getting-entire-documents"></a><span data-ttu-id="bc891-140">文書全体の取得</span><span class="sxs-lookup"><span data-stu-id="bc891-140">Getting entire documents</span></span>

<span data-ttu-id="bc891-141">作業ウィンドウ アドインが PowerPoint または Word で実行される場合は、[Document.getFileAsync](https://docs.microsoft.com/javascript/api/office/office.document?view=office-js#getfileasync-filetype--options--callback-) メソッド、[File.getSliceAsync](https://docs.microsoft.com/javascript/api/office/office.file?view=office-js#getsliceasync-sliceindex--callback-) メソッド、および [File.closeAsync](https://docs.microsoft.com/javascript/api/office/office.file?view=office-js#closeasync-callback-) メソッドを使用して、プレゼンテーションまたは文書全体を取得できます。</span><span class="sxs-lookup"><span data-stu-id="bc891-141">If your task pane add-in runs in PowerPoint or Word, you can use the [Document.getFileAsync](https://docs.microsoft.com/javascript/api/office/office.document?view=office-js#getfileasync-filetype--options--callback-), [File.getSliceAsync](https://docs.microsoft.com/javascript/api/office/office.file?view=office-js#getsliceasync-sliceindex--callback-), and [File.closeAsync](https://docs.microsoft.com/javascript/api/office/office.file?view=office-js#closeasync-callback-) methods to get an entire presentation or document.</span></span>

<span data-ttu-id="bc891-p109">**Document.getFileAsync** を呼び出すと、[File](https://docs.microsoft.com/javascript/api/office/office.file?view=office-js) オブジェクトに文書のコピーが返されます。**File** オブジェクトは、[Slice](https://docs.microsoft.com/javascript/api/office/office.slice?view=office-js) オブジェクトとして表現される「チャンク」内の文書へのアクセスを提供します。**getFileAsync** を呼び出すときに、ファイル タイプ (テキストまたは圧縮 Open Office XML 形式) とスライスのサイズ (4 MB 以下) を指定できます。**File** オブジェクトの内容にアクセスするには、**Slice.data** プロパティに生データを返す [File.getSliceAsync](https://docs.microsoft.com/javascript/api/office/office.slice?view=office-js#data) を呼び出します。圧縮形式を指定した場合は、ファイル データがバイト配列で返されます。ファイルを Web サービスに転送する場合は、圧縮生データを base64 エンコード文字列に変換してから送信できます。最後に、ファイルのスライスの取得が完了したら、**File.closeAsync** メソッドを使用して文書を閉じます。</span><span class="sxs-lookup"><span data-stu-id="bc891-p109">When you call  **Document.getFileAsync**, you get a copy of the document in a [File](https://docs.microsoft.com/javascript/api/office/office.file?view=office-js) object. The **File** object provides access to the document in "chunks" represented as [Slice](https://docs.microsoft.com/javascript/api/office/office.slice?view=office-js) objects. When you call **getFileAsync**, you can specify the file type (text or compressed Open Office XML format), and size of the slices (up to 4MB). To access the contents of the  **File** object, you then call **File.getSliceAsync** which returns the raw data in the [Slice.data](https://docs.microsoft.com/javascript/api/office/office.slice?view=office-js#data) property. If you specified compressed format, you will get the file data as a byte array. If you are transmitting the file to a web service, you can transform the compressed raw data to a base64-encoded string before submission. Finally, when you are finished getting slices of the file, use the **File.closeAsync** method to close the document.</span></span>

<span data-ttu-id="bc891-149">詳細については、[PowerPoint や Word 用のアドインからドキュメント全体を取得する](../word/get-the-whole-document-from-an-add-in-for-word.md)方法を参照してください。</span><span class="sxs-lookup"><span data-stu-id="bc891-149">For more details, see how to [get the whole document from an add-in for PowerPoint or Word](../word/get-the-whole-document-from-an-add-in-for-word.md).</span></span> 


## <a name="reading-and-writing-custom-xml-parts-of-a-word-document"></a><span data-ttu-id="bc891-150">Word 文書のカスタム XML パーツの読み取りと書き込み</span><span class="sxs-lookup"><span data-stu-id="bc891-150">Reading and writing custom XML parts of a Word document</span></span>

<span data-ttu-id="bc891-p110">Open Office XML ファイル形式とコンテンツ コントロールを使用すれば、Word 文書にカスタム XML パーツを追加して、その文書内のコンテンツ コントロールに XML パーツ内の要素をバインドすることができます。文書を開くと、Word がバインドされたコンテンツ コントロールを読み取り、カスタム XML パーツからのデータを自動的に設定します。ユーザーは、コンテンツ コントロールにデータを書き込むこともできます。ユーザーが文書を保存すると、コントロール内のデータがバインドされた XML パーツに保存されます。Word 用の作業ウィンドウ アドインは、[Document.customXmlParts](https://docs.microsoft.com/javascript/api/office/office.document?view=office-js.customxmlparts) プロパティ、[CustomXmlParts](https://docs.microsoft.com/javascript/api/office/office.customxmlparts?view=office-js) オブジェクト、[CustomXmlPart](https://docs.microsoft.com/javascript/api/office/office.customxmlpart?view=office-js) オブジェクト、および [CustomXmlNode](https://docs.microsoft.com/javascript/api/office/office.customxmlnode?view=office-js) オブジェクトを使用して、文書に対して動的にデータを読み書きすることができます。</span><span class="sxs-lookup"><span data-stu-id="bc891-p110">Using the Open Office XML file format and content controls, you can add custom XML parts to a Word document and bind elements in the XML parts to content controls in that document. When you open the document, Word reads and automatically populates bound content controls with data from the custom XML parts. Users can also write data into the content controls, and when the user saves the document, the data in the controls will be saved to the bound XML parts. Task pane add-ins for Word, can use the [Document.customXmlParts](https://docs.microsoft.com/javascript/api/office/office.document?view=office-js.customxmlparts) property,[CustomXmlParts](https://docs.microsoft.com/javascript/api/office/office.customxmlparts?view=office-js), [CustomXmlPart](https://docs.microsoft.com/javascript/api/office/office.customxmlpart?view=office-js), and [CustomXmlNode](https://docs.microsoft.com/javascript/api/office/office.customxmlnode?view=office-js) objects to read and write data dynamically to the document.</span></span>

<span data-ttu-id="bc891-p111">カスタム XML パーツは名前空間に関連付けることができます。名前空間内のカスタム XML パーツからデータを取得するには、[CustomXmlParts.getByNamespaceAsync](https://docs.microsoft.com/javascript/api/office/office.customxmlparts?view=office-js#getbynamespaceasync-ns--options--callback-) メソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="bc891-p111">Custom XML parts may be associated with namespaces. To get data from custom XML parts in a namespace, use the [CustomXmlParts.getByNamespaceAsync](https://docs.microsoft.com/javascript/api/office/office.customxmlparts?view=office-js#getbynamespaceasync-ns--options--callback-) method.</span></span>

<span data-ttu-id="bc891-p112">[CustomXmlParts.getByIdAsync](https://docs.microsoft.com/javascript/api/office/office.customxmlparts?view=office-js#getbyidasync-id--options--callback-) メソッドを使用して、GUID でカスタム XML パーツにアクセスすることもできます。カスタム XML パーツを取得したら、[CustomXmlPart.getXmlAsync](https://docs.microsoft.com/javascript/api/office/office.customxmlpart?view=office-js#getxmlasync-options--callback-) メソッドを使用して XML データを取得します。</span><span class="sxs-lookup"><span data-stu-id="bc891-p112">You can also use the [CustomXmlParts.getByIdAsync](https://docs.microsoft.com/javascript/api/office/office.customxmlparts?view=office-js#getbyidasync-id--options--callback-) method to access custom XML parts by their GUIDs. After getting a custom XML part, use the [CustomXmlPart.getXmlAsync](https://docs.microsoft.com/javascript/api/office/office.customxmlpart?view=office-js#getxmlasync-options--callback-) method to get the XML data.</span></span>

<span data-ttu-id="bc891-159">文書に新しいカスタム XML パーツを追加するには、**Document.customXmlParts** プロパティを使用して文書内に存在するカスタム XML パーツを取得し、[CustomXmlParts.addAsync](https://docs.microsoft.com/javascript/api/office/office.customxmlparts?view=office-js#addasync-xml--options--callback-) メソッドを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="bc891-159">To add a new custom XML part to a document, use the  **Document.customXmlParts** property to get the custom XML parts that are in the document, and call the [CustomXmlParts.addAsync](https://docs.microsoft.com/javascript/api/office/office.customxmlparts?view=office-js#addasync-xml--options--callback-) method.</span></span>

<span data-ttu-id="bc891-160">作業ウィンドウ アドインでのカスタム XML パーツの操作方法の詳細については、「[Office Open XML を使用してより良い Word 用アドインを作成する](../word/create-better-add-ins-for-word-with-office-open-xml.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="bc891-160">For detailed information about how to work with custom XML parts with a task pane add-in, see [Creating Better Add-ins for Word with Office Open XML](../word/create-better-add-ins-for-word-with-office-open-xml.md).</span></span>


## <a name="persisting-add-in-settings"></a><span data-ttu-id="bc891-161">アドイン設定を保存する</span><span class="sxs-lookup"><span data-stu-id="bc891-161">Persisting add-in settings</span></span>


<span data-ttu-id="bc891-p113">多くの場合、ユーザー設定やアドインの状態など、アドインのカスタム データを保存し、次回、アドインを開いたとき、そのデータにアクセスする必要があります。一般的な Web プログラミング手法を利用し、ブラウザーの Cookie や HTML 5 Web ストレージなど、そのデータを保存できます。あるいは、アドインを Excel、PowerPoint、Word で実行する場合、[Settings](https://docs.microsoft.com/javascript/api/office/office.settings?view=office-js) オブジェクトのメソッドを使用できます。**Settings** オブジェクトで作成したデータは、アドインを挿入して保存したスプレッドシート、プレゼンテーション、文書に保存されます。このデータは、それを作成したアドインでのみ利用できます。</span><span class="sxs-lookup"><span data-stu-id="bc891-p113">Often you need to save custom data for your add-in, such as a user's preferences or the add-in's state, and access that data the next time the add-in is opened. You can use common web programming techniques to save that data, such as browser cookies or HTML 5 web storage. Alternatively, if your add-in runs in Excel, PowerPoint, or Word, you can use the methods of the [Settings](https://docs.microsoft.com/javascript/api/office/office.settings?view=office-js) object. Data created with the **Settings** object is stored in the spreadsheet, presentation, or document that the add-in was inserted into and saved with. This data is available to only the add-in that created it.</span></span>

<span data-ttu-id="bc891-167">ドキュメントが保存されているサーバーへのラウンドト リップを避けるために、 **設定** オブジェクトで作成されたデータは実行時にメモリ内で管理されます。</span><span class="sxs-lookup"><span data-stu-id="bc891-167">To avoid roundtrips to the server where the document is stored, data created with the **Settings** object is managed in memory at run time.</span></span> <span data-ttu-id="bc891-168">以前に保存したデータはアドインが初期化される時にメモリに読み込まれ、 [Settings.saveAsync](https://docs.microsoft.com/javascript/api/office/office.settings?view=office-js#saveasync-options--callback-) メソッドを呼び出す時、データが文書のみに保存されます。</span><span class="sxs-lookup"><span data-stu-id="bc891-168">Previously saved settings data is loaded into memory when the add-in is initialized, and changes to that data are only saved back to the document when you call the [Settings.saveAsync](https://docs.microsoft.com/javascript/api/office/office.settings?view=office-js#saveasync-options--callback-) method.</span></span> <span data-ttu-id="bc891-169">内部的には、データはシリアル化された JSON オブジェクトの名前と値のペアとして格納されます。</span><span class="sxs-lookup"><span data-stu-id="bc891-169">Internally, the data is stored in a serialized JSON object as name/value pairs.</span></span> <span data-ttu-id="bc891-170">データのメモリ内コピーからアイテムの読み取り、書き込み、および削除をするには、 **設定**オブジェクトの [取得](https://docs.microsoft.com/javascript/api/office/office.settings?view=office-js#get-name-)、 [設定](https://docs.microsoft.com/javascript/api/office/office.settings?view=office-js#set-name--value-) 、および [削除](https://docs.microsoft.com/javascript/api/office/office.settings?view=office-js#remove-name-) のメソッドを使用します。</span><span class="sxs-lookup"><span data-stu-id="bc891-170">You use the [get](https://docs.microsoft.com/javascript/api/office/office.settings?view=office-js#get-name-), [set](https://docs.microsoft.com/javascript/api/office/office.settings?view=office-js#set-name--value-), and [remove](https://docs.microsoft.com/javascript/api/office/office.settings?view=office-js#remove-name-) methods of the **Settings** object, to read, write, and delete items from the in-memory copy of the data.</span></span> <span data-ttu-id="bc891-171">次のコード行は名前の設定を作成する方法を示し `themeColor` '緑' の値を設定します。</span><span class="sxs-lookup"><span data-stu-id="bc891-171">The following line of code shows how to create a setting named `themeColor` and set its value to 'green'.</span></span>




```js
Office.context.document.settings.set('themeColor', 'green');
```

<span data-ttu-id="bc891-172">**set** メソッドと **remove** メソッドを使用した設定データの作成または削除はそのデータのメモリ内コピーに対して機能するため、**saveAsync** を呼び出して、設定データに対する変更をアドインが操作する文書内に保持する必要があります。</span><span class="sxs-lookup"><span data-stu-id="bc891-172">Because settings data created or deleted with the  **set** and **remove** methods is acting on an in-memory copy of the data, you must call **saveAsync** to persist changes to settings data into the document your add-in is working with.</span></span>

<span data-ttu-id="bc891-173">**Settings** オブジェクトのメソッドを使用したカスタム データの操作方法の詳細については、「[アドインの状態および設定を保持する](persisting-add-in-state-and-settings.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="bc891-173">For more details about working with custom data using the methods of the  **Settings** object, see [Persisting add-in state and settings](persisting-add-in-state-and-settings.md).</span></span>


## <a name="reading-properties-of-a-project-document"></a><span data-ttu-id="bc891-174">プロジェクト文書のプロパティの読み取り</span><span class="sxs-lookup"><span data-stu-id="bc891-174">Reading properties of a project document</span></span>

<span data-ttu-id="bc891-p115">作業ウィンドウ アドインが Project で動作する場合は、そのアドインでアクティブ プロジェクト内のプロジェクト フィールド、リソース、およびタスク フィールドの一部からデータを読み取ることができます。これを実現するには、追加の Project 固有の機能を提供するように [Document](https://docs.microsoft.com/javascript/api/office/office.document?view=office-js) オブジェクトを拡張する **ProjectDocument** オブジェクトのメソッドとイベントを使用します。</span><span class="sxs-lookup"><span data-stu-id="bc891-p115">If your task pane add-in runs in Project, your add-in can read data from some of the project fields, resource, and task fields in the active project. To do that, you use the methods and events of the [ProjectDocument](https://docs.microsoft.com/javascript/api/office/office.document?view=office-js) object, which extends the **Document** object to provide additional Project-specific functionality.</span></span>

<span data-ttu-id="bc891-177">Project データの読み取りの例については、「[テキスト エディターを使用して Project 2013 用の作業ウィンドウ アドインを初めて作成する](../project/create-your-first-task-pane-add-in-for-project-by-using-a-text-editor.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="bc891-177">For examples of reading Project data, see [Create your first task pane add-in for Project 2013 by using a text editor](../project/create-your-first-task-pane-add-in-for-project-by-using-a-text-editor.md).</span></span>


## <a name="permissions-model-and-governance"></a><span data-ttu-id="bc891-178">アクセス許可モデルとガバナンス</span><span class="sxs-lookup"><span data-stu-id="bc891-178">Permissions model and governance</span></span>

<span data-ttu-id="bc891-p116">アドインは、そのマニフェスト内の **Permissions** 要素を使用して、必要な機能のレベルにアクセスするためのアクセス許可を Office JavaScript API に要求します。たとえば、アドインで文書に対する読み取りと書き込みアクセス権が必要な場合は、そのマニフェストで `ReadWriteDocument` をその **Permissions** 要素内のテキスト値として指定する必要があります。アクセス許可はユーザーのプライバシーとセキュリティを保護するために存在しているので、ベスト プラクティスとしては、その機能に必要な最低限のアクセス許可を要求することをお勧めします。次の例は、作業ウィンドウのマニフェストで **ReadDocument** アクセス許可を要求する方法を示しています。</span><span class="sxs-lookup"><span data-stu-id="bc891-p116">Your add-in uses the  **Permissions** element in its manifest to request permission to access the level of functionality it requires from the Office JavaScript API. For example, if your add-in requires read/write access to the document, its manifest must specify `ReadWriteDocument` as the text value in its **Permissions** element. Because permissions exist to protect a user's privacy and security, as a best practice you should request the minimum level of permissions it needs for its features. The following example shows how to request the **ReadDocument** permission in a task pane's manifest.</span></span>


```XML
<?xml version="1.0" encoding="utf-8"?>
<OfficeApp xmlns="http://schemas.microsoft.com/office/appforoffice/1.0"
 xmlns:xsi="https://www.w3.org/2001/XMLSchema-instance" 
 xsi:type="TaskPaneApp">
???<!-- Other manifest elements omitted. -->
  <Permissions>ReadDocument</Permissions>
???
</OfficeApp>

```

<span data-ttu-id="bc891-183">詳細については、「[コンテンツ アドインおよび作業ウィンドウ アドインでの API 使用のアクセス許可を要求する](requesting-permissions-for-api-use-in-content-and-task-pane-add-ins.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="bc891-183">For more information, see [Requesting permissions for API use in content and task pane add-ins](requesting-permissions-for-api-use-in-content-and-task-pane-add-ins.md).</span></span>


## <a name="see-also"></a><span data-ttu-id="bc891-184">関連項目</span><span class="sxs-lookup"><span data-stu-id="bc891-184">See also</span></span>

- [<span data-ttu-id="bc891-185">Office の JavaScript API</span><span class="sxs-lookup"><span data-stu-id="bc891-185">Office JavaScript API</span></span>](https://docs.microsoft.com/javascript/office/javascript-api-for-office?view=office-js)
- [<span data-ttu-id="bc891-186">Office アドイン マニフェストのスキーマ参照</span><span class="sxs-lookup"><span data-stu-id="bc891-186">Schema reference for Office Add-ins manifests</span></span>](../develop/add-in-manifests.md)
- [<span data-ttu-id="bc891-187">Office アドインでのユーザー エラーのトラブルシューティング</span><span class="sxs-lookup"><span data-stu-id="bc891-187">Troubleshoot user errors with Office Add-ins</span></span>](../testing/testing-and-troubleshooting.md)
    
