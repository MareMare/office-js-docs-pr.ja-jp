---
title: アドインでの API 使用についてアクセス許可を要求する
description: コンテンツ アドインまたは作業ウィンドウ アドインのマニフェストで宣言するさまざまなアクセス許可レベルについて説明し、JavaScript API アクセスのレベルを指定します。
ms.date: 03/19/2019
localization_priority: Normal
ms.openlocfilehash: bdc23d1d8d5ff044a14306a868567864865c012d
ms.sourcegitcommit: ee9e92a968e4ad23f1e371f00d4888e4203ab772
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/23/2021
ms.locfileid: "53075972"
---
# <a name="requesting-permissions-for-api-use-in-add-ins"></a><span data-ttu-id="579b0-103">アドインでの API 使用についてアクセス許可を要求する</span><span class="sxs-lookup"><span data-stu-id="579b0-103">Requesting permissions for API use in add-ins</span></span>

<span data-ttu-id="579b0-104">この記事では、アドインの機能のために必要となる JavaScript API アクセスのレベルを指定するために、コンテンツ アドインまたは作業ウィンドウ アドインのマニフェストで宣言できるさまざまなアクセス許可レベルについて説明します。</span><span class="sxs-lookup"><span data-stu-id="579b0-104">This article describes the different permission levels that you can declare in your content or task pane add-in's manifest to specify the level of JavaScript API access your add-in requires for its features.</span></span> 

## <a name="permissions-model"></a><span data-ttu-id="579b0-105">アクセス許可モデル</span><span class="sxs-lookup"><span data-stu-id="579b0-105">Permissions model</span></span>

<span data-ttu-id="579b0-106">5 レベルの JavaScript API アクセス許可モデルは、コンテンツ アドインと作業ウィンドウ アドインでのユーザーのプライバシーとセキュリティの基礎となります。図 1 に、アドイン マニフェストで宣言できる 5 レベルの API アクセス許可を示します。</span><span class="sxs-lookup"><span data-stu-id="579b0-106">A five-level JavaScript API access-permissions model provides the basis for privacy and security for users of your content and task pane add-ins. Figure 1 shows the five levels of API permissions you can declare in your add-in's manifest.</span></span>

<span data-ttu-id="579b0-107">*図 1. コンテンツ アドインと作業ウィンドウ アドインの 5 レベル アクセス許可モデル*</span><span class="sxs-lookup"><span data-stu-id="579b0-107">*Figure 1. The five-level permission model for content and task pane add-ins*</span></span>

![作業ウィンドウ アプリのアクセス許可のレベル。](../images/office15-app-sdk-task-pane-app-permission.png)

<span data-ttu-id="579b0-p101">これらのアクセス許可は、ユーザーがアドインを挿入してアクティブ化 (信頼) したときに、アドイン ランタイムがコンテンツ アドインまたはタスク ウィンドウ アドインに使用を許可する API のサブセットを指定します。コンテンツ アドインまたは作業ウィンドウ アドインに必要なアクセス許可レベルを宣言するには、アドインのマニフェストの [Permissions](../reference/manifest/permissions.md) 要素に、いずれかのアクセス許可テキスト値を指定します。以下の例では、ドキュメントに書き込みができる (しかし読み取りはできない) メソッドだけを許可する、 **WriteDocument** アクセス許可を要求します。</span><span class="sxs-lookup"><span data-stu-id="579b0-p101">These permissions specify the subset of the API that the add-in runtime will allow your content or task pane add-in to use when a user inserts, and then activates (trusts) your add-in. To declare the permission level your content or task pane add-in requires, specify one of the permission text values in the [Permissions](../reference/manifest/permissions.md) element of your add-in's manifest. The following example requests the **WriteDocument** permission, which will allow only methods that can write to (but not read) the document.</span></span>

```XML
<Permissions>WriteDocument</Permissions>
```

<span data-ttu-id="579b0-p102">ベスト プラクティスとしては、_最小限の特権_ の原則に基づいてアクセス許可を要求するべきです。つまり、アドインが正しく機能するために必要な最小限の API サブセットにのみアクセスする許可を要求します。たとえば、ユーザーのドキュメントのデータさえ読み込めばアドインが正しく機能する場合、**ReadDocument** 以外のアクセス許可を要求しません。</span><span class="sxs-lookup"><span data-stu-id="579b0-p102">As a best practice, you should request permissions based on the principle of  _least privilege_. That is, you should request permission to access only the minimum subset of the API that your add-in requires to function correctly. For example, if your add-in needs only to read data in a user's document for its features, you should request no more than the **ReadDocument** permission.</span></span>

<span data-ttu-id="579b0-115">各レベルのアクセス許可で使用可能になる JavaScript API のサブセットを次の表に示します。</span><span class="sxs-lookup"><span data-stu-id="579b0-115">The following table describes the subset of the JavaScript API that is enabled by each permission level.</span></span>

|<span data-ttu-id="579b0-116">**アクセス許可**</span><span class="sxs-lookup"><span data-stu-id="579b0-116">**Permission**</span></span>|<span data-ttu-id="579b0-117">**使用可能な API のサブセット**</span><span class="sxs-lookup"><span data-stu-id="579b0-117">**Enabled subset of the API**</span></span>|
|:-----|:-----|
|<span data-ttu-id="579b0-118">**Restricted**</span><span class="sxs-lookup"><span data-stu-id="579b0-118">**Restricted**</span></span>|<span data-ttu-id="579b0-119">[Settings](/javascript/api/office/office.settings) オブジェクトのメソッドと [Document.getActiveViewAsync](/javascript/api/office/office.document#getactiveviewasync-options--callback-) メソッド。これは、コンテンツ アドインまたは作業ウィンドウ アドインで要求することができる、最小のアクセス許可レベルです。</span><span class="sxs-lookup"><span data-stu-id="579b0-119">The methods of the [Settings](/javascript/api/office/office.settings) object, and the [Document.getActiveViewAsync](/javascript/api/office/office.document#getactiveviewasync-options--callback-) method.This is the minimum permission level that can be requested by a content or task pane add-in.</span></span>|
|<span data-ttu-id="579b0-120">**ReadDocument**</span><span class="sxs-lookup"><span data-stu-id="579b0-120">**ReadDocument**</span></span>|<span data-ttu-id="579b0-121">制限付きアクセス許可によって許可されるAPI に加えて、ドキュメントの読み取りおよびバインドの管理に必要な API メンバーへのアクセスを追加します。これには、次の使用が含まれます。</span><span class="sxs-lookup"><span data-stu-id="579b0-121">In addition to the API allowed by the **Restricted** permission, adds access to the API members necessary to read the document and manage bindings.This includes the use of:</span></span><br/><ul><li><span data-ttu-id="579b0-122">選択されたテキスト、HTML (Word のみ)、または表形式のデータは取得するが、ドキュメント内のすべてのデータを含んでいる基礎となる Open Office XML (OOXML) コードは取得しない、<a href="/javascript/api/office/office.document#getselecteddataasync-coerciontype--options--callback-" target="_blank">Document.getSelectedDataAsync</a> メソッド。</span><span class="sxs-lookup"><span data-stu-id="579b0-122">The <a href="/javascript/api/office/office.document#getselecteddataasync-coerciontype--options--callback-" target="_blank">Document.getSelectedDataAsync</a> method to get the selected text, HTML (Word only), or tabular data, but not the underlying Open Office XML (OOXML) code that contains all of the data in the document.</span></span></p></li><li><p><span data-ttu-id="579b0-123">ドキュメント内のすべてのテキストを取得するが、基礎となるドキュメントの OOXML バイナリ コピーは取得しない、<a href="/javascript/api/office/office.document#getfileasync-filetype--options--callback-" target="_blank">Document.getFileAsync</a> メソッド。</span><span class="sxs-lookup"><span data-stu-id="579b0-123">The <a href="/javascript/api/office/office.document#getfileasync-filetype--options--callback-" target="_blank">Document.getFileAsync</a> method to get all of the text in the document, but not the underlying OOXML binary copy of the document.</span></span></p></li><li><p><span data-ttu-id="579b0-124">ドキュメント内のバインドされたデータを読み取るための <a href="/javascript/api/office/office.binding#getdataasync-options--callback-" target="_blank">Binding.getDataAsync</a> メソッド。</span><span class="sxs-lookup"><span data-stu-id="579b0-124">The <a href="/javascript/api/office/office.binding#getdataasync-options--callback-" target="_blank">Binding.getDataAsync</a> method for reading bound data in the document.</span></span></p></li><li><p><span data-ttu-id="579b0-125">ドキュメントでバインディングを作成するための <a href="/javascript/api/office/office.bindings#addfromnameditemasync-itemname--bindingtype--options--callback-" target="_blank">Bindings</a> オブジェクトの <a href="/javascript/api/office/office.bindings#addfrompromptasync-bindingtype--options--callback-" target="_blank">addFromNamedItemAsync</a>、<a href="/javascript/api/office/office.bindings#addfromselectionasync-bindingtype--options--callback-" target="_blank">addFromPromptAsync</a>、<span class="keyword">addFromSelectionAsync</span> の各メソッド。</span><span class="sxs-lookup"><span data-stu-id="579b0-125">The <a href="/javascript/api/office/office.bindings#addfromnameditemasync-itemname--bindingtype--options--callback-" target="_blank">addFromNamedItemAsync</a>, <a href="/javascript/api/office/office.bindings#addfrompromptasync-bindingtype--options--callback-" target="_blank">addFromPromptAsync</a>, <a href="/javascript/api/office/office.bindings#addfromselectionasync-bindingtype--options--callback-" target="_blank">addFromSelectionAsync</a> methods of the <span class="keyword">Bindings</span> object for creating bindings in the document.</span></span></p></li><li><p><span data-ttu-id="579b0-126">ドキュメントでバインディングにアクセスしてそれを削除するための <a href="/javascript/api/office/office.bindings#getallasync-options--callback-" target="_blank">Bindings</a> オブジェクトの <a href="/javascript/api/office/office.bindings#getbyidasync-id--options--callback-" target="_blank">getAllAsync</a>、<a href="/javascript/api/office/office.bindings#releasebyidasync-id--options--callback-" target="_blank">getByIdAsync</a>、および <span class="keyword">releaseByIdAsync</span> の各メソッド。</span><span class="sxs-lookup"><span data-stu-id="579b0-126">The <a href="/javascript/api/office/office.bindings#getallasync-options--callback-" target="_blank">getAllAsync</a>, <a href="/javascript/api/office/office.bindings#getbyidasync-id--options--callback-" target="_blank">getByIdAsync</a>, and <a href="/javascript/api/office/office.bindings#releasebyidasync-id--options--callback-" target="_blank">releaseByIdAsync</a> methods of the <span class="keyword">Bindings</span> object for accessing and removing bindings in the document.</span></span></p></li><li><p><span data-ttu-id="579b0-127">ドキュメントの URL など、ドキュメント ファイルのプロパティにアクセスするための <a href="/javascript/api/office/office.document#getfilepropertiesasync-options--callback-" target="_blank">Document.getFilePropertiesAsync</a> メソッド。</span><span class="sxs-lookup"><span data-stu-id="579b0-127">The <a href="/javascript/api/office/office.document#getfilepropertiesasync-options--callback-" target="_blank">Document.getFilePropertiesAsync</a> method to access document file properties, such as the URL of the document.</span></span></p></li><li><p><span data-ttu-id="579b0-128">ドキュメント内で名前付きオブジェクトや場所に移動するための <a href="/javascript/api/office/office.document#gotobyidasync-id--gototype--options--callback-" target="_blank">Document.goToByIdAsync</a> メソッド。</span><span class="sxs-lookup"><span data-stu-id="579b0-128">The <a href="/javascript/api/office/office.document#gotobyidasync-id--gototype--options--callback-" target="_blank">Document.goToByIdAsync</a> method to navigate to named objects and locations in the document.</span></span></p></li><li><p><span data-ttu-id="579b0-129">Project 用の作業ウィンドウ アドインについては、<a href="/javascript/api/office/office.document" target="_blank">ProjectDocument</a> オブジェクトのすべての "get" メソッド。</span><span class="sxs-lookup"><span data-stu-id="579b0-129">For task pane add-ins for Project, all of the "get" methods of the <a href="/javascript/api/office/office.document" target="_blank">ProjectDocument</a> object.</span></span> </p></li></ul>|
|<span data-ttu-id="579b0-130">**ReadAllDocument**</span><span class="sxs-lookup"><span data-stu-id="579b0-130">**ReadAllDocument**</span></span>|<span data-ttu-id="579b0-131">制限付きアクセス許可と **ReadDocument** アクセス許可によって許可される API に加えて、ドキュメント データへの次の追加アクセスを許可します。 </span><span class="sxs-lookup"><span data-stu-id="579b0-131">In addition to the API allowed by the **Restricted** and **ReadDocument** permissions, allows the following additional access to document data:</span></span><br/><ul><li><p><span data-ttu-id="579b0-132"><span class="keyword">Document.getSelectedDataAsync</span> メソッドおよび <span class="keyword">Document.getFileAsync</span> メソッドは、ドキュメント (テキストだけでなく、書式設定、リンク、埋め込まれたグラフィックス、コメント、リビジョンなど) の基礎となる OOXML コードにアクセスできます。</span><span class="sxs-lookup"><span data-stu-id="579b0-132">The <span class="keyword">Document.getSelectedDataAsync</span> and <span class="keyword">Document.getFileAsync</span> methods can access the underlying OOXML code of the document (which in addition to the text may include formatting, links, embedded graphics, comments, revisions, and so forth).</span></span></p></li></ul>|
|<span data-ttu-id="579b0-133">**WriteDocument**</span><span class="sxs-lookup"><span data-stu-id="579b0-133">**WriteDocument**</span></span>|<span data-ttu-id="579b0-134">制限付きアクセス許可によって許可される API に加 **えて、次** の API メンバーへのアクセスを追加します。</span><span class="sxs-lookup"><span data-stu-id="579b0-134">In addition to the API allowed by the **Restricted** permission, adds access to the following API members:</span></span><br/><ul><li><p><span data-ttu-id="579b0-135">ドキュメントでのユーザーの選択内容に書き込むための <a href="/javascript/api/office/office.document#setselecteddataasync-data--options--callback-" target="_blank">Document.setSelectedDataAsync</a> メソッド。</span><span class="sxs-lookup"><span data-stu-id="579b0-135">The <a href="/javascript/api/office/office.document#setselecteddataasync-data--options--callback-" target="_blank">Document.setSelectedDataAsync</a> method to write to the user's selection in the document.</span></span></p></li></ul>|
|<span data-ttu-id="579b0-136">**ReadWriteDocument**</span><span class="sxs-lookup"><span data-stu-id="579b0-136">**ReadWriteDocument**</span></span>|<span data-ttu-id="579b0-137">制限付き **、ReadDocument、ReadAllDocument、** および **WriteDocument** アクセス許可によって許可される API に加えて、コンテンツアドインと作業ウィンドウ アドインでサポートされる残りの API へのアクセスも含まれます。これには、イベントをサブスクライブするためのメソッドも含まれます。  これらの追加の API メンバー **にアクセスするには、ReadWriteDocument** アクセス許可を宣言する必要があります。</span><span class="sxs-lookup"><span data-stu-id="579b0-137">In addition to the API allowed by the **Restricted**, **ReadDocument**, **ReadAllDocument**, and **WriteDocument** permissions, includes access to all remaining API supported by content and task pane add-ins, including methods for subscribing to events.You must declare the **ReadWriteDocument** permission to access these additional API members:</span></span><br/><ul><li><p><span data-ttu-id="579b0-138">ドキュメントのバインドされている領域に書き込むための <a href="/javascript/api/office/office.binding#setdataasync-data--options--callback-" target="_blank">Binding.setDataAsync</a> メソッド。</span><span class="sxs-lookup"><span data-stu-id="579b0-138">The <a href="/javascript/api/office/office.binding#setdataasync-data--options--callback-" target="_blank">Binding.setDataAsync</a> method for writing to bound regions of the document.</span></span></p></li><li><p><span data-ttu-id="579b0-139">バインド テーブルに行を追加するための <a href="/javascript/api/office/office.tablebinding#addrowsasync-rows--options--callback-" target="_blank">TableBinding.addRowsAsync</a> メソッド。</span><span class="sxs-lookup"><span data-stu-id="579b0-139">The <a href="/javascript/api/office/office.tablebinding#addrowsasync-rows--options--callback-" target="_blank">TableBinding.addRowsAsync</a> method for adding rows to bound tables.</span></span></p></li><li><p><span data-ttu-id="579b0-140">バインド テーブルに列を追加するための <a href="/javascript/api/office/office.tablebinding#addcolumnsasync-tabledata--options--callback-" target="_blank">TableBinding.addColumnsAsync</a> メソッド。</span><span class="sxs-lookup"><span data-stu-id="579b0-140">The <a href="/javascript/api/office/office.tablebinding#addcolumnsasync-tabledata--options--callback-" target="_blank">TableBinding.addColumnsAsync</a> method for adding columns to bound tables.</span></span></p></li><li><p><span data-ttu-id="579b0-141">バインド テーブルからすべてのデータを削除するための <a href="/javascript/api/office/office.tablebinding#deletealldatavaluesasync-options--callback-" target="_blank">TableBinding.deleteAllDataValuesAsync</a> メソッド。</span><span class="sxs-lookup"><span data-stu-id="579b0-141">The <a href="/javascript/api/office/office.tablebinding#deletealldatavaluesasync-options--callback-" target="_blank">TableBinding.deleteAllDataValuesAsync</a> method for deleting all data in a bound table.</span></span></p></li><li><p><span data-ttu-id="579b0-142">バインド テーブルに書式設定とオプションを設定するための <a href="/javascript/api/office/office.tablebinding#setformatsasync-cellformat--options--callback-" target="_blank">TableBinding</a> オブジェクトの <a href="/javascript/api/office/office.tablebinding#clearformatsasync-options--callback-" target="_blank">setFormatsAsync</a>、<a href="/javascript/api/office/office.tablebinding#settableoptionsasync-tableoptions--options--callback-" target="_blank">clearFormatsAsync</a>、および <span class="keyword">setTableOptionsAsync</span> の各メソッド。</span><span class="sxs-lookup"><span data-stu-id="579b0-142">The <a href="/javascript/api/office/office.tablebinding#setformatsasync-cellformat--options--callback-" target="_blank">setFormatsAsync</a>, <a href="/javascript/api/office/office.tablebinding#clearformatsasync-options--callback-" target="_blank">clearFormatsAsync</a>, and <a href="/javascript/api/office/office.tablebinding#settableoptionsasync-tableoptions--options--callback-" target="_blank">setTableOptionsAsync</a> methods of the <span class="keyword">TableBinding</span> object for setting formatting and options on bound tables.</span></span></p></li><li><p><span data-ttu-id="579b0-143">
  <a href="/javascript/api/office/office.customxmlnode" target="_blank">CustomXmlNode</a>、<a href="/javascript/api/office/office.customxmlpart" target="_blank">CustomXmlPart</a>、<a href="/javascript/api/office/office.customxmlparts" target="_blank">CustomXmlParts</a>、および <a href="/javascript/api/office/office.customxmlprefixmappings" target="_blank">CustomXmlPrefixMappings</a> の各オブジェクトのすべてのメンバー。</span><span class="sxs-lookup"><span data-stu-id="579b0-143">All of the members of the <a href="/javascript/api/office/office.customxmlnode" target="_blank">CustomXmlNode</a>, <a href="/javascript/api/office/office.customxmlpart" target="_blank">CustomXmlPart</a>, <a href="/javascript/api/office/office.customxmlparts" target="_blank">CustomXmlParts</a>, and <a href="/javascript/api/office/office.customxmlprefixmappings" target="_blank">CustomXmlPrefixMappings</a> objects.</span></span></p></li><li><p><span data-ttu-id="579b0-144">コンテンツ アドインと作業ウィンドウ アドインによってサポートされるイベントにサブスクライブするためのすべてのメソッド、特に <span class="keyword">Binding</span>、<span class="keyword">CustomXmlPart</span>、<a href="/javascript/api/office/office.binding" target="_blank">Document</a>、<a href="/javascript/api/office/office.customxmlpart" target="_blank">ProjectDocument</a>、および <a href="/javascript/api/office/office.document" target="_blank">Settings</a> の各オブジェクトの <a href="/javascript/api/office/office.document" target="_blank">addHandlerAsync</a> メソッドおよび <a href="/javascript/api/office/office.document#settings" target="_blank">removeHandlerAsync</a> メソッド。</span><span class="sxs-lookup"><span data-stu-id="579b0-144">All of the methods for subscribing to the events supported by content and task pane add-ins, specifically the <span class="keyword">addHandlerAsync</span> and <span class="keyword">removeHandlerAsync</span> methods of the <a href="/javascript/api/office/office.binding" target="_blank">Binding</a>, <a href="/javascript/api/office/office.customxmlpart" target="_blank">CustomXmlPart</a>, <a href="/javascript/api/office/office.document" target="_blank">Document</a>, <a href="/javascript/api/office/office.document" target="_blank">ProjectDocument</a>, and <a href="/javascript/api/office/office.document#settings" target="_blank">Settings</a> objects.</span></span></p></li></ul>|

## <a name="see-also"></a><span data-ttu-id="579b0-145">関連項目</span><span class="sxs-lookup"><span data-stu-id="579b0-145">See also</span></span>

- [<span data-ttu-id="579b0-146">Office アドインのプライバシーとセキュリティ</span><span class="sxs-lookup"><span data-stu-id="579b0-146">Privacy and security for Office Add-ins</span></span>](../concepts/privacy-and-security.md)
