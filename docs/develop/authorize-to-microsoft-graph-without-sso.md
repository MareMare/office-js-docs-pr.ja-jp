---
title: SSO を使用せずに Microsoft Graph を承認する
description: SSO を使用せずに Microsoft Graph を承認する方法
ms.date: 01/29/2020
localization_priority: Normal
ms.openlocfilehash: 828779a766c41088435ff5fdfa693e1d9939c710
ms.sourcegitcommit: d15bca2c12732f8599be2ec4b2adc7c254552f52
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/12/2020
ms.locfileid: "41949662"
---
# <a name="authorize-to-microsoft-graph-without-sso"></a><span data-ttu-id="160fc-103">SSO を使用せずに Microsoft Graph を承認する</span><span class="sxs-lookup"><span data-stu-id="160fc-103">Authorize to Microsoft Graph without SSO</span></span>

<span data-ttu-id="160fc-104">Azure Active Directory (AAD) から Graph へのアクセス トークンを取得することで、アドインの Microsoft Graph データへの承認を取得できます。</span><span class="sxs-lookup"><span data-stu-id="160fc-104">Your add-in can get authorization to Microsoft Graph data by obtaining an access token to Graph from Azure Active Directory (AAD).</span></span> <span data-ttu-id="160fc-105">他の Web アプリケーションの場合と同様に (1 つの例外を除く)、認証コード フローか暗黙的なフローを使用します。AAD では、ログイン ページを iframe で開くことを許可しません。</span><span class="sxs-lookup"><span data-stu-id="160fc-105">Use either the Authorization Code flow or the Implicit flow just as you would in other web applications but with one exception: AAD does not allow its login page to open in an iframe.</span></span> <span data-ttu-id="160fc-106">Office アドインが *Office on the web* で実行されている場合、作業ウィンドウとして iFrame が使用されます。</span><span class="sxs-lookup"><span data-stu-id="160fc-106">When an Office Add-in is running on *Office on the web*, the task pane is an iframe.</span></span> <span data-ttu-id="160fc-107">これは、AAD のログイン画面は、Office ダイアログ API を使用して開かれるダイアログ ボックスで開く必要があることを意味します。</span><span class="sxs-lookup"><span data-stu-id="160fc-107">This means you'll need to open the AAD login screen in a dialog box opened with the Office dialog API.</span></span> <span data-ttu-id="160fc-108">これは、認証と承認ヘルパー ライブラリの使用方法に影響します。</span><span class="sxs-lookup"><span data-stu-id="160fc-108">This affects how you use authentication and authorization helper libraries.</span></span> <span data-ttu-id="160fc-109">詳細については、「[Office ダイアログ API を使用して認証および承認する](auth-with-office-dialog-api.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="160fc-109">For more information, see [Authentication with the Office dialog API](auth-with-office-dialog-api.md).</span></span>

<span data-ttu-id="160fc-110">AAD を使用した認証のプログラミングの詳細については、「[Microsoft ID プラットフォーム (v 2.0) の概要](/azure/active-directory/develop/v2-overview)」を参照してください。このドキュメント セットでは、チュートリアルやガイド、関連するサンプルへのリンクを見つけることができます。</span><span class="sxs-lookup"><span data-stu-id="160fc-110">For information about programming authentication with AAD, begin with [Microsoft identity platform (v2.0) overview](/azure/active-directory/develop/v2-overview), where you'll find tutorials and guides in that documentation set, as well as links to relevant samples.</span></span> <span data-ttu-id="160fc-111">繰り返しますが、Office ダイアログ ボックスで実行するようにサンプルのコードを調整して、Office ダイアログ ボックスが作業ウィンドウとは別のプロセスで実行されるという事実を説明する必要がある場合があります。</span><span class="sxs-lookup"><span data-stu-id="160fc-111">Once again, you may need to adjust the code in the samples to run in the Office dialog box to account for the fact that the Office dialog box runs in a separate process from the task pane.</span></span>

<span data-ttu-id="160fc-112">Graph へのアクセス トークンを取得した後、コードはアクセス トークンをダイアログから作業ウィンドウに渡すか、トークンをデータベースに保存し、トークンが使用可能であることを作業ウィンドウに通知します。</span><span class="sxs-lookup"><span data-stu-id="160fc-112">After your code obtains the access token to Graph, either it passes the access token from the dialog box to the task pane, or it stores the token in a database and signals the task pane that the token is available.</span></span> <span data-ttu-id="160fc-113">(詳細については、「[Office ダイアログ API を使用して認証と承認を行う](auth-with-office-dialog-api.md)」を参照してください)。作業ウィンドウのコードは、Graph のデータを要求し、それらの要求にトークンを含めます。</span><span class="sxs-lookup"><span data-stu-id="160fc-113">(See [Authentication with the Office dialog API](auth-with-office-dialog-api.md) for details.) Code in the task pane requests data from Graph, and includes the token in those requests.</span></span> <span data-ttu-id="160fc-114">Graph とGraph SDK の呼び出しの詳細については、「[Microsoft Graph ドキュメント](/graph/)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="160fc-114">For more information about calling Graph and the Graph SDKs, see [Microsoft Graph documentation](/graph/).</span></span>

## <a name="recommended-libraries-and-samples"></a><span data-ttu-id="160fc-115">推奨されるライブラリおよびサンプル</span><span class="sxs-lookup"><span data-stu-id="160fc-115">Recommended libraries and samples</span></span>

<span data-ttu-id="160fc-116">SSO を使用せずに Microsoft Graph にアクセスする場合は、次のライブラリを使用することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="160fc-116">We recommend that you use the following libraries when accessing Microsoft Graph without using SSO:</span></span>

- <span data-ttu-id="160fc-117">.NET ベースのフレームワーク (.NET Core や ASP.NET など) のサーバー側を使用するアドインの場合は、[MSAL.NET](https://github.com/AzureAD/microsoft-authentication-library-for-dotnet/wiki#conceptual-documentation) を使用します。</span><span class="sxs-lookup"><span data-stu-id="160fc-117">For add-ins using a server-side with a .NET-based framework such as .NET Core or ASP.NET, use [MSAL.NET](https://github.com/AzureAD/microsoft-authentication-library-for-dotnet/wiki#conceptual-documentation).</span></span>
- <span data-ttu-id="160fc-118">NodeJS ベースのサーバー側を使用するアドインの場合は、[Passport Azure AD](https://github.com/AzureAD/passport-azure-ad) を使用します。</span><span class="sxs-lookup"><span data-stu-id="160fc-118">For add-ins using a NodeJS-based server-side, use [Passport Azure AD](https://github.com/AzureAD/passport-azure-ad).</span></span>
- <span data-ttu-id="160fc-119">暗黙的なフローを使用するアドインの場合は、[msal.js](https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki) を使用します。</span><span class="sxs-lookup"><span data-stu-id="160fc-119">For add-ins using the Implicit flow, use [msal.js](https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki).</span></span>

<span data-ttu-id="160fc-120">Microsoft ID プラットフォーム (以前は AAD v.2.0) を使用するための推奨ライブラリの詳細については、「[Microsoft ID プラットフォームの認証ライブラリ](/azure/active-directory/develop/reference-v2-libraries)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="160fc-120">For more information about recommended libraries for working with Microsoft Identity Platform (formerly AAD v.2.0), see [Microsoft identity platform authentication libraries](/azure/active-directory/develop/reference-v2-libraries).</span></span>

<span data-ttu-id="160fc-121">次のサンプルでは、Office アドインから Microsoft Graph のデータを取得します。</span><span class="sxs-lookup"><span data-stu-id="160fc-121">The following samples get Microsoft Graph data from an Office Add-in:</span></span>

- [<span data-ttu-id="160fc-122">Office アドイン Microsoft Graph ASP.NET</span><span class="sxs-lookup"><span data-stu-id="160fc-122">Office Add-in Microsoft Graph ASP.NET</span></span>](https://github.com/OfficeDev/PnP-OfficeAddins/tree/master/Samples/auth/Office-Add-in-Microsoft-Graph-ASPNET)
- [<span data-ttu-id="160fc-123">Outlook アドイン Microsoft Graph ASP.NET</span><span class="sxs-lookup"><span data-stu-id="160fc-123">Outlook Add-in Microsoft Graph ASP.NET</span></span>](https://github.com/OfficeDev/PnP-OfficeAddins/tree/master/Samples/auth/Outlook-Add-in-Microsoft-Graph-ASPNET)
- [<span data-ttu-id="160fc-124">Office アドイン Microsoft Graph React</span><span class="sxs-lookup"><span data-stu-id="160fc-124">Office Add-in Microsoft Graph React</span></span>](https://github.com/OfficeDev/PnP-OfficeAddins/tree/master/Samples/auth/Office-Add-in-Microsoft-Graph-React)
