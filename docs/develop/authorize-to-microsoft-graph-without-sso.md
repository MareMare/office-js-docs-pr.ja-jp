---
title: SSO を使用せずに Microsoft Graph を承認する
description: ''
ms.date: 08/07/2019
localization_priority: Priority
ms.openlocfilehash: 1d696783003fc475f98d5d1d37f60348aacec5eb
ms.sourcegitcommit: f781d7cfd980cd866d6d1d00c5b9d16c8a4b7f9b
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 09/20/2019
ms.locfileid: "37053313"
---
# <a name="authorize-to-microsoft-graph-without-sso"></a><span data-ttu-id="4314d-102">SSO を使用せずに Microsoft Graph を承認する</span><span class="sxs-lookup"><span data-stu-id="4314d-102">Authorize to Microsoft Graph without SSO</span></span>

<span data-ttu-id="4314d-103">Azure Active Directory (AAD) から Graph へのアクセス トークンを取得することで、アドイン用の Microsoft Graph データへの認証を取得できます。</span><span class="sxs-lookup"><span data-stu-id="4314d-103">You can get authorization to Microsoft Graph data for your add-in by obtaining an access token to Graph from Azure Active Directory (AAD).</span></span> <span data-ttu-id="4314d-104">これを行うには、他の Web アプリケーションの場合と同様に (1 つの例外を除く)、認証コード フローか暗黙的なフローのいずれかを使用します。AAD では、ログイン ページを iframe で開くことを許可しません。</span><span class="sxs-lookup"><span data-stu-id="4314d-104">You do this using either the Authorization Code flow or the Implicit Flow just as you would any in any other web application with one exception: AAD does not allow its login page to open in an iframe.</span></span> <span data-ttu-id="4314d-105">Office アドインが *Office on the web* で実行されている場合、作業ウィンドウとして iFrame が使用されます。</span><span class="sxs-lookup"><span data-stu-id="4314d-105">When an Office Add-in is running on *Office on the web*, the task pane is an iframe.</span></span> <span data-ttu-id="4314d-106">これは、AAD のログイン画面は、Office ダイアログ API を使用して開かれるダイアログで開く必要があることを意味します。</span><span class="sxs-lookup"><span data-stu-id="4314d-106">This means that you will need to open the AAD login screen in a dialog opened with the Office Dialog API.</span></span> <span data-ttu-id="4314d-107">これは、認証と承認ヘルパー ライブラリの使用方法に影響します。</span><span class="sxs-lookup"><span data-stu-id="4314d-107">This will effect how you use authentication and authorization helper libraries.</span></span> <span data-ttu-id="4314d-108">詳細については、「[Office ダイアログ API を使用して認証と承認を行う](auth-with-office-dialog-api.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="4314d-108">For more information, see [Authentication with the Office Dialog API](auth-with-office-dialog-api.md).</span></span>

<span data-ttu-id="4314d-109">AAD での認証のプログラミングの詳細については、「[Microsoft ID プラットフォーム (v2.0) の概要](/azure/active-directory/develop/v2-overview)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="4314d-109">For information about programming authentication with AAD, begin with [Microsoft identity platform (v2.0) overview](/azure/active-directory/develop/v2-overview).</span></span> <span data-ttu-id="4314d-110">このドキュメント セットには、多くのチュートリアルやガイドのほか、関連するサンプルへのリンクが含まれています。</span><span class="sxs-lookup"><span data-stu-id="4314d-110">There are many tutorials and guides in that documentation set, as well as links to relevant samples.</span></span> <span data-ttu-id="4314d-111">繰り返しますが、Office ダイアログで実行するようにサンプルのコードを調整して、ダイアログが作業ウィンドウとは別のプロセスで実行されるという事実を説明する必要がある場合があります。</span><span class="sxs-lookup"><span data-stu-id="4314d-111">Once again a reminder: you may need to adjust the code in the samples to run in the Office Dialog to account for the fact that the Dialog runs in a separate process from the task pane.</span></span>

<span data-ttu-id="4314d-112">Microsoft Graph へのアクセス トークンを取得した後、コードはアクセス トークンをダイアログから作業ウィンドウに渡すか、トークンをデータベースに保存し、そこでトークンが使用可能であることを作業ウィンドウに通知します。</span><span class="sxs-lookup"><span data-stu-id="4314d-112">After your code has obtained the access token to Microsoft Graph, either it passes the access token from the dialog to the task pane, or it stores the token in a database and signals the task pane that the token is available there.</span></span> <span data-ttu-id="4314d-113">(詳細については、「[Office ダイアログ API を使用して認証と承認を行う](auth-with-office-dialog-api.md)」を参照してください)。作業ウィンドウのコードは、Microsoft Graph のデータを要求し、それらの要求にトークンを含めます。</span><span class="sxs-lookup"><span data-stu-id="4314d-113">(See [Authentication with the Office Dialog API](auth-with-office-dialog-api.md) for details.) Code in the task pane requests data from Microsoft Graph, and includes the token in those requests.</span></span> <span data-ttu-id="4314d-114">Microsoft Graph と Microsoft Graph の SDK の呼び出しの詳細については、「[Microsoft Graph ドキュメント](/graph/)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="4314d-114">For more information about calling Microsoft Graph and the SDKs for Microsoft Graph, see [Microsoft Graph documentation](/graph/).</span></span>

## <a name="recommended-libraries-and-samples"></a><span data-ttu-id="4314d-115">推奨されるライブラリおよびサンプル</span><span class="sxs-lookup"><span data-stu-id="4314d-115">Recommended libraries and samples</span></span>

<span data-ttu-id="4314d-116">SSO を使用せずに Microsoft Graph にアクセスする場合は、次のライブラリを使用することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="4314d-116">We recommend that you use the following libraries when accessing Microsoft Graph without using SSO:</span></span>

- <span data-ttu-id="4314d-117">.NET ベースのフレームワーク (.NET Core や ASP.NET など) のサーバー側を使用するアドインの場合は、[MSAL.NET](https://github.com/AzureAD/microsoft-authentication-library-for-dotnet/wiki#conceptual-documentation) を使用します。</span><span class="sxs-lookup"><span data-stu-id="4314d-117">For add-ins using a server-side with a .NET-based framework such as .NET Core or ASP.NET, use [MSAL.NET](https://github.com/AzureAD/microsoft-authentication-library-for-dotnet/wiki#conceptual-documentation).</span></span>
- <span data-ttu-id="4314d-118">NodeJS ベースのサーバー側を使用するアドインの場合は、[Passport Azure AD](https://github.com/AzureAD/passport-azure-ad) を使用します。</span><span class="sxs-lookup"><span data-stu-id="4314d-118">For add-ins using a NodeJS-based server-side, use [Passport Azure AD](https://github.com/AzureAD/passport-azure-ad).</span></span>
- <span data-ttu-id="4314d-119">暗黙的なフローを使用するアドインの場合は、[msal.js](https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki) を使用します。</span><span class="sxs-lookup"><span data-stu-id="4314d-119">For add-ins using the Implicit flow, use [msal.js](https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki).</span></span>

<span data-ttu-id="4314d-120">Microsoft ID プラットフォーム (以前は AAD v.2.0) を使用するための推奨ライブラリの詳細については、「[Microsoft ID プラットフォームの認証ライブラリ](/azure/active-directory/develop/reference-v2-libraries)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="4314d-120">For more information about recommended libraries for working with Microsoft Identity Platform (formerly AAD v.2.0), see [Microsoft identity platform authentication libraries](/azure/active-directory/develop/reference-v2-libraries).</span></span>

<span data-ttu-id="4314d-121">次のサンプルでは、Office アドインから Microsoft Graph のデータを取得します。</span><span class="sxs-lookup"><span data-stu-id="4314d-121">The following samples get Microsoft Graph data from an Office Add-in:</span></span>

- [<span data-ttu-id="4314d-122">Office アドイン Microsoft Graph ASP.NET</span><span class="sxs-lookup"><span data-stu-id="4314d-122">Office Add-in Microsoft Graph ASP.NET</span></span>](https://github.com/OfficeDev/PnP-OfficeAddins/tree/master/Samples/auth/Office-Add-in-Microsoft-Graph-ASPNET)
- [<span data-ttu-id="4314d-123">Outlook アドイン Microsoft Graph ASP.NET</span><span class="sxs-lookup"><span data-stu-id="4314d-123">Outlook Add-in Microsoft Graph ASP.NET</span></span>](https://github.com/OfficeDev/PnP-OfficeAddins/tree/master/Samples/auth/Outlook-Add-in-Microsoft-Graph-ASPNET)

