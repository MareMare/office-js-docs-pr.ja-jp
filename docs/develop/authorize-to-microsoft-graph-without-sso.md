---
title: SSO を使用せずに Microsoft Graph を承認する
description: SSO を使用せずに Microsoft Graph を承認する方法
ms.date: 01/29/2020
localization_priority: Normal
ms.openlocfilehash: ec8279f4112936692f0859fee2a1cc766c0b4342
ms.sourcegitcommit: 883f71d395b19ccfc6874a0d5942a7016eb49e2c
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/09/2021
ms.locfileid: "53350044"
---
# <a name="authorize-to-microsoft-graph-without-sso"></a><span data-ttu-id="4011f-103">SSO を使用せずに Microsoft Graph を承認する</span><span class="sxs-lookup"><span data-stu-id="4011f-103">Authorize to Microsoft Graph without SSO</span></span>

<span data-ttu-id="4011f-104">アドインは、Microsoft Graph へのアクセス トークンを Graph (Azure AD) から取得することで、Microsoft Azure Active Directory データに対する承認を取得AD。</span><span class="sxs-lookup"><span data-stu-id="4011f-104">Your add-in can get authorization to Microsoft Graph data by obtaining an access token to Microsoft Graph from Azure Active Directory (Azure AD).</span></span> <span data-ttu-id="4011f-105">承認コード フローまたは暗黙的フローは、他の Web アプリケーションと同様に使用しますが、1 つの例外を除き、Azure AD ではサインイン ページを iframe で開くことができません。</span><span class="sxs-lookup"><span data-stu-id="4011f-105">Use either the Authorization Code flow or the Implicit flow just as you would in other web applications but with one exception: Azure AD does not allow its sign in page to open in an iframe.</span></span> <span data-ttu-id="4011f-106">Office アドインが *Office on the web* で実行されている場合、作業ウィンドウとして iFrame が使用されます。</span><span class="sxs-lookup"><span data-stu-id="4011f-106">When an Office Add-in is running on *Office on the web*, the task pane is an iframe.</span></span> <span data-ttu-id="4011f-107">つまり、Azure AD API で開いたダイアログ ボックスで Azure Office開く必要があります。</span><span class="sxs-lookup"><span data-stu-id="4011f-107">This means you'll need to open the Azure AD login screen in a dialog box opened with the Office dialog API.</span></span> <span data-ttu-id="4011f-108">これは、認証と承認ヘルパー ライブラリの使用方法に影響します。</span><span class="sxs-lookup"><span data-stu-id="4011f-108">This affects how you use authentication and authorization helper libraries.</span></span> <span data-ttu-id="4011f-109">詳細については、「[Office ダイアログ API を使用して認証および承認する](auth-with-office-dialog-api.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="4011f-109">For more information, see [Authentication with the Office dialog API](auth-with-office-dialog-api.md).</span></span>

<span data-ttu-id="4011f-110">Azure AD でのプログラミング認証の詳細については[、Microsoft ID プラットフォーム (v2.0)](/azure/active-directory/develop/v2-overview)の概要から始まり、そのドキュメント セットのチュートリアルとガイド、および関連するサンプルへのリンクを参照してください。</span><span class="sxs-lookup"><span data-stu-id="4011f-110">For information about programming authentication with Azure AD, begin with [Microsoft identity platform (v2.0) overview](/azure/active-directory/develop/v2-overview), where you'll find tutorials and guides in that documentation set, as well as links to relevant samples.</span></span> <span data-ttu-id="4011f-111">繰り返しますが、Office ダイアログ ボックスで実行するようにサンプルのコードを調整して、Office ダイアログ ボックスが作業ウィンドウとは別のプロセスで実行されるという事実を説明する必要がある場合があります。</span><span class="sxs-lookup"><span data-stu-id="4011f-111">Once again, you may need to adjust the code in the samples to run in the Office dialog box to account for the fact that the Office dialog box runs in a separate process from the task pane.</span></span>

<span data-ttu-id="4011f-112">コードが Microsoft Graph へのアクセス トークンを取得した後、アクセス トークンをダイアログ ボックスから作業ウィンドウに渡すか、またはトークンをデータベースに格納し、トークンが使用可能な作業ウィンドウにシグナルを送信します。</span><span class="sxs-lookup"><span data-stu-id="4011f-112">After your code obtains the access token to Microsoft Graph, either it passes the access token from the dialog box to the task pane, or it stores the token in a database and signals the task pane that the token is available.</span></span> <span data-ttu-id="4011f-113">(詳細[については、「Office API を使用した認証」](auth-with-office-dialog-api.md)を参照してください)。作業ウィンドウ内のコードは、Microsoft Graphデータを要求し、それらの要求にトークンを含む。</span><span class="sxs-lookup"><span data-stu-id="4011f-113">(See [Authentication with the Office dialog API](auth-with-office-dialog-api.md) for details.) Code in the task pane requests data from Microsoft Graph, and includes the token in those requests.</span></span> <span data-ttu-id="4011f-114">Microsoft Graph SDK と Microsoft Graphの呼び出しの詳細については[、「Microsoft Graph」を参照してください](/graph/)。</span><span class="sxs-lookup"><span data-stu-id="4011f-114">For more information about calling Microsoft Graph and the Microsoft Graph SDKs, see [Microsoft Graph documentation](/graph/).</span></span>

## <a name="recommended-libraries-and-samples"></a><span data-ttu-id="4011f-115">推奨されるライブラリおよびサンプル</span><span class="sxs-lookup"><span data-stu-id="4011f-115">Recommended libraries and samples</span></span>

<span data-ttu-id="4011f-116">SSO を使用せずに Microsoft サーバーにアクセスする場合は、次Graph使用することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="4011f-116">We recommend that you use the following libraries when accessing Microsoft Graph without using SSO.</span></span>

- <span data-ttu-id="4011f-117">.NET ベースのフレームワーク (.NET Core や ASP.NET など) のサーバー側を使用するアドインの場合は、[MSAL.NET](https://github.com/AzureAD/microsoft-authentication-library-for-dotnet/wiki#conceptual-documentation) を使用します。</span><span class="sxs-lookup"><span data-stu-id="4011f-117">For add-ins using a server-side with a .NET-based framework such as .NET Core or ASP.NET, use [MSAL.NET](https://github.com/AzureAD/microsoft-authentication-library-for-dotnet/wiki#conceptual-documentation).</span></span>
- <span data-ttu-id="4011f-118">NodeJS ベースのサーバー側を使用するアドインの場合は、[Passport Azure AD](https://github.com/AzureAD/passport-azure-ad) を使用します。</span><span class="sxs-lookup"><span data-stu-id="4011f-118">For add-ins using a NodeJS-based server-side, use [Passport Azure AD](https://github.com/AzureAD/passport-azure-ad).</span></span>
- <span data-ttu-id="4011f-119">暗黙的なフローを使用するアドインの場合は、[msal.js](https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki) を使用します。</span><span class="sxs-lookup"><span data-stu-id="4011f-119">For add-ins using the Implicit flow, use [msal.js](https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki).</span></span>

<span data-ttu-id="4011f-120">Microsoft ID プラットフォーム (以前は AAD v.2.0) を使用するための推奨ライブラリの詳細については、「[Microsoft ID プラットフォームの認証ライブラリ](/azure/active-directory/develop/reference-v2-libraries)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="4011f-120">For more information about recommended libraries for working with Microsoft Identity Platform (formerly AAD v.2.0), see [Microsoft identity platform authentication libraries](/azure/active-directory/develop/reference-v2-libraries).</span></span>

<span data-ttu-id="4011f-121">次のサンプルでは、Microsoft GraphアドインからデータOffice取得します。</span><span class="sxs-lookup"><span data-stu-id="4011f-121">The following samples get Microsoft Graph data from an Office Add-in.</span></span>

- [<span data-ttu-id="4011f-122">Office アドイン Microsoft Graph ASP.NET</span><span class="sxs-lookup"><span data-stu-id="4011f-122">Office Add-in Microsoft Graph ASP.NET</span></span>](https://github.com/OfficeDev/PnP-OfficeAddins/tree/master/Samples/auth/Office-Add-in-Microsoft-Graph-ASPNET)
- [<span data-ttu-id="4011f-123">Outlook アドイン Microsoft Graph ASP.NET</span><span class="sxs-lookup"><span data-stu-id="4011f-123">Outlook Add-in Microsoft Graph ASP.NET</span></span>](https://github.com/OfficeDev/PnP-OfficeAddins/tree/master/Samples/auth/Outlook-Add-in-Microsoft-Graph-ASPNET)
- [<span data-ttu-id="4011f-124">Office アドイン Microsoft Graph React</span><span class="sxs-lookup"><span data-stu-id="4011f-124">Office Add-in Microsoft Graph React</span></span>](https://github.com/OfficeDev/PnP-OfficeAddins/tree/master/Samples/auth/Office-Add-in-Microsoft-Graph-React)
