---
title: Visual Studio で Office アドインをデバッグする
description: Visual Studio を使用して、Windows 上の Office デスクトップ クライアントで Office アドインをデバッグする
ms.date: 12/31/2019
localization_priority: Normal
ms.openlocfilehash: 52c303b1f353871fe3de7878b692204e6ec65054
ms.sourcegitcommit: be23b68eb661015508797333915b44381dd29bdb
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/08/2020
ms.locfileid: "44608344"
---
# <a name="debug-office-add-ins-in-visual-studio"></a><span data-ttu-id="bda60-103">Visual Studio で Office アドインをデバッグする</span><span class="sxs-lookup"><span data-stu-id="bda60-103">Debug Office Add-ins in Visual Studio</span></span>

<span data-ttu-id="bda60-104">この記事では、Visual Studio 2019 を使用して、Windows 上の Office デスクトップ クライアントで Office アドインをデバッグする方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="bda60-104">This article describes how to use Visual Studio 2019 to debug an Office Add-in in the Office desktop client on Windows.</span></span> <span data-ttu-id="bda60-105">別のバージョンの Visual Studio を使用している場合は、手順が少し異なる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="bda60-105">If you're using another version of Visual Studio, the procedures might vary slightly.</span></span> 

> [!NOTE]
> <span data-ttu-id="bda60-106">Office on the web または Office on Mac では、Visual Studio を使用してアドインをデバッグすることはできません。</span><span class="sxs-lookup"><span data-stu-id="bda60-106">You can't use Visual Studio to debug add-ins in Office on the web or Mac.</span></span> <span data-ttu-id="bda60-107">これらのプラットフォームでのデバッグについては、「[Office on the web での Office アドインのデバッグ](../testing/debug-add-ins-in-office-online.md)」または「[Mac での Office アドインのデバッグ](../testing/debug-office-add-ins-on-ipad-and-mac.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="bda60-107">For information about debugging on these platforms, see [Debug Office Add-ins in Office on the web](../testing/debug-add-ins-in-office-online.md) or [Debug Office Add-ins on a Mac](../testing/debug-office-add-ins-on-ipad-and-mac.md).</span></span>

## <a name="enable-debugging-for-add-in-commands-and-ui-less-code"></a><span data-ttu-id="bda60-108">アドイン コマンドと UI のないコードのデバッグを有効にする</span><span class="sxs-lookup"><span data-stu-id="bda60-108">Enable debugging for add-in commands and UI-less code</span></span>

<span data-ttu-id="bda60-109">Visual Studio が Windows 上の Office をデバッグする場合、アドインは、Microsoft Internet Explorer または Microsoft Edge ブラウザー インスタンスのいずれかにホストされています。</span><span class="sxs-lookup"><span data-stu-id="bda60-109">When Visual Studio debugs Office on Windows, the add-in is hosted in either a Microsoft Internet Explorer or Microsoft Edge browser instance.</span></span> <span data-ttu-id="bda60-110">開発用コンピューターで使用されているブラウザーを確認するには、「[Office アドインによって使用されるブラウザー](../concepts/browsers-used-by-office-web-add-ins.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="bda60-110">To determine which browser is being used on your development computer, see [Browsers used by Office Add-ins](../concepts/browsers-used-by-office-web-add-ins.md).</span></span>
> [!NOTE]
> <span data-ttu-id="bda60-111">次の手順では、JS_Debug 環境変数が不要になりました。</span><span class="sxs-lookup"><span data-stu-id="bda60-111">The JS_Debug environment variable is no longer needed in the following procedure.</span></span> <span data-ttu-id="bda60-112">詳細については、Microsoft Developer Community サポート フォーラムの「[Office Web アドインでのデバッグ動作](https://developercommunity.visualstudio.com/content/problem/740413/office-development-inconsistent-script-debugging-b.html)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="bda60-112">For more information, see [Debugging behaviors in Office web add-ins](https://developercommunity.visualstudio.com/content/problem/740413/office-development-inconsistent-script-debugging-b.html) on the Microsoft Developer Community support forum.</span></span>

[!include[Enable debugging on Microsoft Edge DevTools](../includes/enable-debugging-on-edge-devtools.md)]

## <a name="review-the-build-and-debug-properties"></a><span data-ttu-id="bda60-113">ビルドとデバッグのプロパティの確認</span><span class="sxs-lookup"><span data-stu-id="bda60-113">Review the build and debug properties</span></span>

<span data-ttu-id="bda60-114">デバッグを開始する前に、各プロジェクトのプロパティを確認し、Visual Studio で目的のホスト アプリケーションが開くことと、他のビルドとデバッグのプロパティが適切に設定されていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="bda60-114">Before you start debugging, review the properties of each project to confirm that Visual Studio will open the desired host application and that other build and debug properties are set appropriately.</span></span>

### <a name="add-in-project-properties"></a><span data-ttu-id="bda60-115">アドイン プロジェクトのプロパティ</span><span class="sxs-lookup"><span data-stu-id="bda60-115">Add-in project properties</span></span>

<span data-ttu-id="bda60-116">アドイン プロジェクトの [**プロパティ**] ウィンドウを開き、プロジェクト プロパティを確認します。</span><span class="sxs-lookup"><span data-stu-id="bda60-116">Open the **Properties** window for the add-in project to review project properties:</span></span>

1. <span data-ttu-id="bda60-117">**ソリューション エクスプローラー**で、(Web アプリケーション プロジェクトでは*なく*) アドイン プロジェクトを選択します。</span><span class="sxs-lookup"><span data-stu-id="bda60-117">In **Solution Explorer**, choose the add-in project (*not* the web application project).</span></span>

2. <span data-ttu-id="bda60-118">メニュー バーから [**表示**]、[**プロパティ ウィンドウ**] の順に選択します。</span><span class="sxs-lookup"><span data-stu-id="bda60-118">From the menu bar, choose **View** > **Properties Window**.</span></span>

<span data-ttu-id="bda60-119">次の表では、アドイン プロジェクトのプロパティについて説明します。</span><span class="sxs-lookup"><span data-stu-id="bda60-119">The following table describes the properties of the add-in project.</span></span>

|<span data-ttu-id="bda60-120">**プロパティ**</span><span class="sxs-lookup"><span data-stu-id="bda60-120">**Property**</span></span>|<span data-ttu-id="bda60-121">**説明**</span><span class="sxs-lookup"><span data-stu-id="bda60-121">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="bda60-122">**開始動作**</span><span class="sxs-lookup"><span data-stu-id="bda60-122">**Start Action**</span></span>|<span data-ttu-id="bda60-123">ご自身のアドインに対してデバッグ モードを指定します。</span><span class="sxs-lookup"><span data-stu-id="bda60-123">Specifies the debug mode for your add-in.</span></span> <span data-ttu-id="bda60-124">現在、Office アドイン プロジェクトでは、**Office デスクトップ クライアント** モードのみがサポートされています。</span><span class="sxs-lookup"><span data-stu-id="bda60-124">Currently only **Office Desktop Client** mode is supported for Office Add-in projects.</span></span>|
|<span data-ttu-id="bda60-125">**開始ドキュメント**</span><span class="sxs-lookup"><span data-stu-id="bda60-125">**Start Document**</span></span><br/><span data-ttu-id="bda60-126">(Excel、PowerPoint、Word アドインのみ)</span><span class="sxs-lookup"><span data-stu-id="bda60-126">(Excel, PowerPoint, and Word add-ins only)</span></span>|<span data-ttu-id="bda60-127">プロジェクトの開始時に開くドキュメントを指定します。</span><span class="sxs-lookup"><span data-stu-id="bda60-127">Specifies what document to open when you start the project.</span></span>|
|<span data-ttu-id="bda60-128">**Web プロジェクト**</span><span class="sxs-lookup"><span data-stu-id="bda60-128">**Web Project**</span></span>|<span data-ttu-id="bda60-129">アドインに関連付けられている Web プロジェクトの名前を指定します。</span><span class="sxs-lookup"><span data-stu-id="bda60-129">Specifies the name of the web project associated with the add-in.</span></span>|
|<span data-ttu-id="bda60-130">**メール アドレス**</span><span class="sxs-lookup"><span data-stu-id="bda60-130">**Email Address**</span></span><br/><span data-ttu-id="bda60-131">(Outlook アドインのみ)</span><span class="sxs-lookup"><span data-stu-id="bda60-131">(Outlook add-ins only)</span></span>|<span data-ttu-id="bda60-132">Outlook アドインのテストに使用する Exchange Server または Exchange Online のユーザー アカウントのメール アドレスを指定します。</span><span class="sxs-lookup"><span data-stu-id="bda60-132">Specifies the email address of the user account in Exchange Server or Exchange Online that you want to use to test your Outlook add-in.</span></span>|
|<span data-ttu-id="bda60-133">**EWS の URL**</span><span class="sxs-lookup"><span data-stu-id="bda60-133">**EWS Url**</span></span><br/><span data-ttu-id="bda60-134">(Outlook アドインのみ)</span><span class="sxs-lookup"><span data-stu-id="bda60-134">(Outlook add-ins only)</span></span>|<span data-ttu-id="bda60-135">Exchange Web サービスの URL (例: `https://www.contoso.com/ews/exchange.aspx`)。</span><span class="sxs-lookup"><span data-stu-id="bda60-135">Exchange Web service URL (For example: `https://www.contoso.com/ews/exchange.aspx`).</span></span> |
|<span data-ttu-id="bda60-136">**OWA の URL**</span><span class="sxs-lookup"><span data-stu-id="bda60-136">**OWA Url**</span></span><br/><span data-ttu-id="bda60-137">(Outlook アドインのみ)</span><span class="sxs-lookup"><span data-stu-id="bda60-137">(Outlook add-ins only)</span></span>|<span data-ttu-id="bda60-138">Outlook on the web の URL (例: `https://www.contoso.com/owa`)。</span><span class="sxs-lookup"><span data-stu-id="bda60-138">Outlook on the web URL (For example: `https://www.contoso.com/owa`).</span></span>|
|<span data-ttu-id="bda60-139">**多要素認証を使用する**</span><span class="sxs-lookup"><span data-stu-id="bda60-139">**Use multi-factor auth**</span></span><br/><span data-ttu-id="bda60-140">(Outlook アドインのみ)</span><span class="sxs-lookup"><span data-stu-id="bda60-140">(Outlook add-ins only)</span></span>|<span data-ttu-id="bda60-141">多要素認証を使用する必要があるかどうかを示すブール値。</span><span class="sxs-lookup"><span data-stu-id="bda60-141">Boolean value that indicates whether multi-factor authentication should be used.</span></span>|
|<span data-ttu-id="bda60-142">**ユーザー名**</span><span class="sxs-lookup"><span data-stu-id="bda60-142">**User Name**</span></span><br/><span data-ttu-id="bda60-143">(Outlook アドインのみ)</span><span class="sxs-lookup"><span data-stu-id="bda60-143">(Outlook add-ins only)</span></span>|<span data-ttu-id="bda60-144">Outlook アドインのテストに使用する Exchange Server または Exchange Online のユーザー アカウントの名前を指定します。</span><span class="sxs-lookup"><span data-stu-id="bda60-144">Specifies the name of the user account in Exchange Server or Exchange Online that you want to use to test your Outlook add-in.</span></span>|
|<span data-ttu-id="bda60-145">**プロジェクト ファイル**</span><span class="sxs-lookup"><span data-stu-id="bda60-145">**Project File**</span></span>|<span data-ttu-id="bda60-146">ビルド、構成、およびその他のプロジェクト情報が含まれているファイルの名前を指定します。</span><span class="sxs-lookup"><span data-stu-id="bda60-146">Specifies the name of the file containing build, configuration, and other information about the project.</span></span>|
|<span data-ttu-id="bda60-147">**プロジェクト フォルダー**</span><span class="sxs-lookup"><span data-stu-id="bda60-147">**Project Folder**</span></span>|<span data-ttu-id="bda60-148">プロジェクト ファイルの場所です。</span><span class="sxs-lookup"><span data-stu-id="bda60-148">The location of the project file.</span></span>|

> [!NOTE]
> <span data-ttu-id="bda60-149">Outlook アドインの場合、[**プロパティ**] ウィンドウで 1 つまたは複数の *Outlook アドインのみ*のプロパティを指定できますが、指定する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="bda60-149">For an Outlook add-in, you may choose to specify values for one or more of the *Outlook add-in only* properties in the **Properties** window, but doing so is not required.</span></span>

### <a name="web-application-project-properties"></a><span data-ttu-id="bda60-150">Web アプリケーション プロジェクトのプロパティ</span><span class="sxs-lookup"><span data-stu-id="bda60-150">Web application project properties</span></span>

<span data-ttu-id="bda60-151">Web アプリケーション プロジェクトの [**プロパティ**] ウィンドウを開き、次のプロジェクト プロパティを確認します。</span><span class="sxs-lookup"><span data-stu-id="bda60-151">Open the **Properties** window for the web application project to review project properties:</span></span>

1. <span data-ttu-id="bda60-152">**ソリューションエクスプローラー**で、web アプリケーションプロジェクトを選択します。</span><span class="sxs-lookup"><span data-stu-id="bda60-152">In **Solution Explorer**, choose the web application project.</span></span>

2. <span data-ttu-id="bda60-153">メニュー バーから [**表示**]、[**プロパティ ウィンドウ**] の順に選択します。</span><span class="sxs-lookup"><span data-stu-id="bda60-153">From the menu bar, choose **View** > **Properties Window**.</span></span>

<span data-ttu-id="bda60-154">次の表では、Office アドイン プロジェクトに最も関連する Web アプリケーション プロジェクトのプロパティについて説明します。</span><span class="sxs-lookup"><span data-stu-id="bda60-154">The following table describes the properties of the web application project that are most relevant to Office Add-in projects.</span></span>

|<span data-ttu-id="bda60-155">**プロパティ**</span><span class="sxs-lookup"><span data-stu-id="bda60-155">**Property**</span></span>|<span data-ttu-id="bda60-156">**説明**</span><span class="sxs-lookup"><span data-stu-id="bda60-156">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="bda60-157">**SSL 有効**</span><span class="sxs-lookup"><span data-stu-id="bda60-157">**SSL Enabled**</span></span>|<span data-ttu-id="bda60-158">サイトで SSL を有効にするかどうかを指定します。</span><span class="sxs-lookup"><span data-stu-id="bda60-158">Specifies whether SSL is enabled on the site.</span></span> <span data-ttu-id="bda60-159">Office アドイン プロジェクトの場合、このプロパティを **True** に設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="bda60-159">This property should be set to **True** for Office Add-in projects.</span></span>|
|<span data-ttu-id="bda60-160">**SSL URL**</span><span class="sxs-lookup"><span data-stu-id="bda60-160">**SSL URL**</span></span>|<span data-ttu-id="bda60-161">サイトにセキュリティで保護された HTTPS URL を指定します。</span><span class="sxs-lookup"><span data-stu-id="bda60-161">Specifies the secure HTTPS URL for the site.</span></span> <span data-ttu-id="bda60-162">読み取り専用です。</span><span class="sxs-lookup"><span data-stu-id="bda60-162">Read-only.</span></span>|
|<span data-ttu-id="bda60-163">**URL**</span><span class="sxs-lookup"><span data-stu-id="bda60-163">**URL**</span></span>|<span data-ttu-id="bda60-164">サイトに HTTP URL を指定します。</span><span class="sxs-lookup"><span data-stu-id="bda60-164">Specifies the HTTP URL for the site.</span></span> <span data-ttu-id="bda60-165">読み取り専用です。</span><span class="sxs-lookup"><span data-stu-id="bda60-165">Read-only.</span></span>|
|<span data-ttu-id="bda60-166">**プロジェクト ファイル**</span><span class="sxs-lookup"><span data-stu-id="bda60-166">**Project File**</span></span>|<span data-ttu-id="bda60-167">ビルド、構成、およびその他のプロジェクト情報が含まれているファイルの名前を指定します。</span><span class="sxs-lookup"><span data-stu-id="bda60-167">Specifies the name of the file containing build, configuration, and other information about the project.</span></span>|
|<span data-ttu-id="bda60-168">**プロジェクト フォルダー**</span><span class="sxs-lookup"><span data-stu-id="bda60-168">**Project Folder**</span></span>|<span data-ttu-id="bda60-169">プロジェクト ファイルの場所を指定します。</span><span class="sxs-lookup"><span data-stu-id="bda60-169">Specifies the location of the project file.</span></span> <span data-ttu-id="bda60-170">読み取り専用です。</span><span class="sxs-lookup"><span data-stu-id="bda60-170">Read-only.</span></span> <span data-ttu-id="bda60-171">Visual Studio で実行時に生成されるマニフェスト ファイルは、この場所の `bin\Debug\OfficeAppManifests` フォルダーに書き込まれます。</span><span class="sxs-lookup"><span data-stu-id="bda60-171">The manifest file that Visual Studio generates at runtime is written to the `bin\Debug\OfficeAppManifests` folder in this location.</span></span>|

## <a name="use-an-existing-document-to-debug-the-add-in"></a><span data-ttu-id="bda60-172">既存のドキュメントを使用してアドインをデバッグする</span><span class="sxs-lookup"><span data-stu-id="bda60-172">Use an existing document to debug the add-in</span></span>

<span data-ttu-id="bda60-173">Excel、PowerPoint、または Word アドインのデバッグ時に使用するテスト データを含むドキュメントがある場合、プロジェクトの開始時にドキュメントが開くように、Visual Studio を構成できます。</span><span class="sxs-lookup"><span data-stu-id="bda60-173">If you have a document that contains test data you want to use while debugging your Excel, PowerPoint, or Word add-in, Visual Studio can be configured to open that document when you start the project.</span></span> <span data-ttu-id="bda60-174">アドインのデバッグ時に使用する既存のドキュメントを指定するには、次の手順を完了します。</span><span class="sxs-lookup"><span data-stu-id="bda60-174">To specify an existing document to use while debugging the add-in, complete the following steps.</span></span>

1. <span data-ttu-id="bda60-175">**ソリューション エクスプローラー**で、(Web アプリケーション プロジェクトでは*なく*) アドイン プロジェクトを選択します。</span><span class="sxs-lookup"><span data-stu-id="bda60-175">In **Solution Explorer**, choose the add-in project (*not* the web application project).</span></span>

2. <span data-ttu-id="bda60-176">メニュー バーから [**プロジェクト**]、[**既存のアイテムを追加**] の順に選択します。</span><span class="sxs-lookup"><span data-stu-id="bda60-176">From the menu bar, choose **Project** > **Add Existing Item**.</span></span>

3. <span data-ttu-id="bda60-177">[**既存のアイテムを追加**] ダイアログ ボックスで、追加するドキュメントを探して選択します。</span><span class="sxs-lookup"><span data-stu-id="bda60-177">In the **Add Existing Item** dialog box, locate and select the document that you want to add.</span></span>

4. <span data-ttu-id="bda60-178">[**追加**] を選択して、ドキュメントをプロジェクトに追加します。</span><span class="sxs-lookup"><span data-stu-id="bda60-178">Choose the **Add** button to add the document to your project.</span></span>

5. <span data-ttu-id="bda60-179">**ソリューション エクスプローラー**で、(Web アプリケーション プロジェクトでは*なく*) アドイン プロジェクトを選択します。</span><span class="sxs-lookup"><span data-stu-id="bda60-179">In **Solution Explorer**, choose the add-in project (*not* the web application project).</span></span>

6. <span data-ttu-id="bda60-180">メニュー バーから [**表示**]、[**プロパティ ウィンドウ**] の順に選択します。</span><span class="sxs-lookup"><span data-stu-id="bda60-180">From the menu bar, choose **View** > **Properties Window**.</span></span>

7. <span data-ttu-id="bda60-181">[**プロパティ**] ウィンドウで、[**ドキュメントの開始**] リストを選択して、プロジェクトに追加したドキュメントを選択します。</span><span class="sxs-lookup"><span data-stu-id="bda60-181">In the **Properties** window, choose the **Start Document** list, and then select the document that you added to the project.</span></span> <span data-ttu-id="bda60-182">現在、このプロジェクトは、そのドキュメントでアドインを起動するように構成されています。</span><span class="sxs-lookup"><span data-stu-id="bda60-182">The project is now configured to start the add-in in that document.</span></span>

## <a name="start-the-project"></a><span data-ttu-id="bda60-183">プロジェクトの開始</span><span class="sxs-lookup"><span data-stu-id="bda60-183">Start the project</span></span>

<span data-ttu-id="bda60-184">メニュー バーから [**デバッグ**]、[\*\*デバッグの開始 \*\*] の順に選択し、プロジェクトを開始します。</span><span class="sxs-lookup"><span data-stu-id="bda60-184">Start the project by choosing **Debug** > **Start Debugging** from the menu bar.</span></span> <span data-ttu-id="bda60-185">Visual Studio では、自動的にソリューションがビルドされ、Office が起動されてアドインがホストされます。</span><span class="sxs-lookup"><span data-stu-id="bda60-185">Visual Studio will automatically build the solution and start Office to host your add-in.</span></span>

> [!NOTE]
> <span data-ttu-id="bda60-186">Outlook アドイン プロジェクトを開始すると、ログインの資格情報を求めるメッセージが表示されます。</span><span class="sxs-lookup"><span data-stu-id="bda60-186">When you start an Outlook add-in project, you'll be prompted for login credentials.</span></span> <span data-ttu-id="bda60-187">繰り返しログインを要求された場合、または権限がないというエラーが表示された場合は、Office 365 テナントのアカウントに対して基本認証が無効になっている可能性があります。</span><span class="sxs-lookup"><span data-stu-id="bda60-187">If you're asked to log in repeatedly or if you receive an error that you are unauthorized, then Basic Auth may be disabled for accounts on your Office 365 tenant.</span></span> <span data-ttu-id="bda60-188">この場合、代わりに Microsoft アカウントを使用してみます。</span><span class="sxs-lookup"><span data-stu-id="bda60-188">In this case, try using a Microsoft account instead.</span></span> <span data-ttu-id="bda60-189">Outlook Web アドイン プロジェクトのプロパティ ダイアログで、[多要素認証を使用する] プロパティを True に設定する必要がある場合もあります。</span><span class="sxs-lookup"><span data-stu-id="bda60-189">You may also need to set the property "Use multi-factor auth" to True in the Outlook Web Add-in project properties dialog.</span></span>

<span data-ttu-id="bda60-190">Visual Studio によってプロジェクトがビルドされると、次のタスクが実行されます。</span><span class="sxs-lookup"><span data-stu-id="bda60-190">When Visual Studio builds the project it performs the following tasks:</span></span>

1. <span data-ttu-id="bda60-191">XML マニフェスト ファイルのコピーを作成し、`_ProjectName_\bin\Debug\OfficeAppManifests` ディレクトリに追加します。</span><span class="sxs-lookup"><span data-stu-id="bda60-191">Creates a copy of the XML manifest file and adds it to  `_ProjectName_\bin\Debug\OfficeAppManifests` directory.</span></span> <span data-ttu-id="bda60-192">Visual Studio を起動してアドインをデバッグするときに、ホスト アプリケーションでこのコピーが使用されます。</span><span class="sxs-lookup"><span data-stu-id="bda60-192">The host application consumes this copy when you start Visual Studio and debug the add-in.</span></span>

2. <span data-ttu-id="bda60-193">アドインをホスト アプリケーションに表示するための一連のレジストリ エントリをお使いのコンピューターに作成します。</span><span class="sxs-lookup"><span data-stu-id="bda60-193">Creates a set of registry entries on your computer that enable the add-in to appear in the host application.</span></span>

3. <span data-ttu-id="bda60-194">Web アプリケーション プロジェクトをビルドし、ローカルの IIS Web サーバー (https://localhost)) に展開します。</span><span class="sxs-lookup"><span data-stu-id="bda60-194">Builds the web application project, and then deploys it to the local IIS web server (https://localhost).</span></span>

4. <span data-ttu-id="bda60-195">これがローカル IIS Web サーバーに最初に展開したアドイン プロジェクトである場合は、現在のユーザーの信頼されたルート証明書ストアに自己署名証明書をインストールするように求められることがあります。</span><span class="sxs-lookup"><span data-stu-id="bda60-195">If this is the first add-in project that you have deployed to local IIS web server, you may be prompted to install a Self-Signed Certificate to the current user's Trusted Root Certificate store.</span></span> <span data-ttu-id="bda60-196">これは、IIS Express がアドインの内容を正しく表示するために必要です。</span><span class="sxs-lookup"><span data-stu-id="bda60-196">This is required for IIS Express to display the content of your add-in correctly.</span></span>

> [!NOTE]
> <span data-ttu-id="bda60-197">Windows 10 上で実行している場合、最新バージョンの Office では、新しい Web コントロールを使用してアドインの内容を表示することがあります。</span><span class="sxs-lookup"><span data-stu-id="bda60-197">The latest version of Office may use a newer web control to display the add-in contents when running on Windows 10.</span></span> <span data-ttu-id="bda60-198">この場合、Visual Studio はローカル ネットワークのループバック除外を追加するように促します。</span><span class="sxs-lookup"><span data-stu-id="bda60-198">If this is the case, Visual Studio may prompt you to add a local network loopback exemption.</span></span> <span data-ttu-id="bda60-199">これは、Office ホスト アプリケーションの Web コントロールがローカル IIS Web サーバーに展開された Web サイトにアクセスできるようにするために必要です。</span><span class="sxs-lookup"><span data-stu-id="bda60-199">This is required for the web control, in the Office host application, to be able to access the website deployed to the local IIS web server.</span></span> <span data-ttu-id="bda60-200">この設定は、Visual Studio の **[ツール]** > **[オプション]** > **[Office ツール (Web)]** > **[Web アドインのデバッグ]** の順に選択して変更することもできます。</span><span class="sxs-lookup"><span data-stu-id="bda60-200">You can also change this setting anytime in Visual Studio under **Tools** > **Options** > **Office Tools (Web)** > **Web Add-In Debugging**.</span></span>

<span data-ttu-id="bda60-201">次に、Visual Studio で次の操作が行われます。</span><span class="sxs-lookup"><span data-stu-id="bda60-201">Next, Visual Studio does the following:</span></span>

1. <span data-ttu-id="bda60-202">`~remoteAppUrl` トークンを開始ページの完全修飾アドレス (例: `https://localhost:44302/Home.html`) で置き換えることによって、XML マニフェスト ファイルの [SourceLocation](../reference/manifest/sourcelocation.md) 要素を変更します。</span><span class="sxs-lookup"><span data-stu-id="bda60-202">Modifies the [SourceLocation](../reference/manifest/sourcelocation.md) element of the XML manifest file by replacing the `~remoteAppUrl` token with the fully qualified address of the start page (for example, `https://localhost:44302/Home.html`).</span></span>

2. <span data-ttu-id="bda60-203">IIS Express で Web アプリケーション プロジェクトを起動します。</span><span class="sxs-lookup"><span data-stu-id="bda60-203">Starts the web application project in IIS Express.</span></span>

3. <span data-ttu-id="bda60-204">ホスト アプリケーションを開きます。</span><span class="sxs-lookup"><span data-stu-id="bda60-204">Opens the host application.</span></span>

<span data-ttu-id="bda60-205">Visual Studio では、プロジェクトのビルド時の検証エラーは [**出力**] ウィンドウには表示されません。</span><span class="sxs-lookup"><span data-stu-id="bda60-205">Visual Studio doesn't show validation errors in the **OUTPUT** window when you build the project.</span></span> <span data-ttu-id="bda60-206">Visual Studio では、エラーと警告が発生すると **ERRORLIST** ウィンドウ内で報告されます。</span><span class="sxs-lookup"><span data-stu-id="bda60-206">Visual Studio reports errors and warnings in the **ERRORLIST** window as they occur.</span></span> <span data-ttu-id="bda60-207">また、Visual Studio では、検証エラーは、コードおよびテキスト エディター内で別の色の波形の下線 (波線と呼ばれる) で報告されます。</span><span class="sxs-lookup"><span data-stu-id="bda60-207">Visual Studio also reports validation errors by showing wavy underlines (known as squiggles) of different colors in the code and text editor.</span></span> <span data-ttu-id="bda60-208">このようなマークにより、Visual Studio によってご自身のコード内で検出された問題が通知されます。</span><span class="sxs-lookup"><span data-stu-id="bda60-208">These marks notify you of problems that Visual Studio detected in your code.</span></span> <span data-ttu-id="bda60-209">検証を有効または無効にする方法の詳細については、「[[オプション]、[テキスト エディター]、[JavaScript]、[IntelliSense]](/visualstudio/ide/reference/options-text-editor-javascript-intellisense?view=vs-2019)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="bda60-209">For more information about how to enable or disable validation, see [Options, Text Editor, JavaScript, IntelliSense](/visualstudio/ide/reference/options-text-editor-javascript-intellisense?view=vs-2019).</span></span>

<span data-ttu-id="bda60-210">プロジェクト内の XML マニフェスト ファイルの検証ルールを確認するには、「[Office アドインの XML マニフェスト](../develop/add-in-manifests.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="bda60-210">To review the validation rules of the XML manifest file in your project, see [Office Add-ins XML manifest](../develop/add-in-manifests.md).</span></span>

## <a name="debug-the-code-for-an-excel-powerpoint-or-word-add-in"></a><span data-ttu-id="bda60-211">Excel、PowerPoint、または Word アドイン用のコードのデバッグ</span><span class="sxs-lookup"><span data-stu-id="bda60-211">Debug the code for an Excel, PowerPoint, or Word add-in</span></span>

<span data-ttu-id="bda60-212">[プロジェクトを開始](#start-the-project)した後に、ホスト アプリケーション (Excel、PowerPoint、または Word) に表示されたドキュメント内にご利用のアドインが表示されない場合、ホスト アプリケーションでアドインを手動で起動します。</span><span class="sxs-lookup"><span data-stu-id="bda60-212">If your add-in isn't visible within the document that's displayed in the host application (Excel, PowerPoint, or Word) after you've [started the project](#start-the-project), manually launch the add-in in the host application.</span></span> <span data-ttu-id="bda60-213">たとえば、[**ホーム**] タブのリボンで [**作業ウィンドウの表示**] ボタンを選択して作業ウィンドウを起動します。ご利用のアドインが Excel、PowerPoint、または Word 内に表示されたら、次の操作を行うことでご自身のコードをデバッグできます。</span><span class="sxs-lookup"><span data-stu-id="bda60-213">For example, launch your task pane add-in by choosing the **Show Taskpane** button in the ribbon of the **Home** tab. After your add-in is displayed in Excel, PowerPoint, or Word, you can debug your code by doing the following:</span></span>

1. <span data-ttu-id="bda60-214">Excel、PowerPoint、または Word で、[**挿入**] タブを選択し、[**個人用アドイン**] の右側に配置された下向き矢印を選択します。</span><span class="sxs-lookup"><span data-stu-id="bda60-214">In Excel, PowerPoint, or Word, choose the **Insert** tab and then choose the down-arrow located to the right of **My Add-ins**.</span></span>

    ![[個人用アドイン] の矢印が強調表示された Windows での Excel の [挿入] リボン](../images/excel-cf-register-add-in-1b.png)

2. <span data-ttu-id="bda60-216">使用可能なアドインのリストから **[開発者向けアドイン]** セクションを見つけ、ご利用のアドインを選択して登録します。</span><span class="sxs-lookup"><span data-stu-id="bda60-216">In the list of available add-ins, find the **Developer Add-ins** section and select the your add-in to register it.</span></span>

3. <span data-ttu-id="bda60-217">Visual Studio でコードにブレークポイントを設定します。</span><span class="sxs-lookup"><span data-stu-id="bda60-217">In Visual Studio, set breakpoints in your code.</span></span>

4. <span data-ttu-id="bda60-218">Excel、PowerPoint、または Word でご利用のアドインを操作します。</span><span class="sxs-lookup"><span data-stu-id="bda60-218">In Excel, PowerPoint, or Word, interact with your add-in.</span></span>

5. <span data-ttu-id="bda60-219">Visual Studio でブレークポイントに達したときは、必要に応じて、コードのステップ実行を行います。</span><span class="sxs-lookup"><span data-stu-id="bda60-219">As breakpoints are hit in Visual Studio, step through the code as needed.</span></span>

<span data-ttu-id="bda60-220">コードを変更し、ご利用のアドインでこれらの変更の影響を確認できます。ホスト アプリケーションを閉じて、プロジェクトを再起動する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="bda60-220">You can change your code and review the effects of those changes in your add-in without having to close the host application and restart the project.</span></span> <span data-ttu-id="bda60-221">コードに対する変更を保存した後に、ホスト アプリケーションでアドインを再読み込みするだけです。</span><span class="sxs-lookup"><span data-stu-id="bda60-221">After you save changes to your code, simply reload the add-in in the host application.</span></span> <span data-ttu-id="bda60-222">たとえば、[パーソナリティ メニュー](../design/task-pane-add-ins.md#personality-menu)をアクティブにして、[**再読み込み**] を選択するには、作業ウィンドウの右上隅を選択して、作業ウィンドウ アドインを再読み込みします。</span><span class="sxs-lookup"><span data-stu-id="bda60-222">For example, reload a task pane add-in by choosing the top-right corner of the task pane to activate the [personality menu](../design/task-pane-add-ins.md#personality-menu) and then choose **Reload**.</span></span>

## <a name="debug-the-code-for-an-outlook-add-in"></a><span data-ttu-id="bda60-223">Outlook アドイン用のコードのデバッグ</span><span class="sxs-lookup"><span data-stu-id="bda60-223">Debug the code for an Outlook add-in</span></span>

<span data-ttu-id="bda60-224">[プロジェクトを開始](#start-the-project)して、Visual Studio で Outlook を起動してご利用のアドインをホストした後、メール メッセージまたは予定アイテムを開きます。</span><span class="sxs-lookup"><span data-stu-id="bda60-224">After you've [started the project](#start-the-project) and Visual Studio launches Outlook to host your add-in, open an email message or appointment item.</span></span> 

<span data-ttu-id="bda60-p120">Outlook は、アクティブ化の基準を満たしていれば、アイテムの アドイン をアクティブ化します。アドイン バーが [インスペクタ] ウィンドウまたは閲覧ウィンドウの上部に表示され、Outlook アドインがアドイン バーにボタンとして表示されます。アドインにアドイン コマンドがある場合は、リボンの既定のタブまたは指定されたカスタム タブのいずれかにボタンが表示され、アドイン バーにはアドインは表示されません。</span><span class="sxs-lookup"><span data-stu-id="bda60-p120">Outlook activates the add-in for the item as long as the activation criteria are met. The add-in bar appears at the top of the Inspector window or Reading Pane, and your Outlook add-in appears as a button in the add-in bar. If your add-in has an add-in command, a button will appear in the ribbon, either in the default tab or a specified custom tab, and the add-in will not appear in the add-in bar.</span></span>

<span data-ttu-id="bda60-228">Outlook アドインを表示するには、Outlook アドインのボタンを選択します。</span><span class="sxs-lookup"><span data-stu-id="bda60-228">To view your Outlook add-in, choose the button for your Outlook add-in.</span></span> <span data-ttu-id="bda60-229">ご利用のアドインが Outlook に表示された後、以下の操作を行うことでコードをデバッグできます。</span><span class="sxs-lookup"><span data-stu-id="bda60-229">After your add-in is displayed in Outlook, you can debug your code by doing the following:</span></span>

1. <span data-ttu-id="bda60-230">Visual Studio でコードにブレークポイントを設定します。</span><span class="sxs-lookup"><span data-stu-id="bda60-230">In Visual Studio, set breakpoints in your code.</span></span>

2. <span data-ttu-id="bda60-231">Outlook で、ご利用のアドインを操作します。</span><span class="sxs-lookup"><span data-stu-id="bda60-231">In Outlook, interact with your add-in.</span></span>

3. <span data-ttu-id="bda60-232">Visual Studio でブレークポイントに達したときは、必要に応じて、コードのステップ実行を行います。</span><span class="sxs-lookup"><span data-stu-id="bda60-232">As breakpoints are hit in Visual Studio, step through the code as needed.</span></span>

<span data-ttu-id="bda60-233">コードを変更し、ご利用のアドインでこれらの変更の影響を確認できます。Outlook を閉じて、プロジェクトを再起動する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="bda60-233">You can change your code and review the effects of those changes in your add-in without having to close Outlook and restart the project.</span></span> <span data-ttu-id="bda60-234">コードへの変更を保存した後、(Outlook で) アドインのショートカット メニューを開いて、[**再読み込み**] を選択するだけです。</span><span class="sxs-lookup"><span data-stu-id="bda60-234">After you save changes to your code, simply open the shortcut menu for the add-in (in Outlook), and then choose **Reload**.</span></span>

## <a name="next-steps"></a><span data-ttu-id="bda60-235">次のステップ</span><span class="sxs-lookup"><span data-stu-id="bda60-235">Next steps</span></span>

<span data-ttu-id="bda60-236">アドインが意図したとおりに動作した後、アドインをユーザーに配布する方法については、「[Office アドインを展開し、発行する](../publish/publish.md)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="bda60-236">After your add-in is working as desired, see [Deploy and publish your Office Add-in](../publish/publish.md) to learn about the ways you can distribute the add-in to users.</span></span>
