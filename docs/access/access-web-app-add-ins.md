# <a name="create-add-ins-for-access-web-apps"></a>Access Web アプリ用のアドインを作成する

>**重要:**SharePoint で Access Web アプリとデータベースを作成して使用することは推奨されなくなりました。代わりに、[Microsoft PowerApps](https://powerapps.microsoft.com/) を使用して、コード作成が不要な Web とモバイル デバイス用ビジネス ソリューションをビルドすることをお勧めします。

この記事は、Visual Studio 2015 を使用して、Access Web アプリを対象とした Office アドインを開発する方法を示します。

>**注:**VBA を使用した Access 向けソリューション開発の詳細は、MSDN の「[Access](https://msdn.microsoft.com/en-us/library/fp179695.aspx)」を参照してください。

## <a name="prerequisites"></a>前提条件

Access Web アプリ を対象とした Office アドイン の作成に必要なものは次のとおりです。

- Visual Studio 2015

- SharePoint Online サイト (多くの Office 365 サブスクリプションに含まれています)。 このサイトには、アドイン カタログが必要です。 詳細については、「[SharePoint 上でアドイン カタログをセットアップする](../publish/publish-task-pane-and-content-add-ins-to-an-add-in-catalog.md)」を参照してください。


>**注:**Office アドインは、SharePoint Online または Office 365 でホストされている Access Web App で処理されます。 Access 2013 のデスクトップ アプリケーションは、Office アドインをサポートしていません。Access Web App を対象とする Office アドインは Office.js のバージョン 1.1 以降でサポートされています。


## <a name="create-a-project-in-visual-studio"></a>Visual Studio でプロジェクトを作成する

1.  Visual Studio を開き、メニューで **[ ファイル]** > **[新規]** > **[プロジェクト]** を選択します。 **[新規プロジェクト]** ダイアログ ボックスが表示されます。

2. **[新規プロジェクト]** ダイアログ ボックスの左側のウィンドウで、**[インストール済み]** > **[テンプレート]** > **[Visual C#]** > **[Office/SharePoint]** > **[Office アドイン]** の順に選択します。

    >**注:**このテンプレートをインストールしていない場合は、ブログの「[Visual Studio 2015 に関する最新の Microsoft Office Developer Tools](https://blogs.msdn.microsoft.com/visualstudio/2015/11/23/latest-microsoft-office-developer-tools-for-visual-studio-2015/)」の記事を参照してください。

3. **[新規プロジェクト]** ダイアログ ボックスの中央のウィンドウで、**[Office アドイン]** を選択します。

4. ダイアログ ボックスの下部にプロジェクト名を入力して、**[OK]** をクリックします。 これにより、**[Office アドインの作成]** ダイアログ ボックスが開きます。

5. **[Office アドインの作成]** ダイアログ ボックスで、**[コンテンツ]** > **[次へ]**] の順に選択します。

6. [ **Office アドインの作成**] ダイアログ ボックスの次の画面で、[ **基本アドイン**] または [ **ドキュメント視覚化アドイン**] を選択します。このとき、必ず [ **Access**] のチェック ボックスを選択してください。

7. 最後に **[完了]** を選択します。 Visual Studio は、作業の基となるスターター プロジェクトを作成します。

8. **ソリューション エクスプローラー**で、プロジェクトの Web プロジェクト (**project_name>Web**) を選びます。 プロパティ ウィンドウで、**SSL URL** のエントリを探します。 `https://localhost:44314/` のように表示されます。 この URL を選び、クリップボードにコピーします。 後で必要になります。

9. **ソリューション エクスプローラー**でプロジェクト名を右クリックします。 コンテキスト メニューで、**[発行]** を選択します。 これにより、**[アドインの発行]** ウィザードが開きます。

10. **[アドインの発行]** ウィザードで、**[現在のプロファイル]** の横にあるドロップダウン リストを開きます。 ドロップダウン リストで、**[新規]** を選択します。 **[Office アドインおよび SharePoint アドインを発行する]** ダイアログ ボックスが開きます。

11. このダイアログ ボックスで、**[プロファイルの新規作成]** を選択し、わかりやすい名前を入力して、**[完了]** を選択します。 **[Office アドインおよび SharePoint アドインを発行する]** ダイアログ ボックスが閉じ、**[アドインの発行]** ウィザードに戻ります。

12. ウィザードで、**[アドインをパッケージ化する]** を選択します。 これによって、SharePoint のアドイン カタログに発行できるようにアドインが最終処理されます。

13. 次のページの **[Web サイトがホストされている場所]** に Web サイトのホストの URL を入力します。 手順 8 でコピーした **SSL URL** の値を使用することもできます。 次に、**[完了]** を選択します。

14. **ソリューション エクスプローラー**で、プロジェクトのマニフェスト ノード (プロジェクト名の直下) を右クリックして、**[エクスプローラーでフォルダーを開く]** を選択します。 このファイルへのパスをメモしてください。 後でこの値が必要になります。

>**注:**アドインを Access Web アプリで展開せずにデバッグすることはできません。

## <a name="review-the-manifest-and-the-homehtml-file"></a>マニフェストおよび Home.Html ファイルを確認する

1. Visual Studio プロジェクトで **Home.html** ファイルを開き、office.js スクリプト ライブラリを参照する行を探します。

    ```html
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/Office.js" type="text/javascript"></script>
    ```

    >**注:**このスクリプト タグは、バージョン 1.1 以降の Office.js を参照します。 Access では、バージョン 1.1 で導入された API 要素を使用します。

2. プロジェクトに関連付けられたマニフェスト ファイルを開きます。このファイルのファイル名にはプロジェクト名および拡張子として「.xml」が付けられます。

3.  マニフェスト ファイルで、**Hosts** セクションを探してから、**Host** エントリを探します。

    ```xml
    <Hosts> <Host Name="Database" /> </Hosts>
    ```
    
    >**注:**ここには、アドインを使用できるアプリケーションが一覧表示されます。 **[Office アドインの作成]** ダイアログ ボックスで **[Access]** を選択したので、**Database** が表示されています。 Excel を選択した場合は、**Workbook** も表示されます。

Office アドインと SharePoint アドイン は Web ベースです。アドインのコードが Web サーバーでホストされる必要があります。この例で、Web サーバーとはお使いの開発用コンピューターです。テスト用アドインを提供するためにはサーバーが実行している必要があります。つまり、SharePoint 内でアドインの表示とデバッグを行う時には Visual Studio が実行している必要があるということです。

ユーザーがアドインを検索して使用するためには、アドインが SharePoint のアドイン カタログに登録されている必要があります。アドイン カタログに必要な情報は、マニフェスト ファイルの中にあります。

>**注:**Office アドイン をホストする Access Web アプリを作成する必要があります。

## <a name="publish-your-add-in-to-a-sharepoint-online-catalog"></a>アドインを SharePoint Online カタログに発行する

1.  SharePoint Online または Office 365 にサインインし、ページ上部の Office 365 ツール バーにある  **[管理]** を選択して、 **SharePoint 管理センター** に移動します。

2. **[SharePoint 管理センター]** ページの左側のリンク バーで **[アドイン]** を選択します。これにより、アドイン ビューが開きます。

3. ページの中央のウィンドウで、**[アドイン カタログ]** を選択します。 **[カタログ]** ページが開きます。

4. [ **カタログ**] ページで、[ **Office アドインの配布**] を選択すると、[ **Office アドイン**] というディレクトリ ページに移動します。ここにインストールされたすべての Office アドイン が一覧表示されます。

5. **[Office アドイン]** ページの上部で、**[新しいアドイン]** を選択します。 これにより、**[ドキュメントの追加]** ダイアログ ボックスが開きます。

6. **[ドキュメントの追加]** ダイアログ ボックスで、**[参照]** を選択し、Visual Studio プロジェクト内のマニフェスト ファイルの場所に移動します。 前もって、マニフェスト ファイルのアドレスをコピーした場合は、このダイアログ ボックスに貼り付けます。

7. プロジェクトのマニフェスト ファイルを選択し、**[OK]** を選択します。 SharePoint によって、ローカルの SharePoint ライブラリにアドインが追加されるようになります。

>**注:**この手順では、SharePoint のテスト サイトを作成していることを前提としています。 作成していない場合は、SharePoint ウィンドウ上部の **[サイト]** タブから作成できます。 既存の Access Web アプリがあれば、それを使用できます。

## <a name="create-an-access-web-app-to-host-your-add-in"></a>アドインをホストする Access Web アプリを作成する

1. テスト サイトに移動します。 左側のリンク バーで **[サイト コンテンツ]** を選択します。 これにより、テスト サイトの **[サイト コンテンツ]** ページに移動します。

2. **[サイト コンテンツ]** ページで **[アドインの追加]** を選択します。 **[サイト コンテンツ - 自分のアドイン]** ページが開きます。

3. [**サイト コンテンツ - 自分のアドイン**] ページで、ページ上部の検索バーを使って **Access アプリ**を検索します。

4. **Access アプリ**のタイルが表示されます。

    >**注:**これは Office アドインではなく、新しい Access Web アプリであることに注意してください。 この Access Web アプリが、Office アドインをホストします。

5. このタイルを選択すると、**[Access アプリの追加]** ダイアログ ボックスが表示されます。 Access アプリの一意の名前を入力し、**[作成]** を選択します。 SharePoint のアプリ作成には時間がかかる場合があります。 完了すると、**[サイト コンテンツ]** ページに**新しい**ラベル付きで Access アプリが一覧表示されます。

6. Accessアプリ は、SharePoint で開いて表示する前に、デスクトップ版の Microsoft Access 2013 で開いてデータを追加することが必要になります。

## <a name="add-your-add-in-to-an-access-web-apps"></a>アドインを Access Web アプリ に追加する

1. Access Web アプリを開きます。

2. SharePoint タブ バーの左上隅の歯車のアイコンを選択します。 メニューが表示されます。 **[Office アドイン]** メニュー項目を選択します。 これにより、**[Office アドイン]** ダイアログ ボックスが開きます。

3. [ **自分の所属組織**] ビューを選択し、利用可能な Office アドイン が SharePoint によってダイアログ ボックスに表示されるまで少し待ちます。

4. ダイアログ ボックスのアドインの 1 つに、前の手順で登録した Office アドインが表示されます。そのアドインを選んで、Access Web アプリに追加します。アプリが検出されて Access Web アプリのページに表示されるためには、アプリが Visual Studio で実行されている必要があることに注意してください。

## <a name="debug-your-add-in-for-office"></a>Office 用アドインをデバッグする

アドインをデバッグするには、Internet Explorer で F12 を押すか、ブラウザーのタブ バーにある歯車アイコンを選択します (SharePoint ページの歯車アイコンとは異なります)。Internet Explorer 11 が提供する F12 デバッグ ツールが起動します。他のブラウザーをお使いの場合は、ブラウザーのマニュアルを確認してデバッグ モードに入る方法を確認してください。

この時点で、ブレークポイントの設定、JavaScript コードのステップ実行、DOM の探索、コードの変更を行って、Access Web アプリを対象とする Office アドインに変更箇所が表示されていることを確認できます。 詳細については、「[F12 開発者用ツールの使用](http://msdn.microsoft.com/library/ie/bg182326%28v=vs.85%29)」を参照してください。

## <a name="next-steps"></a>次の手順

サンプル「 [Office 365: アクセス Web アプリでのデータのバインドと操作](https://code.msdn.microsoft.com/officeapps/Office-365-Bind-and-4876274e)」をダウンロードして、Access web アプリ でデータを処理する Office アドイン を実装する方法についてご覧ください。

## <a name="additional-resources"></a>その他のリソース

- [アドイン用の JavaScript API について](../develop/understanding-the-javascript-api-for-office.md)

- [JavaScript API for Office](../../reference/javascript-api-for-office.md)
